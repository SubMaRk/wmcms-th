"use strict";function createPage(t,e){var a=nextCss=html=lastCss=lastNextCss=indexDis=lastDis="",i=prePage=lastPage=lastNextPage=0;t=parseInt(t),e=parseInt(e),1==t?(indexDis="disabled",a="display: none;"):(i=1,prePage=t-1,prePage<=1&&(prePage=1),nextCss="display: none;"),t==e?(lastDis="disabled",lastCss="display: none;"):(lastPage=e,lastNextPage=t+1,lastNextPage>=e&&(lastNextPage=e),lastNextCss="display: none;"),html='<li class="j-first '+indexDis+'" data-page="'+i+'"><a class="first" href="javascript:;" style="'+a+'"><i class="fa fa-step-backward"></i> 首页</a><span class="first" style="'+nextCss+'"><i class="fa fa-step-backward"></i> 首页</span></li><li class="j-prev '+indexDis+'" data-page="'+prePage+'"><a class="previous" href="javascript:;" style="'+a+'"><i class="fa fa-backward"></i> 上一页</a><span class="previous" style="'+nextCss+'"><i class="fa fa-backward"></i> 上一页</span></li>';var n=1;forSum=t+3,forSum>=e&&(forSum=e),t>3&&(n=forSum-6);for(var o=n;o<=forSum;o++)selected="",o==t&&(selected="selected"),html+='<li class="j-num '+selected+'" data-page="'+o+'"><a href="javascript:;">'+o+"</a></li>";return html+='<li class="j-next '+lastDis+'" data-page="'+lastNextPage+'"><a class="next" href="javascript:;" style="'+lastCss+'">下一页 <i class="fa fa-forward"></i></a><span class="next" style="'+lastNextCss+'">下一页 <i class="fa fa-forward"></i></span></li><li class="j-last '+lastDis+'" data-page="'+lastPage+'"><a class="last" href="javascript:;" style="'+lastCss+'">末页 <i class="fa fa-step-forward"></i></a><span class="last" style="'+lastNextCss+'">末页 <i class="fa fa-step-forward"></i></span></li>',html}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue;+function(t){function e(){this.datas=new Array}var a={JSPATH:"BJUI/",PLUGINPATH:"BJUI/plugins/",IS_DEBUG:!1,KeyPressed:{ctrl:!1,shift:!1},keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,CTRL:17,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8},eventType:{initUI:"bjui.initUI",beforeInitUI:"bjui.beforeInitUI",afterInitUI:"bjui.afterInitUI",ajaxStatus:"bjui.ajaxStatus",resizeGrid:"bjui.resizeGrid",beforeAjaxLoad:"bjui.beforeAjaxLoad",beforeLoadNavtab:"bjui.beforeLoadNavtab",beforeLoadDialog:"bjui.beforeLoadDialog",afterLoadNavtab:"bjui.afterLoadNavtab",afterLoadDialog:"bjui.afterLoadDialog",beforeCloseNavtab:"bjui.beforeCloseNavtab",beforeCloseDialog:"bjui.beforeCloseDialog",afterCloseNavtab:"bjui.afterCloseNavtab",afterCloseDialog:"bjui.afterCloseDialog"},pageInfo:{pageCurrent:"pageCurrent",pageSize:"pageSize",orderField:"orderField",orderDirection:"orderDirection"},alertMsg:{displayPosition:"topcenter",alertTimeout:6e3},ajaxTimeout:3e4,statusCode:{ok:200,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{windowWidth:0,showSlidebar:!0,clientPaging:!0,overwriteHomeTab:!1},debug:function(t){this.IS_DEBUG&&("undefined"!=typeof console?console.log(t):alert(t))},loginInfo:{url:"login.html",title:"Login",width:420,height:260,mask:!0},loadLogin:function(){var t=this.loginInfo;a.dialog({id:"bjui-login",url:t.url,title:t.title,width:t.width,height:t.height,mask:t.mask})},init:function(e){var i=t.extend({},e);t.extend(a.statusCode,i.statusCode),t.extend(a.pageInfo,i.pageInfo),t.extend(a.alertMsg,i.alertMsg),t.extend(a.loginInfo,i.loginInfo),t.extend(a.ui,i.ui),i.JSPATH&&(this.JSPATH=i.JSPATH),i.PLUGINPATH&&(this.PLUGINPATH=i.PLUGINPATH),i.ajaxTimeout&&(this.ajaxTimeout=i.ajaxTimeout),this.IS_DEBUG=i.debug||!1,this.initEnv(),t.cookie&&t.cookie("bjui_theme")||!i.theme||t(this).theme("setTheme",i.theme)},initEnv:function(){t(window).resize(function(){var e=t(this).width();a.ui.windowWidth&&a.ui.windowWidth>600&&a.ui.windowWidth<e&&(e=a.ui.windowWidth),a.initLayout(e),setTimeout(function(){t(this).trigger(a.eventType.resizeGrid)},30)}),setTimeout(function(){var e=t(window).width();a.ui.windowWidth&&a.ui.windowWidth>600&&a.ui.windowWidth<e&&(e=a.ui.windowWidth),a.initLayout(e),t(document).initui()},10)},initLayout:function(e){var i=e-(a.ui.showSlidebar?t("#bjui-sidebar").width()+6:6),n=t(window).height()-t("#bjui-header").height()-t("#bjui-footer").outerHeight(),o=t("#bjui-navtab").find(".tabsPageHeader").height();a.ui.windowWidth&&t("#bjui-window").width(e),a.windowWidth=e,t("#bjui-container").height(n),t("#bjui-navtab").width(i),t("#bjui-leftside, #bjui-sidebar, #bjui-sidebar-s, #bjui-splitBar, #bjui-splitBarProxy").css({height:"100%"}),t("#bjui-navtab .tabsPageContent").height(n-o),setTimeout(function(){t("#bjui-navtab > .tabsPageContent > .navtabPage").resizePageH(),t("#bjui-navtab > .tabsPageContent > .navtabPage").find(".bjui-layout").resizePageH()},10);var l=t("body").data("bjui.navbar.width"),s=t("#bjui-header"),r=s.find(".bjui-navbar-toggle"),d=s.find(".bjui-navbar-logo"),c=t("#bjui-navbar-collapse"),u=c.find(".bjui-navbar-right");l||(l={logoW:d.outerWidth(),navW:u.outerWidth()},t("body").data("bjui.navbar.width",l)),l&&(e-l.logoW<l.navW?(r.show(),c.addClass("collapse menu")):(r.hide(),c.removeClass("collapse menu in")));var h=t("#bjui-hnav-navbar-box"),f=h.find("> #bjui-hnav-navbar"),p=h.prev(),g=h.next(),m=h.width(),b=0;f.find("> li").each(function(e){var a=t(this);b+=a.outerWidth(),b>m?(g.show(),h.data("hnav.move",!0).data("hnav.liw",b)):(p.hide(),g.hide(),h.removeData("hnav.move"))})},regional:{},setRegional:function(t,e){a.regional[t]=e},getRegional:function(t){if(String(t).indexOf(".")>=0){for(var e,i=String(t).split("."),n=0;n<i.length;n++)e=e?e[i[n]]:a.regional[i[n]];return e}return a.regional[t]},doRegional:function(e,a){return t.each(a,function(t,a){e=e.replaceAll("#"+t+"#",a)}),e},isIE:function(t){var e=document.createElement("b");return e.innerHTML="\x3c!--[if IE "+t+"]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length},StrBuilder:function(){return new e}};e.prototype.add=function(t){return void 0!==t&&this.datas.push(t),this},e.prototype.toString=function(t){var e=this.datas.join(t||"");return this.clear(),e},e.prototype.isEmpty=function(){return 0==this.datas.length},e.prototype.clear=function(){this.datas=[],this.datas.length=0},window.BJUI=a}(jQuery),function(t){t(function(){BJUI.setRegional("alertmsg",{title:{error:"错误提示",info:"信息提示",warn:"警告信息",correct:"成功信息",confirm:"确认信息"},btnMsg:{ok:"确定",yes:"是",no:"否",cancel:"取消"}}),BJUI.setRegional("dialog",{close:"关闭",maximize:"最大化",restore:"还原",minimize:"最小化",title:"弹出窗口"}),BJUI.setRegional("orderby",{asc:"升序",desc:"降序"}),BJUI.setRegional("pagination",{total:"总记录数/总页数",first:"首页",last:"末页",prev:"上一页",next:"下一页",jumpto:"输入跳转页码，回车确认",jump:"跳转",page:"页",refresh:"刷新"}),BJUI.setRegional("datagrid",{asc:"升序",desc:"降序",showhide:"显示/隐藏 列",filter:"过滤",clear:"清除",lock:"锁定列",unlock:"解除锁定",add:"添加",edit:"编辑",save:"保存",update:"更新",cancel:"取消",del:"删除",prev:"上一条",next:"下一条",refresh:"刷新",query:"查询",import:"导入",export:"导出",all:"全部",true:"是",false:"否",noData:"没有数据！",expandMsg:"点我展开行！",shrinkMsg:"点我收缩行！",selectMsg:"未选中任何行！",editMsg:"请先保存编辑行！",saveMsg:"没有需要保存的行！",delMsg:"确定要删除该行吗？",delMsgM:"确定要删除选中行？"}),BJUI.setRegional("findgrid",{choose:"选择选中项",append:"追加选择",empty:"清空现有值"}),BJUI.setRegional("progressmsg","正在努力加载数据，请稍等..."),BJUI.setRegional("datepicker",{close:"关闭",prev:"上月",next:"下月",clear:"清空",ok:"确定",dayNames:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}),BJUI.setRegional("navtabCM",{refresh:"刷新本标签",close:"关闭本标签",closeother:"关闭其他标签",closeall:"关闭所有标签"}),BJUI.setRegional("dialogCM",{refresh:"刷新本窗口",close:"关闭本窗口",closeother:"关闭其他窗口",closeall:"关闭所有窗口"}),BJUI.setRegional("upload",{upConfirm:"开始上传",upPause:"暂停上传",upCancel:"取消上传"}),BJUI.setRegional("statusCode_503","服务器当前负载过大或者正在维护！"),BJUI.setRegional("ajaxnosend","与服务器的通信中断，请检查URL链接或服务器状态！"),BJUI.setRegional("sessiontimeout","会话超时，请重新登陆！"),BJUI.setRegional("plhmsg","占位符对应的选择器无有效值！"),BJUI.setRegional("nocheckgroup",'未定义选中项的组名[复选框的"data-group"]！'),BJUI.setRegional("notchecked","未选中任何一项！"),BJUI.setRegional("selectmsg","请选择一个选项！"),BJUI.setRegional("validatemsg","提交的表单中 [{0}] 个字段有错误，请更正后再提交！"),BJUI.setRegional("idChecked","不规范，ID需以字母开头，组成部分包括（0-9，字母，中横线，下划线）"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","我的主页"),t.validator&&t.validator.config({defaultMsg:"{0}格式不正确",loadingMsg:"正在验证...",rules:{digits:[/^\d+$/,"请输入整数"],number:[/^[\-\+]?((([0-9]{1,3})([,][0-9]{3})*)|([0-9]+))?([\.]([0-9]+))?$/,"请输入有效的数字"],letters:[/^[a-z]+$/i,"{0}只能输入字母"],tel:[/^(?:(?:0\d{2,3}[\- ]?[1-9]\d{6,7})|(?:[48]00[\- ]?[1-9]\d{6}))$/,"电话格式不正确"],mobile:[/^1[3-9]\d{9}$/,"手机号格式不正确"],email:[/^[\w\+\-]+(\.[\w\+\-]+)*@[a-z\d\-]+(\.[a-z\d\-]+)*\.([a-z]{2,4})$/i,"邮箱格式不正确"],qq:[/^[1-9]\d{4,}$/,"QQ号格式不正确"],date:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/,"请输入正确的日期，例：yyyy-MM-dd"],time:[/^(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的时间，例：HH:mm:ss"],datetime:[/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])\s+(2[0123]|(1|0?)[0-9]){1}:([0-5][0-9]){1}:([0-5][0-9]){1}$/,"请输入正确的日期时间，例：yyyy-MM-dd HH:mm:ss"],ID_card:[/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[A-Z])$/,"请输入正确的身份证号码"],url:[/^(https?|ftp):\/\/[^\s]+$/i,"网址格式不正确"],postcode:[/^[1-9]\d{5}$/,"邮政编码格式不正确"],chinese:[/^[\u0391-\uFFE5]+$/,"请输入中文"],username:[/^\w{3,12}$/,"请输入3-12位数字、字母、下划线"],password:[/^[0-9a-zA-Z]{6,16}$/,"密码由6-16位数字、字母组成"],pattern:function(t,e){return!e||(!!t.value.parseDate(e)||this.renderMsg("错误的日期时间格式！",e))},accept:function(t,e){if(!e)return!0;var a=e[0];return"*"===a||new RegExp(".(?:"+(a||"png|jpg|jpeg|gif")+")$","i").test(t.value)||this.renderMsg("只接受{1}后缀",a.replace("|",","))}}}),t.validator&&t.validator.config({messages:{required:"{0}不能为空",remote:"{0}已被使用",integer:{"*":"请输入整数","+":"请输入正整数","+0":"请输入正整数或0","-":"请输入负整数","-0":"请输入负整数或0"},match:{eq:"{0}与{1}不一致",neq:"{0}与{1}不能相同",lt:"{0}必须小于{1}",gt:"{0}必须大于{1}",lte:"{0}必须小于或等于{1}",gte:"{0}必须大于或等于{1}"},range:{rg:"请输入{1}到{2}的数",gte:"请输入大于或等于{1}的数",lte:"请输入小于或等于{1}的数"},checked:{eq:"请选择{1}项",rg:"请选择{1}到{2}项",gte:"请至少选择{1}项",lte:"请最多选择{1}项"},length:{eq:"请输入{1}个字符",rg:"请输入{1}到{2}个字符",gte:"请至少输入{1}个字符",lte:"请最多输入{1}个字符",eq_2:"",rg_2:"",gte_2:"",lte_2:""}}})})}(jQuery),function(t){BJUI.setRegional("alertmsg",{title:{error:"Error",info:"Info",warn:"Warning",correct:"Correct",confirm:"Confirm"},btnMsg:{ok:"OK",yes:"YES",no:"NO",cancel:"Cancel"}}),BJUI.setRegional("dialog",{close:"Close",maximize:"Maximize",restore:"Restore",minimize:"Minimize",title:"Popup window"}),BJUI.setRegional("orderby",{asc:"Asc",desc:"Desc"}),BJUI.setRegional("pagination",{first:"First page",last:"Last page",prev:"Prev page",next:"Next page",jumpto:"Jump page number",jump:"Jump"}),BJUI.setRegional("datagrid",{asc:"ASC",desc:"DESC",showhide:"Show/Hide columns",filter:"Filter",clear:"Clear",lock:"Lock",unlock:"Unlock",add:"Add",edit:"Edit",save:"Save",update:"Update",cancel:"Cancel",del:"Delete",prev:"Prev",next:"Next",refresh:"Refresh",query:"Query",import:"Import",export:"Export",all:"All",true:"True",false:"False",noData:"No data!",expandMsg:"Click here to expand the tr!",shrinkMsg:"Click here to shrink the tr!",selectMsg:"Not selected any rows!",saveMsg:"No rows need to save!",editMsg:"Please save the edited row!",delMsg:"Sure you want to delete this row?",delMsgM:"Sure you want to delete selected rows?"}),BJUI.setRegional("findgrid",{choose:"Choose the selected item",append:"Append choose the selected item",empty:"Empty existing values"}),BJUI.setRegional("progressmsg","Data loading, please waiting..."),BJUI.setRegional("datepicker",{close:"Close",prev:"Prev month",next:"Next month",clear:"Clear",ok:"OK",dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),BJUI.setRegional("navtabCM",{refresh:"Refresh navtab",close:"Close navtab",closeother:"Close other navtab",closeall:"Close all navtab"}),BJUI.setRegional("dialogCM",{refresh:"Refresh dialog",close:"Close dialog",closeother:"Close other dialog",closeall:"Close all dialog"}),BJUI.setRegional("upload",{upConfirm:"Start upload",upPause:"Pause upload",upCancel:"Cancel upload"}),BJUI.setRegional("statusCode_503","HTTP status 503, the current server load is too large or is down for maintenance!"),BJUI.setRegional("ajaxnosend","Communication with the server is interrupted, please check the URL link or server status!"),BJUI.setRegional("sessiontimout","Session timeout, please login!"),BJUI.setRegional("plhmsg","Placeholder corresponding selector None Valid!"),BJUI.setRegional("nocheckgroup",'Undefined group name selected item [check box "data-group"]!'),BJUI.setRegional("notchecked","Unchecked any one!"),BJUI.setRegional("selectmsg","Please select one option!"),BJUI.setRegional("validatemsg","Submitted form data has [{0}] field an error, please after modified submitting!"),BJUI.setRegional("idChecked","is not standardized, ID need to start with a letter, components include (0-9, letters, hyphens, underscore)"),BJUI.setRegional("uititle","B-JUI"),BJUI.setRegional("maintab","My home"),window.FRAG={dialog:'<div class="bjui-dialog bjui-dialog-container" style="top:150px; left:300px;">    <div class="dialogHeader" onselectstart="return false;" oncopy="return false;" onpaste="return false;" oncut="return false;">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <a class="maximize" href="javascript:;" title="#maximize#"><i class="fa fa-plus-circle"></i></a>        <a class="restore" href="javascript:;" title="#restore#"><i class="fa fa-history"></i></a>        <a class="minimize" href="javascript:;" title="#minimize#"><i class="fa fa-minus-circle"></i></a>        <h1><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></h1>    </div>    <div class="dialogContent unitBox"></div>    <div class="resizable_h_l" tar="nw"></div>    <div class="resizable_h_r" tar="ne"></div>    <div class="resizable_h_c" tar="n"></div>    <div class="resizable_c_l" tar="w" style="height:100%;"></div>    <div class="resizable_c_r" tar="e" style="height:100%;"></div>    <div class="resizable_f_l" tar="sw"></div>    <div class="resizable_f_r" tar="se"></div>    <div class="resizable_f_c" tar="s"></div></div>',taskbar:'<div id="bjui-taskbar" style="left:0px; display:none;">    <div class="taskbarContent">        <ul></ul>    </div>    <div class="taskbarLeft taskbarLeftDisabled"><i class="fa fa-angle-double-left"></i></div>    <div class="taskbarRight"><i class="fa fa-angle-double-right"></i></div></div>',splitBar:'<div id="bjui-splitBar"></div>',splitBarProxy:'<div id="bjui-splitBarProxy"></div>',resizable:'<div id="bjui-resizable" class="bjui-resizable"></div>',alertBackground:'<div class="bjui-alertBackground"></div>',maskBackground:'<div class="bjui-maskBackground bjui-ajax-mask"></div>',maskProgress:'<div class="bjui-maskProgress bjui-ajax-mask"><i class="fa fa-cog fa-spin"></i>&nbsp;&nbsp;#progressmsg#<div class="progressBg"><div class="progress"></div></div></div>',progressBar_custom:'<div id="bjui-progressBar-custom" class="progressBar"><i class="fa fa-cog fa-spin"></i> <span></span></div>',dialogMask:'<div class="bjui-dialogBackground"></div>',orderby:'<a href="javascript:;" class="order asc" data-order-direction="asc" title="#asc#"><i class="fa fa-angle-up"></i></a><a href="javascript:;" class="order desc" data-order-direction="desc" title="#desc#"><i class="fa fa-angle-down"></i></a>',slidePanel:'<div class="panel panel-default">    <div class="panel-heading">        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#bjui-accordionmenu" href="##id#" class="#class#">#icon#&nbsp;#title#<b>#righticon#</b></a></h4>    </div>    <div id="#id#" class="panel-collapse collapse#bodyclass#">        <div class="panel-body">        </div>    </div></div>',pagination:'<ul class="pagination">    <li class="j-first">        <a class="first" href="javascript:;"><i class="fa fa-step-backward"></i> #first#</a>        <span class="first"><i class="fa fa-step-backward"></i> #first#</span>    </li>    <li class="j-prev">        <a class="previous" href="javascript:;"><i class="fa fa-backward"></i> #prev#</a>        <span class="previous"><i class="fa fa-backward"></i> #prev#</span>    </li>    #pageNumFrag#    <li class="j-next">        <a class="next" href="javascript:;">#next# <i class="fa fa-forward"></i></a>        <span class="next">#next# <i class="fa fa-forward"></i></span>    </li>    <li class="j-last">        <a class="last" href="javascript:;">#last# <i class="fa fa-step-forward"></i></a>        <span class="last">#last# <i class="fa fa-step-forward"></i></span>    </li>    <li class="jumpto"><span class="p-input"><input class="form-control input-sm-pages" type="text" size="2.6" value="#pageCurrent#" title="#jumpto#"></span><a class="goto" href="javascript:;" title="#jump#"><i class="fa fa-chevron-right"></i></a></li></ul>',gridPaging:'<ul class="pagination">    <li class="page-total">        <span title="#total#">#count#</span>    </li>    <li class="page-jumpto"><span class="page-input"><input class="form-control input-sm-pages" type="text" size="3.2" value="#pageCurrent#" title="#jumpto#"></span></li>    <li class="page-first btn-nav">        <a href="javascript:;" title="#first#"><i class="fa fa-step-backward"></i></a>    </li>    <li class="page-prev btn-nav">        <a href="javascript:;" title="#prev#"><i class="fa fa-backward"></i></a>    </li>    #pageNumFrag#    <li class="page-next btn-nav">        <a href="javascript:;" title="#next#"><i class="fa fa-forward"></i></a>    </li>    <li class="page-last btn-nav">        <a href="javascript:;" title="#last#"><i class="fa fa-step-forward"></i></a>    </li></ul>',gridPageNum:'<li class="page-num#active#"><a href="javascript:;">#num#</a></li>',gridMenu:'<div class="datagrid-menu-box">    <ul>        <li class="datagrid-li-asc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-asc"></i></span><span class="title">#asc#</span></a></li>        <li class="datagrid-li-desc"><a href="javascript:;"><span class="icon"><i class="fa fa-sort-amount-desc"></i></span><span class="title">#desc#</span></a></li>        <li class="datagrid-li-filter"><a href="javascript:;"><span class="icon"><i class="fa fa-filter"></i></span><span class="title">#filter#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-showhide"><a href="javascript:;"><span class="icon"><i class="fa fa-check-square-o"></i></span><span class="title">#showhide#</span><span class="arrow"></span></a></li>        <li class="datagrid-li-lock"><a href="javascript:;"><span class="icon"><i class="fa fa-lock"></i></span><span class="title">#lock#</span></a></li>        <li class="datagrid-li-unlock disable"><a href="javascript:;"><span class="icon"><i class="fa fa-unlock"></i></span><span class="title">#unlock#</span></a></li>    </ul></div>',gridFilter:'<div class="datagrid-filter-box"><fieldset><legend>#label#</legend><span class="filter-a"></span><span class="filter-and"><select data-toggle="selectpicker" data-container="true" data-width="100%"><option value="and">AND</option><option value="or">OR</option></select></span><span class="filter-b"></span><span class="filter-ok"><button type="button" class="btn-green ok" data-icon="check">#filter#</button><button type="button" class="btn-orange clear" data-icon="remove">#clear#</button></span></fieldset></div>',gridShowhide:'<li data-index="#index#" class="datagrid-col-check"><a href="javascript:;"><i class="fa fa-check-square-o"></i>#label#</a></li>',gridEditBtn:'<button type="button" class="btn btn-green edit"><i class="fa fa-edit"></i> #edit#</button><button type="button" class="btn btn-green update"><i class="fa fa-edit"></i> #update#</button><button type="button" class="btn btn-green save"><i class="fa fa-check"></i> #save#</button><button type="button" class="btn btn-orange cancel"><i class="fa fa-undo"></i> #cancel#</button><button type="button" class="btn btn-red delete"><i class="fa fa-remove"></i> #del#</button>',gridDialogEditBtns:'<ul>    <li class="pull-left"><button type="button" class="btn btn-orange prev" data-icon="arrow-up">#prev#</button></li>    <li class="pull-left"><button type="button" class="btn btn-orange next" data-icon="arrow-down">#next#</button></li>    <li><button type="button" class="btn btn-red cancel" data-icon="remove">#cancel#</button></li>    <li><button type="button" class="btn btn-default save" data-icon="save">#save#</button></li></ul>',gridExpandBtn:'<span title="#expandMsg#"><i class="fa fa-plus"></i></span>',gridShrinkBtn:'<span title="#shrinkMsg#"><i class="fa fa-minus"></i></span>',alertBoxFrag:'<div id="bjui-alertMsgBox" class="bjui-alert"><div class="alertContent"><div class="#type#"><div class="alertInner"><h1><i class="fa #fa#"></i>#title#</h1><div class="msg">#message#</div></div><div class="toolBar"><ul>#btnFragment#</ul></div></div></div></div>',alertBtnFrag:'<li><button class="btn btn-#class#" rel="#callback#" type="button">#btnMsg#</button></li>',calendarFrag:'<div id="bjui-calendar">    <div class="main">        <a class="close" href="javascript:;" title="#close#"><i class="fa fa-times-circle"></i></a>        <div class="head">            <table width="100%" border="0" cellpadding="0" cellspacing="2">                <tr>                    <td width="20"><a class="prev" href="javascript:;" title="#prev#"><i class="fa fa-arrow-left"></i></a></td>                    <td><select name="year"></select></td>                    <td><select name="month"></select></td>                    <td width="20"><a class="next" href="javascript:;" title="#next#"><i class="fa fa-arrow-right"></i></a></td>                </tr>            </table>        </div>        <div class="body">            <dl class="dayNames"><dt>7</dt><dt>1</dt><dt>2</dt><dt>3</dt><dt>4</dt><dt>5</dt><dt>6</dt></dl>            <dl class="days">\x3c!-- date list --\x3e</dl>            <div style="clear:both;height:0;line-height:0"></div>        </div>        <div class="foot">            <table class="time">                <tr>                    <td>                        <input type="text" class="hh" maxlength="2" data-type="hh" data-start="0" data-end="23">:<input                         type="text" class="mm" maxlength="2" data-type="mm" data-start="0" data-end="59">:<input                         type="text" class="ss" maxlength="2" data-type="ss" data-start="0" data-end="59">                    </td>                    <td><ul><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul></td>                </tr>            </table>            <button type="button" class="clearBtn btn btn-orange">#clear#</button>            <button type="button" class="okBtn btn btn-default">#ok#</button>        </div>        <div class="tm">            <ul class="hh">                <li>0</li>                <li>1</li>                <li>2</li>                <li>3</li>                <li>4</li>                <li>5</li>                <li>6</li>                <li>7</li>                <li>8</li>                <li>9</li>                <li>10</li>                <li>11</li>                <li>12</li>                <li>13</li>                <li>14</li>                <li>15</li>                <li>16</li>                <li>17</li>                <li>18</li>                <li>19</li>                <li>20</li>                <li>21</li>                <li>22</li>                <li>23</li>            </ul>            <ul class="mm">                <li>0</li>                <li>5</li>                <li>10</li>                <li>15</li>                <li>20</li>                <li>25</li>                <li>30</li>                <li>35</li>                <li>40</li>                <li>45</li>                <li>50</li>                <li>55</li>            </ul>            <ul class="ss">                <li>0</li>                <li>10</li>                <li>20</li>                <li>30</li>                <li>40</li>                <li>50</li>            </ul>        </div>    </div></div>',spinnerBtn:'<ul class="bjui-spinner"><li class="up" data-add="1">&and;</li><li class="down">&or;</li></ul>',lookupBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="lookupbtn"><i class="fa fa-search"></i></a>',findgridBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="findgridbtn"><i class="fa fa-search"></i></a>',dateBtn:'<a class="bjui-lookup" href="javascript:;" data-toggle="datepickerbtn"><i class="fa fa-calendar"></i></a>',navtabCM:'<ul id="bjui-navtabCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</li></ul>',dialogCM:'<ul id="bjui-dialogCM">    <li rel="reload"><span class="icon"><i class="fa fa-refresh"></i></span><span class="title">#refresh#</span></li>    <li rel="closeCurrent"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#close#</span></li>    <li rel="closeOther"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeother#</span></li>    <li rel="closeAll"><span class="icon"><i class="fa fa-remove"></i></span><span class="title">#closeall#</span></li></ul>',externalFrag:'<iframe src="{url}" style="width:100%;height:{height};" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>',uploadTemp:'<div id="{fileId}" class="item">    <div class="info">        <span class="up_filename">{fileName}</span><span class="up_confirm" title="#upConfirm#"><i class="fa fa-play-circle-o"></i></span><span class="up_pause" title="#upPause#"><span class="glyphicon glyphicon-pause"></span></span><span class="up_cancel" title="#upCancel#"><i class="fa fa-times-circle-o"></i></span>    </div>    <div class="preview"><span class="img"></span></div>    <div class="progress"><div class="bar"></div></div>    <span class="percent">{percent}</span>    <span class="filesize"><span class="uploadedsize">{uploadedSize}</span>/<span class="totalsize">{fileSize}</span></span></div>',uploadFrag:'<input class="bjui-upload-select-file" style="display:none;" type="file" name="fileselect[]" #multi# accept="#accept#"><a href="javascript:void(0)" class="btn btn-default bjui-upload-select">#btnTxt#</a><div class="queue"></div>'}}(jQuery),function(t){t.fn.extend({ajaxUrl:function(e){var a=t(this);a.trigger(BJUI.eventType.beforeAjaxLoad),e.loadingmask&&a.trigger(BJUI.eventType.ajaxStatus),t.ajax({type:e.type||"GET",url:e.url,data:e.data||{},cache:!1,dataType:"html",timeout:BJUI.ajaxTimeout,success:function(i){var n=i.toJson(),o=a.find("> .bjui-ajax-mask");n[BJUI.keys.statusCode]?(n[BJUI.keys.statusCode]==BJUI.statusCode.error?(n[BJUI.keys.message]&&a.alertmsg("error",n[BJUI.keys.message]),a.closest(".bjui-layout").length||(a.closest(".navtab-panel").length?a.navtab("closeCurrentTab"):a.dialog("closeCurrent"))):n[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&(a.closest(".bjui-dialog").length&&a.dialog("closeCurrent"),a.closest(".navtab-panel").length&&a.navtab("closeCurrentTab"),BJUI.alertmsg("info",n[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()),o.fadeOut("normal",function(){t(this).remove()})):a.empty().html(i).append(o).initui(),t.isFunction(e.callback)&&e.callback(i)},error:function(t,e,i){a.bjuiajax("ajaxError",t,e,i),a.closest(".bjui-layout").length||(a.closest(".navtab-panel").length?a.navtab("closeCurrentTab"):a.dialog("closeCurrent")),a.trigger("bjui.ajaxError")},statusCode:{0:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.ajaxnosend)},503:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.statusCode_503)}}})},loadUrl:function(e,a,i){t(this).ajaxUrl({url:e,data:a,callback:i})},doAjax:function(e){var a,i,n=t(this);return e.url?e.callback?(e.callback=e.callback.toFunc(),e.loadingmask&&(a=n.getPageTarget(),a.trigger(BJUI.eventType.ajaxStatus),i=a.find("> .bjui-ajax-mask")),e.type||(e.type="POST"),e.dataType||(e.dataType="json"),e.cache||(e.cache=!1),e.timeout=e.ajaxTimeout||BJUI.ajaxTimeout,e.success=function(n){i?e.callback?t.when(e.callback(n)).done(function(){a.trigger("bjui.ajaxStop")}):a.trigger("bjui.ajaxStop"):e.callback(n)},e.error=e.error||function(t,e,n){BJUI.ajax("ajaxError",t,e,n),i&&a.trigger("bjui.ajaxError")},e.statusCode={0:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.ajaxnosend)},503:function(t,e,a){BJUI.alertmsg("error",BJUI.regional.statusCode_503)}},void t.ajax(e)):void BJUI.debug("The ajax callback is undefined!"):void BJUI.debug("The ajax url is undefined!")},getPageTarget:function(){return this.closest(".bjui-layout").length?this.closest(".bjui-layout"):this.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog},resizePageH:function(){return this.each(function(){if(!t(this).closest(".tab-content").length){var e=t(this),a=e.find("> .bjui-pageHeader"),i=e.find("> .bjui-pageContent"),n=e.find("> .bjui-pageFooter"),o=a.outerHeight()||0,l=n.outerHeight()||0;n.css("bottom")&&(l+=parseInt(n.css("bottom"))||0),!l&&e.hasClass("dialogContent")&&(l=5),i.css({top:o,bottom:l})}})},getMaxIndexObj:function(e){var a=0,i=0;return e.each(function(e){var n=parseInt(t(this).css("zIndex"))||1;a<n&&(a=n,i=e)}),e.eq(i)},serializeJson:function(){var e={},a=this.serializeArray();return t.each(a,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},isTag:function(e){return!!e&&(!!t(this).prop("tagName")&&t(this)[0].tagName.toLowerCase()==e)},isBind:function(e){var a=t(this).data("events");return a&&e&&a[e]},log:function(t){return this.each(function(){console&&console.log("%s: %o",t,this)})}}),t.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(){return new RegExp(/^([-]{0,1}(\d+)[\.]+(\d+))|([-]{0,1}(\d+))$/).test(this)},isNormalID:function(){return new RegExp(/^[a-zA-Z][0-9a-zA-Z_-]*$/).test(this)},includeChinese:function(){return new RegExp(/[\u4E00-\u9FA5]/).test(this)},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(t){return 0===this.indexOf(t)},endsWith:function(t){var e=this.length-t.length;return e>=0&&this.lastIndexOf(t)===e},replaceSuffix:function(t){return this.replace(/\[[0-9]+\]/,"["+t+"]").replace("#index#",t)},replaceSuffix2:function(t){return this.replace(/\-(i)([0-9]+)$/,"-i"+t).replace("#index#",t)},trans:function(){return this.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(t,e){return this.replace(new RegExp(t,"gm"),e)},replacePlh:function(e){return e=e||t(document),this.replace(/{\/?[^}]*}/g,function(t){var a=e.find(t.replace(/[{}]+/g,""));return a&&a.val()?a.val():t})},replaceMsg:function(t){return this.replace(new RegExp("({.*})","g"),t)},replaceTm:function(t){return t?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(e){return t[e.replace(/[{}]+/g,"")]}):this},replaceTmById:function(e){var a=e||t(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_-]*})","g"),function(t){var e=a.find("#"+t.replace(/[{}]+/g,""));return e.val()?e.val():t})},isFinishedTm:function(){return!new RegExp("{/?[^}]*}").test(this)},skipChar:function(t){return this&&0!==this.length?this.charAt(0)===t?this.substring(1).skipChar(t):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},
isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isSpaces:function(){for(var t=0;t<this.length;t+=1){var e=this.charAt(t);if(" "!=e&&"\n"!=e&&"\t"!=e&&"\r"!=e)return!1}return!0},isPhone:function(){return new RegExp(/(^([0-9]{3,4}[-])?\d{3,8}(-\d{1,6})?$)|(^\([0-9]{3,4}\)\d{3,8}(\(\d{1,6}\))?$)|(^\d{3,8}$)/).test(this)},isUrl:function(){return new RegExp(/^[a-zA-z]+:\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){return this.isUrl()&&-1==this.indexOf("://"+document.domain)},toBool:function(){return"true"===this.toLowerCase()},toJson:function(){var t=this;try{return"object"===(void 0===t?"undefined":_typeof(t))&&(t=t.toString()),t.trim().match("^{(.+:.+,*){1,}}$")?JSON.parse(this):this}catch(t){return this}},toObj:function(){var t=null;try{t=new Function("return "+this)()}catch(e){t=this,BJUI.debug('String toObj：Parse "String" to "Object" error! Your str is: '+this)}return t},toFunc:function(){if(this&&this.length){if(this.startsWith("function"))return new Function("return "+this)();try{for(var t=this.split("."),e=window,a=0;a<t.length;a++)e=e[t[a]];if("function"==typeof e)return e}catch(t){return}}}}),t.extend(Function.prototype,{toFunc:function(){return this}}),t.extend(Array.prototype,{remove:function(t){return t<0?this:this.slice(0,t).concat(this.slice(t+1,this.length))},unique:function(){var t=new Array;this.sort();for(var e=0;e<this.length;e++)this[e]!=this[e+1]&&(t[t.length]=this[e]);return t},myIndexOf:function(t){if(!this||!this.length)return-1;for(var e,a=0;e=this[a];a++)if(e==t)return a;return-1},toJson:function(){var e={},a=this;return t.each(a,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e}}),t.isJson=function(e){var a=!0;try{a=t.parseJSON(e)}catch(t){return!1}return!!a}}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.basedrag");s||o.data("bjui.basedrag",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a};a.prototype.init=function(){var t=this;this.options.$obj=this.$element,this.options.obj&&(this.options.$obj=this.options.obj),this.options.event?this.start(this.options.event):this.options.selector?this.$element.find(this.options.selector).on("mousedown",function(e){t.start.apply(t,[e])}):this.$element.on("mousedown",function(e){t.start.apply(t,[e])})},a.prototype.start=function(e){document.onselectstart=function(t){return!1};var a=this;this.options.oleft||(this.options.oleft=parseInt(this.$element.css("left"))||0),this.options.otop||(this.options.otop=parseInt(this.$element.css("top"))||0),t(document).on("mouseup.bjui.basedrag",function(t){a.stop.apply(a,[t])}).on("mousemove.bjui.basedrag",function(t){a.drag.apply(a,[t])})},a.prototype.drag=function(e){e||(e=window.event);var a=this.options,i=a.oleft+(e.pageX||e.clientX)-a.event.pageX,n=a.otop+(e.pageY||e.clientY)-a.event.pageY;if(n<1&&(n=0),"horizontal"==a.move)a.minW&&i>=parseInt(this.options.$obj.css("left"))+a.minW&&a.maxW&&i<=parseInt(this.options.$obj.css("left"))+a.maxW?this.$element.css("left",i):a.scop&&a.relObj&&(parseInt(a.relObj.css("left")),a.cellMinW,this.$element.css("left",i));else if("vertical"==a.move)this.$element.css("top",n);else{var o=a.selector?this.options.$obj.find(a.selector):this.options.$obj;i>=2*-o.outerWidth()/3&&n>=0&&i+o.outerWidth()/3<t(window).width()&&n+o.outerHeight()<t(window).height()&&this.$element.css({left:i,top:n})}return a.drag&&a.drag.apply(this.$element,[this.$element,e,i,n]),this.preventEvent(e)},a.prototype.stop=function(e){return t(document).off("mousemove.bjui.basedrag").off("mouseup.bjui.basedrag"),this.options.stop&&this.options.stop.apply(this.$element,[this.$element,e]),this.options.event&&this.destroy(),document.onselectstart=function(t){return!0},this.preventEvent(e)},a.prototype.preventEvent=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1},a.prototype.destroy=function(){this.$element.removeData("bjui.basedrag"),this.options.nounbind||this.$element.off("mousedown")};var i=t.fn.basedrag;t.fn.basedrag=e,t.fn.basedrag.Constructor=a,t.fn.basedrag.noConflict=function(){return t.fn.basedrag=i,this}}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.slidebar");s||o.data("bjui.slidebar",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}t(function(){t("#bjui-leftside").after("\x3c!-- Adjust the width of Left slide --\x3e").after(FRAG.splitBar).after(FRAG.splitBarProxy)});var a=function(e,a){this.$element=t(e),this.$bar=this.$element.find("#bjui-sidebar"),this.$sbar=this.$element.find("#bjui-sidebar-s"),this.$lock=this.$bar.find("> .toggleCollapse > .lock"),this.$navtab=t("#bjui-navtab"),this.$collapse=this.$sbar.find(".collapse"),this.$split=t("#bjui-splitBar"),this.$split2=t("#bjui-splitBarProxy"),this.isfloat=!1,this.options=a};a.prototype.lock=function(){var e=this,a=e.$bar.outerWidth()+4,i=BJUI.windowWidth-t("#bjui-sidebar").width()-6;e.faLock(),e.hoverLock(),e.$sbar.animate({left:-10},20),e.$bar.removeClass("shadown"),e.isfloat=!1,e.$navtab.animate({left:a,width:i},500,function(){t(window).trigger(BJUI.eventType.resizeGrid)}),e.$split.show()},a.prototype.unlock=function(){var e=this,a=0-e.$bar.outerWidth()-0,i=BJUI.windowWidth-6;e.faUnLock(),e.hoverUnLock(),e.$navtab.animate({left:6,width:i},400),e.$bar.animate({left:a},500,function(){e.$sbar.animate({left:0},200),e.$split.hide(),t(window).trigger(BJUI.eventType.resizeGrid)}),e.isfloat=!1},a.prototype.float=function(){var t=this;t.$sbar.animate({left:-10},200),t.$bar.addClass("shadown").animate({left:0},500),t.isfloat=!0},a.prototype.hideFloat=function(){var t=this,e=0-t.$bar.outerWidth()-0;t.$bar.animate({left:e-10},500,function(){t.$sbar.animate({left:0},100)}),t.isfloat=!1},a.prototype.hoverLock=function(){var t=this;t.$lock.hover(function(){t.tipUnLock(),t.faUnLock()},function(){t.tipLock(),t.faLock()})},a.prototype.hoverUnLock=function(){var t=this;t.$lock.hover(function(){t.tipLock(),t.faLock()},function(){t.tipUnLock(),t.faUnLock()})},a.prototype.tipLock=function(){this.$lock.tooltip("destroy").tooltip({title:"保持锁定，始终显示导航栏",container:"body"})},a.prototype.tipUnLock=function(){this.$lock.tooltip("destroy").tooltip({title:"解除锁定，自动隐藏导航栏",container:"body"})},a.prototype.faLock=function(){this.$lock.find("> i").attr("class","fa fa-lock")},a.prototype.faUnLock=function(){this.$lock.find("> i").attr("class","fa fa-unlock-alt")},a.prototype.init=function(){var e=this;BJUI.ui.showSlidebar?e.hoverLock():e.unlock(),this.$lock.off("click.bjui.slidebar").on("click.bjui.slidebar",function(){e.isfloat?e.lock():e.unlock(),BJUI.ui.showSlidebar=!BJUI.ui.showSlidebar}),this.$collapse.hover(function(){e.float(),e.$navtab.click(function(){e.isfloat&&e.hideFloat()})}),this.$split.mousedown(function(a){e.$split2.each(function(){var i=t(this);return setTimeout(function(){i.show()},100),i.css({visibility:"visible",left:e.$split.css("left")}).basedrag(t.extend(e.options,{obj:e.$bar,move:"horizontal",event:a,stop:function(){t(this).css("visibility","hidden");var a=parseInt(t(this).css("left"))-parseInt(e.$split.css("left")),i=e.$bar.outerWidth()+a,n=parseInt(e.$navtab.css("left"))+a,o=e.$navtab.outerWidth()-a;e.$bar.css("width",i),e.$split.css("left",t(this).css("left")),e.$navtab.css({left:n,width:o})}})),!1})}),t("#bjui-hnav-navbar-box").length&&e.moveHnav()},a.prototype.moveHnav=function(){var e=t("#bjui-hnav-navbar-box"),a=e.find("> #bjui-hnav-navbar"),i=e.prev(),n=e.next();i.hover(function(){a.stop().animate({left:0},2e3,function(){i.hide()})},function(){a.stop(),e.data("hnav.move")&&n.show()}).on("click",function(){return a.stop().animate({left:0},"fast",function(){i.hide()}),!1}),n.hover(function(){a.stop().animate({left:e.width()-e.data("hnav.liw")-10},2e3,function(){n.hide()})},function(){a.stop(),"0px"!=a.css("left")&&i.show()}).on("click",function(){return a.stop().animate({left:e.width()-e.data("hnav.liw")-10},"fast",function(){n.hide()}),!1})},a.prototype.initHnav=function(){var e,a,i,n,o=this,l=o.$element.text().trim(),s=o.$element.parent(),r=t("#bjui-accordionmenu");e=s.find("> .items > ul.ztree"),a=s.find("> .items > ul.menu-items"),(e.length||a.length)&&(e.length&&(n=e),a.length&&(n=n?n.add(a):a,a.find("a").each(function(){var e=t(this),a=e.data("options");!e.data("icon.init")&&a&&"string"==typeof a&&(a=a.toObj())&&a.faicon&&(a.faicon=a.faicon.trim(),a.faicon.startsWith("fa-")&&(a.faicon=a.faicon.substr(3)),e.prepend('<i class="fa fa-'+a.faicon+'"></i>').data("icon.init",!0).attr("title",e.text()))})),r.empty(),n.each(function(e){var a,n,o,s=t(this),d=s.data("faicon"),c=(s.data("faiconClose"),d||"dot-circle-o");s.data("tit")&&(l=s.data("tit")),n=e?"collapsed":"",o=e?"":" in",a=FRAG.slidePanel.replaceAll("#id#","bjui-collapse"+e).replaceAll("#title#",l).replaceAll("#righticon#",'<i class="fa fa-angle-down"></i>').replaceAll("#class#",n).replaceAll("#bodyclass#",o),a=c?a.replaceAll("#icon#",'<i class="fa fa-'+c+'"></i>'):a.replaceAll("#icon#",""),i=t(a),i.find("> .panel-collapse > .panel-body").append(s.removeAttr("data-noinit")),r.append(i),e||i.collapse("show")}),t("#bjui-sidebar").initui(),s.addClass("active").data("bjui.slidebar.hnav.panels",r.find("> .panel")).siblings().removeClass("active"))};var i=t.fn.slidebar;t.fn.slidebar=e,t.fn.slidebar.Constructor=a,t.fn.basedrag.noConflict=function(){return t.fn.slidebar=i,this},t(document).one(BJUI.eventType.afterInitUI,function(e){t("#bjui-leftside").slidebar({minW:150,maxW:700})}),t(document).on("click.bjui.slidebar.data-api",'[data-toggle="slidebar"]',function(a){var i=t(this).parent(),n=t("#bjui-accordionmenu"),o=i.data("bjui.slidebar.hnav.panels");n.find("> .panel").detach(),o&&o.length?(n.append(o),i.addClass("active").siblings().removeClass("active")):e.call(t(this),"initHnav"),a.preventDefault()})}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),l=t.extend({},o.DEFAULTS,n.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=n.data("bjui.contextmenu");s||n.data("bjui.contextmenu",s=new o(this,l)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.init()})}var a,i,n;t(function(){!function(){a=t('<div id="bjui-contextmenu"></div>').hide(),i=t('<div id="bjui-contextmenuShadow"></div>').hide(),n=[],t("body").append("\x3c!-- contextmenu --\x3e").append(a).append(i)}()});var o=function(e,a){this.$element=t(e),this.options=a};o.DEFAULTS={id:void 0,shadow:!0,bindings:{},ctrSub:null},o.prototype.init=function(){var t=this,e=this.options;if(e.id){n.push({id:e.id,shadow:e.shadow,bindings:e.bindings||{},ctrSub:e.ctrSub});var a=n.length-1;this.$element.on("contextmenu",function(i){return t.display(a,this,i,e),!1})}},o.prototype.display=function(e,o,l,s){var r=this,d=n[e],c=BJUI.regional[d.id],u=FRAG[d.id];t.each(c,function(t,e){u=u.replace("#"+t+"#",c[t])}),a.html(u),t.each(d.bindings,function(e,i){t('[rel="'+e+'"]',a).on("click",function(e){r.hide(),i(t(o),t("#bjui-"+d.id))})});var h=l.pageX,f=l.pageY;t(window).width()<h+a.width()&&(h-=a.width()),t(window).height()<f+a.height()&&(f-=a.height()),a.css({left:h,top:f}).show(),d.shadow&&i.css({width:a.width(),height:a.height(),left:h+3,top:f+3}).show(),t(document).one("click",r.hide),t.isFunction(d.ctrSub)&&d.ctrSub(t(o),t("#bjui-"+d.id))},o.prototype.hide=function(){a.hide(),i.hide()},o.prototype.show=function(e){var a=this;e.items&&e.items.length&&a.$element.on("contextmenu",function(i){var n=!0;return e.exclude&&a.$element.find(e.exclude).each(function(){if(this==i.target||t(this).find(i.target).length)return void(n=!1)}),n?(a.custom(e.items,i),!1):(i.stopPropagation(),!n)})},o.prototype.custom=function(e,n){a.empty().html("<ul></ul>");var o,l=this,s=l.options,r=a.find("> ul");t.each(e,function(e,a){var i="";a.icon&&(i='<i class="fa fa-'+a.icon+'"></i>'),"diver"==a.title?o=t('<li class="diver"></li>'):(o=t('<li><span class="icon">'+i+'</span><span class="title">'+a.title+"</span></li>"),a.func&&"string"==typeof a.func&&(a.func=a.func.toFunc()),a.func&&o.on("click",function(t){l.hide(),a.func(l.$element,o)})),o.appendTo(r)});var d=n.pageX,c=n.pageY;t(window).width()<d+a.width()&&(d-=a.width()),t(window).height()<c+a.height()&&(c-=a.height()),a.css({left:d,top:c}).show(),s.shadow&&i.css({width:a.width(),height:a.height(),left:d+3,top:c+3}).show(),t(document).one("click",l.hide)};var l=t.fn.contextmenu;t.fn.contextmenu=e,t.fn.contextmenu.Constructor=o,t.fn.contextmenu.noConflict=function(){return t.fn.contextmenu=l,this}}(jQuery),function(t){function e(e){var a=arguments,i=e,n=t("body"),o=n.data("bjui.navtab")||{};return this.each(function(){var l,s=(t(this),t.extend({},g.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e)),r=s&&s.id;if(r){if(!r.isNormalID())return void BJUI.debug("Navtab Plugin: ID ["+r+"] "+BJUI.regional.idChecked)}else r=o.current?o.current.options.id:BJUI.ui.overwriteHomeTab?"main":"navtab";s.id=r,l=o&&o[r],l?"object"===(void 0===e?"undefined":_typeof(e))&&e&&t.extend(l.options,e):o[r]=l=new g(s),n.data("bjui.navtab",o),"string"==typeof i&&t.isFunction(l[i])?([].shift.apply(a),a?l[i].apply(l,a):l[i]()):l.openTab()})}var a,i,n,o,l,s,r,d,c,u,h,f,p;t(function(){!function(){a=0,o=t("#bjui-navtab"),l=o.find(".navtab-tab"),s=o.find(".navtab-panel"),r=o.find(".tabsLeft"),d=o.find(".tabsRight"),c=o.find(".tabsMore"),u=o.find(".tabsMoreList"),h=l.find("li:first"),f=u.find("li:first"),r.click(function(){t(this).navtab("scrollPrev")}),d.click(function(){t(this).navtab("scrollNext")}),c.click(function(){u.show()}),t(document).on("click.bjui.navtab.switchtab",function(e){var a="I"==e.target.tagName?t(e.target).parent():t(e.target);c[0]!=a[0]&&u.hide()});var e,i;h.navtab("contextmenu",h).click(function(){t(this).hasClass("active")||t(this).navtab("switchTab","main")}).find("> a > span").html(function(t,a){return e=a.replace("#maintab#",BJUI.regional.maintab)}),i=t.extend({},g.DEFAULTS,h.data(),{id:"main",title:e}),h.data("options",t.extend({},i)),h.attr("data-url")&&t(document).one(BJUI.eventType.initUI,function(t){h.removeAttr("data-url").navtab("reload",i)}),setTimeout(function(){f.trigger("click")},100),f.click(function(){t(this).hasClass("active")?u.hide():t(this).navtab("switchTab","main")}).find("> a").html(function(t,e){return e.replace("#maintab#",BJUI.regional.maintab)})}()});var g=function(t){this.options=t,this.tools=this.TOOLS()};g.DEFAULTS={id:null,title:"New tab",url:null,type:"GET",data:{},loadingmask:!0,fresh:!1,autorefresh:!1,onLoad:null,beforeClose:null,onClose:null},g.prototype.TOOLS=function(){var e=this;return{getDefaults:function(){return g.DEFAULTS},getTabs:function(){return l.find("> li")},getPanels:function(){return s.find("> div")},getMoreLi:function(){return u.find("> li")},getTab:function(t){var e=this.indexTabId(t);if(e>=0)return this.getTabs().eq(e)},getPanel:function(t){var e=this.indexTabId(t);if(e>=0)return this.getPanels().eq(e)},getTabsW:function(t,e){return this.tabsW(this.getTabs().slice(t,e))},tabsW:function(e){var a=0;return e.each(function(){a+=t(this).outerWidth(!0)}),a},indexTabId:function(e){var a=-1;return e?(this.getTabs().each(function(i){if(t(this).data("options").id==e)return a=i,!1}),a):a},getLeft:function(){return l.position().left},getScrollBarW:function(){return o.width()-55},visibleStart:function(){var e=this.getTabs(),a=this.getLeft(),i=0,n=0;return e.each(function(e){if(i+a>=0)return n=e,!1;i+=t(this).outerWidth(!0)}),n},visibleEnd:function(){var e=this,a=this.getTabs(),i=this.getLeft(),n=0,o=a.length;return a.each(function(a){if((n+=t(this).outerWidth(!0))+i>e.getScrollBarW())return o=a,!1}),o},scrollPrev:function(){var t=this.visibleStart();t>0&&this.scrollTab(-this.getTabsW(0,t-1))},scrollNext:function(){var t=this.visibleEnd();t<this.getTabs().size()&&this.scrollTab(-this.getTabsW(0,t+1)+this.getScrollBarW())},scrollTab:function(t,a){l.animate({left:t},150,function(){e.tools.ctrlScrollBtn()})},scrollCurrent:function(){var t=this.tabsW(this.getTabs()),e=this.getScrollBarW();t<=e?this.scrollTab(0):this.getLeft()<e-t?this.scrollTab(e-t):a<this.visibleStart()?this.scrollTab(-this.getTabsW(0,a)):a>=this.visibleEnd()&&this.scrollTab(e-this.getTabs().eq(a).outerWidth(!0)-this.getTabsW(0,a))},ctrlScrollBtn:function(){var t=this.tabsW(this.getTabs());this.getScrollBarW()>t?(r.hide(),d.hide(),l.parent().removeClass("tabsPageHeaderMargin")):(r.show().removeClass("tabsLeftDisabled"),d.show().removeClass("tabsRightDisabled"),l.parent().addClass("tabsPageHeaderMargin"),this.getLeft()>=0?r.addClass("tabsLeftDisabled"):this.getLeft()<=this.getScrollBarW()-t&&d.addClass("tabsRightDisabled"))},switchTab:function(o){var l=this.getTabs().removeClass("active").eq(o).addClass("active"),s=this.getPanels(),r=s.eq(o),d=e.options.onSwitch?e.options.onSwitch.toFunc():null,c=t(FRAG.maskBackground);s.css({top:"-10000000px"}),l.data("reloadFlag")?(r.animate({top:0}),e.refresh(l.data("options").id)):r.find(".bjui-ajax-mask").length?r.css({top:0}):(r.css({top:0}).append(c),c.fadeOut("normal",function(){t(this).remove()})),this.getMoreLi().removeClass("active").eq(o).addClass("active"),a=o,this.scrollCurrent(),i=l,t.CurrentNavtab=n=r,d&&d.apply(e);var u=t("body").data("bjui.navtab");e.options.id||t.extend(e.options,l.data("options")),u.current=e,r.trigger("bjui.navtab.switch")},closeTab:function(i,n){var o=this.getTabs().eq(i),l=this.getMoreLi().eq(i),s=this.getPanels().eq(i),r=o.data("options"),d=r.beforeClose?r.beforeClose.toFunc():null,c=r.onClose?r.onClose.toFunc():null,u=!0;if(d&&(u=d.apply(e,[s])),!u)return void e.tools.switchTab(i);if(o.remove(),l.remove(),s.trigger(BJUI.eventType.beforeCloseNavtab).remove(),p&&clearInterval(p),c&&c.apply(e),a>=i&&a--,n){var h=this.indexTabId(n);h>0&&(a=h)}var f=t("body").data("bjui.navtab");f[r.id]&&delete f[r.id],this.scrollCurrent(),this.switchTab(a)},closeOtherTab:function(e){e=e||a,this.getTabs().each(function(a){a>0&&e!=a&&t(this).find("> .close").trigger("click")})},loadUrlCallback:function(t){t.find(":button.btn-close").click(function(){e.closeCurrentTab()})},updateTit:function(t,e){this.getTabs().eq(t).find("> a").attr("title",e).find("> span").html(e),this.getMoreLi().eq(t).find("> a").attr("title",e).html(e)},reload:function(t,a){a=a||t.data("reloadFlag");var i=t.data("options");if(a){t.data("reloadFlag",!1);var n=e.tools.getPanel(i.id);t.hasClass("external")?e.openExternal(i.url,n,i.data):e.tools.reloadTab(n,i)}},reloadTab:function(t,a){var i=a.onLoad?a.onLoad.toFunc():null,n=a.autorefresh&&(isNaN(String(a.autorefresh))?15:a.autorefresh);t.trigger(BJUI.eventType.beforeLoadNavtab).ajaxUrl({type:a.type||"GET",url:a.url,data:a.data||{},loadingmask:a.loadingmask,callback:function(a){e.tools.loadUrlCallback(t),i&&i.apply(e,[t]),p&&clearInterval(p),n&&(p=setInterval(function(){t.navtab("refresh")},1e3*n)),BJUI.ui.clientPaging&&t.data("bjui.clientPaging")&&t.pagination("setPagingAndOrderby",t)}})}}},g.prototype.contextmenu=function(t){var e=this;t.contextmenu({id:"navtabCM",bindings:{reload:function(t,a){t.data("options").url&&e.refresh(t.data("options").id)},closeCurrent:function(t,a){var i=t.data("options").id;i?e.closeTab(i):e.closeCurrentTab()},closeOther:function(t,i){if(t.index()){var n=e.tools.indexTabId(t.data("options").id);e.tools.closeOtherTab(n>0?n:a)}else e.closeAllTab()},closeAll:function(t,a){e.closeAllTab()}},ctrSub:function(t,a){var i=a.find('[rel="reload"]'),n=a.find('[rel="closeCurrent"]');a.find('[rel="closeOther"]'),a.find('[rel="closeAll"]'),e.tools.getTabs();t.index()||(n.addClass("disabled"),t.data("options").url||i.addClass("disabled"))}})},g.prototype.openTab=function(){var e,i=this,n=this.options,o=this.tools;if(!n.url&&n.href&&(n.url=n.href),!n.url)return void BJUI.debug("Navtab Plugin: Error trying to open a navtab, url is undefined!");if(n.url=decodeURI(n.url).replacePlh(),!n.url.isFinishedTm())return t("body").alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("Navtab Plugin: The new navtab's url is incorrect, url: "+n.url);if(n.url=encodeURI(n.url),(e=n.id?o.indexTabId(n.id):a)>=0){var r=o.getTabs().eq(e),d=o.getPanels().eq(e),c=r.data("options");n.fresh||n.url!=c.url?i.reload(n):n.title!=c.title&&(c.title=n.title,o.updateTit(e,n.title)),a=e,"main"==n.id&&this.contextmenu(r)}else{var h='<li><a href="javascript:" title="#title#"><span>#title#</span></a><span class="close">&times;</span></li>',r=t(h.replaceAll("#title#",n.title)),d=t('<div class="navtabPage unitBox"></div>'),f=t('<li><a href="javascript:" title="#title#">#title#</a></li>'.replaceAll("#title#",n.title));r.appendTo(l),d.appendTo(s),f.appendTo(u),r.data("options",t.extend({},n)),n.external||n.url&&n.url.isExternalUrl()?(r.addClass("external"),this.openExternal(n.url,d,n.data)):(r.removeClass("external"),o.reloadTab(d,n)),a=o.getTabs().length-1,this.contextmenu(r),r.on("click",function(e){t(this).hasClass("active")||i.switchTab(n.id)}).on("click.bjui.navtab.close",".close",function(t){i.closeTab(n.id)}).on("mousedown.bjui.navtab.drag","a",function(e){r.data("bjui.navtab.drag",!0),setTimeout(t.proxy(function(){r.data("bjui.navtab.drag")&&i.drag(e,r,d,f)},i),150),e.preventDefault()}).on("mouseup.bjui.navtab.drag","a",function(t){r.data("bjui.navtab.drag",!1)}),f.on("click",function(){i.switchTab(n.id)})}o.switchTab(a),o.scrollCurrent()},g.prototype.closeTab=function(t){var e=this.tools.indexTabId(t);e>0&&this.tools.closeTab(e)},g.prototype.closeCurrentTab=function(t){a>0&&this.tools.closeTab(a,t)},g.prototype.closeAllTab=function(){this.tools.getTabs().find("> .close").trigger("click")},g.prototype.reloadFlag=function(t){for(var e=t.split(","),i=0;i<e.length;i++){var n=this.tools.getTab(e[i].trim());n&&(this.tools.indexTabId(e[i])==a?this.tools.reload(n,!0):n.data("reloadFlag",!0))}},g.prototype.switchTab=function(t){var e=this.tools.indexTabId(t);this.tools.switchTab(e)},g.prototype.scrollPrev=function(){this.tools.scrollPrev()},g.prototype.scrollNext=function(){this.tools.scrollNext()},g.prototype.refresh=function(t){var e,a;(e=t?"string"==typeof t?this.tools.getTab(t):t:i)&&e.length&&(a=this.tools.getPanel(e.data("options").id),a.removeData("bjui.clientPaging"),this.reload(e.data("options")))},g.prototype.reload=function(e){var i=this,n=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e),o=n.id?this.tools.getTab(n.id):this.tools.getTabs().eq(a);if(o){var l=o.data("options"),s=function(){n.title&&n.title!=l.title&&i.tools.updateTit(o.index(),n.title),o.data("options",t.extend({},l,n)),i.tools.reload(o,!0)};l.reloadWarn?t("body").alertmsg("confirm",l.reloadWarn,{okCall:function(){s()}}):s()}},g.prototype.reloadForm=function(e,a){var o=t.extend({},"object"===(void 0===a?"undefined":_typeof(a))&&a),l=o.id?this.tools.getTab(o.id):i,s=o.id?this.tools.getPanel(o.id):n;if(l&&s){var r=(l.data("options"),{}),d={},c=o.form||s.find("#pagerForm");if(c&&c.length)if(o.type=o.type||c.attr("method")||"POST",o.url=o.url||c.attr("action"),d=c.serializeJson(),e){var u=BJUI.pageInfo;for(var h in u)r[u[h]]=d[u[h]]}else r=d;o.data=t.extend({},o.data||{},r),l.hasClass("external")?this.openExternal(o.url,s,o.data):this.tools.reloadTab(s,o)}},g.prototype.getCurrentPanel=function(){return this.tools.getPanels().eq(a)},g.prototype.checkTimeout=function(){var t=JSON.parse(n.html());t&&t[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrentTab()},g.prototype.openExternal=function(e,a,i){var n=a.closest(".navtab-panel").height();i&&!t.isEmptyObject(i)&&(e.indexOf("?")&&(e+="&"),e+=t.param(i)),a.html(FRAG.externalFrag.replaceAll("{url}",e).replaceAll("{height}",n+"px"))},g.prototype.drag=function(e,a,i,n){var o,s=this,r=s.tools.getTabs(),d=s.tools.getPanels(),c=s.tools.getMoreLi(),u=l.next(".bjui-navtab-drag"),h=(a.prev(),a.next(),a.index()),f=(a.width(),a.position().left),p=[],g=[];r.length<=2||(u.length||(u=t('<div class="bjui-navtab-drag" style="position:absolute; top:0; left:1px; width:2px; height:25px; background:#ff6600; display:none;"></div>'),u.insertAfter(l)),u.css("left",f-2),l.find("> li").each(function(){p.push(t(this).position().left)}),a.find("> a").basedrag({move:"horizontal",oleft:f,drag:function(e,i,n,l){a.addClass("navtab-drag"),g=[n],t.merge(g,p),g.sort(function(t,e){return t-e}),o=t.inArray(n,g),o||(o=1),o==r.length?u.css("left",p[o-1]-2+r.last().width()):u.css("left",p[o]-2),u.show()},stop:function(){a.removeClass("navtab-drag"),u.hide(),h!=o&&(o==r.length?h!=r.length-1&&(a.insertAfter(r.eq(o-1)),i.insertAfter(d.eq(o-1)),n.insertAfter(c.eq(o-1))):(a.insertBefore(r.eq(o)),i.insertBefore(d.eq(o)),n.insertBefore(c.eq(o))))},event:e,nounbind:!0}))};var m=t.fn.navtab;t.fn.navtab=e,t.fn.navtab.Constructor=g,t.fn.navtab.noConflict=function(){return t.fn.navtab=m,this},BJUI.navtab=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.navtab.data-api",'[data-toggle="navtab"]',function(a){var i=t(this),n=i.attr("href"),o=i.data(),l=o.options;l&&("string"==typeof l&&(l=l.toObj()),"object"===(void 0===l?"undefined":_typeof(l))&&t.extend(o,l)),o.title||(o.title=i.text()),n&&!o.url&&(o.url=n),e.call(i,o),a.preventDefault()})}(jQuery),function(t){function e(e){var a=arguments,i=e,n=t("body"),o=n.data("bjui.dialog")||{};return this.each(function(){var s,r=(t(this),t.extend({},l.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e)),d=r&&r.id;if(d){if(!d.isNormalID())return void BJUI.debug("Dialog Plugin: ID ["+d+"] "+BJUI.regional.idChecked)}else d=o.current?o.current.options.id:"dialog";r.id=d,s=o&&o[d],s?"object"===(void 0===e?"undefined":_typeof(e))&&e&&t.extend(s.options,e):o[d]=s=new l(r),n.data("bjui.dialog",o),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.open()})}var a,i,n,o;t(function(){!function(){a=t("#bjui-resizable"),n="dialogShadow",o=l.ZINDEX,t("body").append("\x3c!-- dialog resizable --\x3e").append(FRAG.resizable)}()});var l=function(e){this.$element=t("body"),this.options=e,this.tools=this.TOOLS()};l.DEFAULTS={id:null,title:"New Dialog",url:null,type:"GET",data:{},loadingmask:!0,width:500,height:300,minW:65,minH:40,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,fresh:!1,onLoad:null,beforeClose:null,onClose:null},l.ZINDEX=30,l.prototype.TOOLS=function(){var e=this;return{getDefaults:function(){return l.DEFAULTS},init:function(a){var i=e.options.width>e.options.minW?e.options.width:e.options.minW,o=e.options.height>e.options.minH?e.options.height:e.options.minH,l=t(window).width(),s=t(window).height(),r=e.options.max?0:(s-o)/3;i>l&&(i=l),o>s&&(o=s),a.height(o).width(i).show().css({left:(l-i)/2,top:0,opacity:.1}).animate({top:r>0?r:0,opacity:1}).addClass(n).find("> .dialogContent").height(o-t("> .dialogHeader",a).outerHeight()-6),t("body").find("> .bjui-dialog-container").not(a).removeClass(n)},reload:function(a,i){var n,o,l=a.find("> .dialogContent"),s=i&&i.data;i=i||a.data("options"),n=i.onLoad?i.onLoad.toFunc():null,a.trigger(BJUI.eventType.beforeLoadDialog),i.url?(s&&("string"==typeof s&&(s=s.trim().startsWith("{")?s.toObj():s.toFunc()),"function"==typeof s&&(s=s.apply())),l.ajaxUrl({type:i.type||"GET",url:i.url,data:s||{},loadingmask:i.loadingmask,callback:function(t){n&&n.apply(e,[a]),BJUI.ui.clientPaging&&a.data("bjui.clientPaging")&&a.pagination("setPagingAndOrderby",a)}})):(i.html?(o=i.html,t.isFunction(o.toFunc())&&(o=o.toFunc())):i.target&&(o=t(i.target).html()||a.data("bjui.dialog.target"),t(i.target).empty(),a.data("bjui.dialog.target",o)),l.trigger(BJUI.eventType.beforeAjaxLoad).html(o).initui(),n&&n.apply(e,[a]))},resizeContent:function(e,a,i){e.find("> .dialogContent").css({width:a-12,height:i-e.find("> .dialogHeader").outerHeight()-6}).resizePageH(),t(window).trigger(BJUI.eventType.resizeGrid)}}},l.prototype.open=function(){var e=this,a=e.options,n=t("body"),l=n.data("bjui.dialog"),s=l[a.id],r=s&&s.dialog;if(a.target||t(a.target).length||a.html)a.url=void 0;else{if(!a.url&&a.href&&(a.url=a.href),!a.url)return void BJUI.debug("Dialog Plugin: Error trying to open a dialog, url is undefined!");if(a.url=decodeURI(a.url).replacePlh(),!a.url.isFinishedTm())return BJUI.alertmsg("error",a.warn||BJUI.regional.plhmsg),void BJUI.debug("Dialog Plugin: The new dialog's url is incorrect, url: "+a.url);a.url=encodeURI(a.url)}if(r){var d=r.data("options");this.switchDialog(r),r.is(":hidden")&&r.show(),(a.fresh||a.url!=d.url)&&e.reload(a)}else{var c=BJUI.regional.dialog,u=FRAG.dialog.replace("#close#",c.close).replace("#maximize#",c.maximize).replace("#restore#",c.restore).replace("#minimize#",c.minimize).replace("#title#",c.title);r=t(u).data("options",t.extend({},a)).css("z-index",++o).hide().appendTo(n),r.find("> .dialogHeader > h1 > span.title").html(a.title),this.tools.init(r),a.maxable?r.find("a.maximize").show():r.find("a.maximize").hide(),a.minable?r.find("a.minimize").show():r.find("a.minimize").hide(),a.max&&e.maxsize(r),a.mask?this.addMask(r):a.minable&&t.fn.taskbar&&this.$element.taskbar({id:a.id,title:a.title}),r.on("click",function(a){t(a.target).data("bjui.dialog")||i&&i[0]!=r[0]&&e.switchDialog(r)}).on("click",".btn-close",function(t){e.close(r),t.preventDefault()}).on("click",".dialogHeader > a",function(a){var i=t(this);i.hasClass("close")&&e.close(r),i.hasClass("minimize")&&e.minimize(r),i.hasClass("maximize")&&(e.switchDialog(r),e.maxsize(r)),i.hasClass("restore")&&e.restore(r),a.preventDefault(),a.stopPropagation()}).on("dblclick",".dialogHeader > h1",function(t){a.maxable&&(r.find("> .dialogHeader > a.restore").is(":hidden")?r.find("a.maximize").trigger("click"):r.find("> .dialogHeader > a.restore").trigger("click"))}).on("mousedown.bjui.dialog.drag",".dialogHeader > h1",function(i){e.switchDialog(r),a.drawable&&!r.data("max")&&(r.data("bjui.dialog.task",!0),setTimeout(t.proxy(function(){r.data("bjui.dialog.task")&&e.drag(i,r)},e),150),i.preventDefault())}).on("mouseup.bjui.dialog.drag",".dialogHeader > h1",function(t){r.data("bjui.dialog.task",!1)}).on("mousedown.bjui.dialog.resize",'div[class^="resizable"]',function(i){if(!a.drawable||r.data("max"))return!1;if(!a.resizable)return!1;var n=t(this);e.switchDialog(r),e.resizeInit(i,t("#bjui-resizable"),r,n),n.show(),i.preventDefault()}).on("mouseup.bjui.dialog.resize",'div[class^="resizable"]',function(t){t.preventDefault()}),s.dialog=r,this.tools.reload(r,a)}t.CurrentDialog=i=r,l.current=this},l.prototype.addMask=function(e){var a=e.data("bjui.dialog.mask");e.wrap('<div style="z-index:'+o+'" class="bjui-dialog-wrap"></div>'),e.find("> .dialogHeader > a.minimize").hide(),a&&a.length||(a=t(FRAG.dialogMask),a.css("z-index",1).show().insertBefore(e),e.data("bjui.dialog.mask",a))},l.prototype.refresh=function(e){if(e&&"string"==typeof e)for(var a=e.split(","),n=t("body").data("bjui.dialog"),o=0;o<a.length;o++){var l=n[a[o].trim()].dialog;l&&(l.removeData("bjui.clientPaging"),this.tools.reload(l))}else i&&(i.removeData("bjui.clientPaging"),this.tools.reload(i))},l.prototype.reload=function(e){var a=this,i=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e),n=t("body").data("bjui.dialog"),o=i.id&&n[i.id]&&n[i.id].dialog||a.getCurrent();if(o&&o.length){var l=o.data("options");i=t.extend({},l,i);var s=function(){var e=o.find("> .dialogContent");i.width!=l.width&&(i.max?o.animate({width:i.width},"normal",function(){e.width(i.width)}):(o.width(i.width),e.width(i.width))),i.height!=l.height&&(i.max?o.animate({height:i.height},"normal",function(){e.height(i.height-o.find("> .dialogHeader").outerHeight()-6).resizePageH()}):(o.height(i.height),
e.height(i.height-o.find("> .dialogHeader").outerHeight()-6))),i.maxable!=l.maxable&&(i.maxable?o.find("a.maximize").show():o.find("a.maximize").hide()),i.minable!=l.minable&&(i.minable?o.find("a.minimize").show():o.find("a.minimize").hide()),i.max!=l.max&&i.max&&setTimeout(a.maxsize(o),10),i.mask!=l.mask&&(i.mask?(a.addMask(o),t.fn.taskbar&&a.$element.taskbar("closeDialog",i.id)):i.minable&&t.fn.taskbar&&a.$element.taskbar({id:i.id,title:i.title})),i.title!=l.title&&(o.find("> .dialogHeader > h1 > span.title").html(i.title),o.taskbar("changeTitle",i.id,i.title)),o.data("options",t.extend({},i)),a.tools.reload(o,l)};l.reloadWarn?o.alertmsg("confirm",l.reloadWarn,{okCall:function(){s()}}):s()}},l.prototype.reloadForm=function(e,a){var n,o=t.extend({},"object"===(void 0===a?"undefined":_typeof(a))&&a),l=t("body").data("bjui.dialog");if(o.id?l&&l[o.id]&&(n=l[o.id].dialog):n=i,n){var s=(n.data("options"),{}),r={},d=o.form||n.find("#pagerForm");if(d&&d.length)if(o.type=o.type||d.attr("method")||"POST",o.url=o.url||d.attr("action"),r=d.serializeJson(),e){var c=BJUI.pageInfo;for(var u in c)s[c[u]]=r[c[u]]}else s=r;o.data=t.extend({},o.data||{},s),this.tools.reload(n,o)}},l.prototype.getCurrent=function(){return i},l.prototype.switchDialog=function(e){var a=e.css("z-index");if(i&&i!=e){if(i.data("options").mask)return;var o=i.css("z-index"),l=t("body").data("bjui.dialog");i.css("z-index",a),e.css("z-index",o),t.CurrentDialog=i=e,l.current=this,t.fn.taskbar&&this.$element.taskbar("switchTask",e.data("options").id)}e.addClass(n),t("body").find("> .bjui-dialog-container").not(e).removeClass(n)},l.prototype.close=function(e){if("object"!=(void 0===e?"undefined":_typeof(e))||void 0===e||"null"==typeof e||"null"==e||null==e)return!1;var a=this,n=t("body").data("bjui.dialog"),s="string"==typeof e?n[e].dialog:e,r=s.data("bjui.dialog.mask"),d=s.data("options"),c=s.data("bjui.dialog.target"),u=d.beforeClose?d.beforeClose.toFunc():null,h=d.onClose?d.onClose.toFunc():null,f=!0;if(s&&d){if(u&&(f=u.apply(a,[s])),!f)return void a.switchDialog(s);d.target&&c&&t(d.target).html(c),r&&r.length?(r.remove(),s.unwrap()):t.fn.taskbar&&this.$element.taskbar("closeDialog",d.id),s.animate({top:-s.outerHeight(),opacity:.1},"normal",function(){delete n[d.id],s.trigger(BJUI.eventType.beforeCloseDialog).remove(),h&&h.apply(a),t.CurrentDialog=i=null;var e=t("body").find(".bjui-dialog-container"),r=null;e.length?r=a.$element.getMaxIndexObj(e):o=l.ZINDEX,r&&r.is(":visible")&&(t.CurrentDialog=i=r,a.switchDialog(r))})}},l.prototype.closeCurrent=function(){this.close(i)},l.prototype.checkTimeout=function(){var t=i.find("> .dialogContent"),e=JSON.parse(t.html());e&&e[BJUI.keys.statusCode]==BJUI.statusCode.timeout&&this.closeCurrent()},l.prototype.maxsize=function(e){e.data("original",{top:e.css("top"),left:e.css("left"),width:e.css("width"),height:e.css("height")}).data("max",!0),e.find("> .dialogHeader > a.maximize").hide(),e.find("> .dialogHeader > a.restore").show();var a=t(window).width(),i=t(window).height()-t("#bjui-taskbar").height()-1;e.css({top:0,left:0,width:a,height:i}),this.tools.resizeContent(e,a,i)},l.prototype.restore=function(t){var e=t.data("original"),a=parseInt(e.width),i=parseInt(e.height);t.css({top:e.top,left:e.left,width:a,height:i}),this.tools.resizeContent(t,a,i),t.find("> .dialogHeader > a.maximize").show(),t.find("> .dialogHeader > a.restore").hide(),t.data("max",!1)},l.prototype.minimize=function(e){e.hide(),t.fn.taskbar&&this.$element.taskbar("minimize",e);var a=t("body").find(".bjui-dialog-container:visible"),i=null;a.length&&(i=this.$element.getMaxIndexObj(a)),i&&this.switchDialog(i)},l.prototype.drag=function(e,a){t("#bjui-dialogProxy");a.find("> .dialogContent").css("opacity",".3"),a.basedrag({selector:"> .dialogHeader",stop:function(){a.css({left:a.css("left"),top:a.css("top")}).find("> .dialogContent").css("opacity",1)},event:e,nounbind:!0})},l.prototype.resizeDialog=function(e,a,i){var n=parseInt(e.css("left")),o=parseInt(e.css("top")),l=parseInt(e.css("height")),s=parseInt(e.css("width"));if("n"==i||"nw"==i?parseInt(a.css("top"))-o:l-parseInt(a.css("height")),o<0&&(o=0),a.css({top:o,left:n,width:s+2,height:l+1}).find("> .dialogContent").css("width",s-10),"w"!=i&&"e"!=i){a.find("> .dialogContent").css({height:l-a.find("> .dialogHeader").outerHeight()-6}).resizePageH()}t(window).trigger(BJUI.eventType.resizeGrid)},l.prototype.resizeInit=function(e,a,i,n){var o=this,l=n.attr("tar");t("body").css("cursor",l+"-resize"),a.css({top:i.css("top"),left:i.css("left"),height:i.outerHeight(),width:i.css("width")}).show(),this.options.dragCurrent||(this.options.dragCurrent={$resizable:a,$dialog:i,target:l,oleft:parseInt(a.css("left"))||0,owidth:parseInt(a.css("width"))||0,otop:parseInt(a.css("top"))||0,oheight:parseInt(a.css("height"))||0,ox:e.pageX||e.screenX,oy:e.pageY||e.clientY},t(document).on("mouseup.bjui.dialog.resize",t.proxy(o.resizeStop,o)),t(document).on("mousemove.bjui.dialog.resize",t.proxy(o.resizeStart,o)))},l.prototype.resizeStart=function(e){var a=this.options.dragCurrent;if(a){if(!e)var e=window.event;var i=(e.pageX||e.screenX)-a.ox,n=(e.pageY||e.clientY)-a.oy,o=a.$dialog.data("bjui.dialog.mask");if(o&&o.length||!((e.pageY||e.clientY)<=0||(e.pageY||e.clientY)>=t(window).height()-a.$dialog.find("> .dialogHeader").outerHeight())){var l=a.target,s=a.owidth,r=a.oheight;"n"!=l&&"s"!=l&&(s+=l.indexOf("w")>=0?-i:i),s>=this.options.minW&&(l.indexOf("w")>=0&&a.$resizable.css("left",a.oleft+i),"n"!=l&&"s"!=l&&a.$resizable.css("width",s)),"w"!=l&&"e"!=l&&(r+=l.indexOf("n")>=0?-n:n),r>=this.options.minH&&(l.indexOf("n")>=0&&a.$resizable.css("top",a.otop+n),"w"!=l&&"e"!=l&&a.$resizable.css("height",r))}}},l.prototype.resizeStop=function(e){var a=this.options.dragCurrent;if(!a)return!1;t(document).off("mouseup.bjui.dialog.resize").off("mousemove.bjui.dialog.resize"),this.options.dragCurrent=null,this.resizeDialog(a.$resizable,a.$dialog,a.target),t("body").css("cursor",""),a.$resizable.hide()};var s=t.fn.dialog;t.fn.dialog=e,t.fn.dialog.Constructor=l,t.fn.dialog.noConflict=function(){return t.fn.dialog=s,this},BJUI.dialog=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.dialog.data-api",'[data-toggle="dialog"]',function(a){var i=t(this),n=i.attr("href"),o=i.data(),l=o.options;l&&("string"==typeof l&&(l=l.toObj()),"object"===(void 0===l?"undefined":_typeof(l))&&t.extend(o,l)),o.title||(o.title=i.text()),n&&!o.url&&(o.url=n),e.call(i,o),a.preventDefault()})}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),o=t.extend({},u.DEFAULTS,n.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),l=n.data("bjui.taskbar");l?l.options.id!=o.id&&n.data("bjui.taskbar",l=new u(this,o)):n.data("bjui.taskbar",l=new u(this,o)),"string"==typeof i&&t.isFunction(l[i])?([].shift.apply(a),a?l[i].apply(l,a):l[i]()):l.init()})}var a,i,n,o,l,s,r,d,c;t(function(){!function(){a=t("#bjui-resizable"),i=t(FRAG.taskbar),n=i.find(".taskbarContent"),o=n.find("> ul"),l=i.find(".taskbarLeft"),s=i.find(".taskbarRight"),r="disabled",d="selected",c="taskbarMargin",t("body").append("\x3c!-- dialog task bar --\x3e").append(i),l.click(function(e){t(this).taskbar("scrollLeft")}),s.click(function(e){t(this).taskbar("scrollRight")})}()});var u=function(e,a){this.$element=t(e),this.$task=null,this.options=a,this.tools=this.TOOLS()};u.DEFAULTS={id:void 0,title:void 0},u.prototype.init=function(){var e=this,a=o.find("#task-"+this.options.id);if(this.show(),a.length)a.find("> div > span.title").html(this.options.title);else{a=t('<li id="#taskid#"><div class="taskbutton"><span><i class="fa fa-th-large"></i></span> <span class="title">#title#</span></div><div class="close"><i class="fa fa-times-circle"></i></div></li>'.replace("#taskid#","task-"+this.options.id).replace("#title#",this.options.title)),a.appendTo(o)}this.contextmenu(a),this.switchTask(a),this.tools.scrollTask(a),a.click(function(i){if(t(i.target).closest("div").hasClass("close")||t(i.target).hasClass("close"))a.dialog("close",e.options.id);else{var n=t("body").data("bjui.dialog"),o=n[e.options.id].dialog;a.hasClass("selected")?o.find(".dialogHeader a.minimize").trigger("click"):o.is(":hidden")?e.restoreDialog(o):(o.trigger("click"),a.addClass(d)),e.scrollCurrent(a)}return!1})},u.prototype.TOOLS=function(){return{scrollCurrent:function(){if(this.tasksW(this.getTasks())>this.getTaskBarW()){var t=this,e=o.find("> li:last-child"),a=this.getTaskBarW()-e.position().left-e.outerWidth(!0);o.animate({left:a},200,function(){t.ctrlScrollBtn()})}else this.ctrlScrollBtn()},getTaskBarW:function(){return n.width()-(l.is(":hidden")?l.width()+2:0)-(s.is(":hidden")?s.width()+2:0)},scrollTask:function(t){var e=this;if(t.position().left+this.getLeft()+t.outerWidth()>this.getBarWidth()){var a=this.getTaskBarW()-t.position().left-t.outerWidth(!0)-2;o.animate({left:a},200,function(){e.ctrlScrollBtn()})}else if(t.position().left+this.getLeft()<0){var a=this.getLeft()-(t.position().left+this.getLeft());o.animate({left:a},200,function(){e.ctrlScrollBtn()})}},ctrlScrollBtn:function(){var t=this.tasksW(this.getTasks());this.getTaskBarW()>t?(n.removeClass(c),s.hide(),l.hide(),this.getTasks().eq(0).length&&this.scrollTask(this.getTasks().eq(0))):(n.addClass(c),s.show().removeClass(r),l.show().removeClass(r),this.getLeft()>=0&&l.addClass(r),this.getLeft()<=this.getTaskBarW()-t&&s.addClass(r))},getLeft:function(){return o.position().left},visibleStart:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(e.eq(a).position().left+e.eq(a).outerWidth(!0)+t>=0)return e.eq(a);return e.eq(0)},visibleEnd:function(){for(var t=this.getLeft(),e=this.getTasks(),a=0;a<e.size();a++)if(e.eq(a).position().left+e.eq(a).outerWidth(!0)+t>this.getBarWidth())return e.eq(a);return e.eq(e.size()-1)},getTasks:function(){return o.find("> li")},tasksW:function(e){var a=0;return e.each(function(){a+=t(this).outerWidth(!0)}),a},getBarWidth:function(){return i.innerWidth()},getCurrent:function(){return o.find("li."+d)}}},u.prototype.contextmenu=function(e){var a=this;e.contextmenu({id:"dialogCM",bindings:{reload:function(t){t.dialog("refresh",a.options.id)},closeCurrent:function(t,e){(t.isTag("li")?t:a.tools.getCurrent()).find(".close").trigger("click")},closeOther:function(e,a){o.find("> li").not(e).each(function(e){t(this).find(".close").trigger("click")})},closeAll:function(e,i){a.tools.getTasks().each(function(e){t(this).find(".close").trigger("click")})}},ctrSub:function(t,e){var i=e.find('[rel="closeCurrent"]'),n=e.find('[rel="closeOther"]');a.tools.getCurrent().length?1==a.tools.getTasks().size()&&n.addClass(r):(i.addClass(r),n.addClass(r))}})},u.prototype.closeDialog=function(t){var e="string"==typeof t?this.getTask(t):t;e&&e.length&&(e.remove(),this.tools.getTasks().size()||this.hide(),this.tools.scrollCurrent(),this.$element.removeData("bjui.taskbar"))},u.prototype.minimize=function(e){var i=this,n=t("body").data("bjui.dialog"),o="string"==typeof e?n[e].dialog:e,l=this.getTask(o.data("options").id);a.css({top:o.css("top"),left:o.css("left"),height:o.css("height"),width:o.css("width")}).show().animate({top:t(window).height()-60,left:l.position().left,width:l.outerWidth(),height:l.outerHeight()},250,function(){t(this).hide(),i.inactive(l)})},u.prototype.restoreDialog=function(e){var i=this.getTask(e.data("options").id);a.css({top:t(window).height()-60,left:i.position().left,height:i.outerHeight(),width:i.outerWidth()}).show().animate({top:e.css("top"),left:e.css("left"),width:e.css("width"),height:e.css("height")},250,function(){t(this).hide(),e.show().trigger("click.bjui.taskbar.restore")}),this.switchTask(i)},u.prototype.inactive=function(t){("string"==typeof t?this.getTask(t):t).removeClass(d)},u.prototype.scrollLeft=function(){var t=this.tools.visibleStart();this.tools.scrollTask(t)},u.prototype.scrollRight=function(){var t=this.tools.visibleEnd();this.tools.scrollTask(t)},u.prototype.scrollCurrent=function(t){this.tools.scrollTask(t)},u.prototype.switchTask=function(t){this.tools.getCurrent().removeClass(d),("string"==typeof t?this.getTask(t):t).addClass(d)},u.prototype.getTask=function(t){return o.find("#task-"+t)},u.prototype.changeTitle=function(t,e){var a=this.getTask(t);a&&e&&a.find(".title").html(e)},u.prototype.show=function(){i.is(":hidden")&&i.show().animate({bottom:0},500)},u.prototype.hide=function(){i.is(":visible")&&i.animate({bottom:-50},500,function(){i.hide()})};var h=t.fn.taskbar;t.fn.taskbar=e,t.fn.taskbar.Constructor=u,t.fn.taskbar.noConflict=function(){return t.fn.taskbar=h,this}}(jQuery),function(t){function e(e){var a=arguments,n=e,o=t("body");return this.each(function(){var l,s=t(this),r=t.extend({},i.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e),d=s.data("bjui.ajax");d?this===o[0]?d=new i(this,r):t.extend(d.options,"object"===(void 0===e?"undefined":_typeof(e))&&e):d=new i(this,r),s.data("bjui.ajax",d),"string"==typeof n&&(l=d[n.toLowerCase()],t.isFunction(l)&&([].shift.apply(a),a?l.apply(d,a):l()))})}var a,i=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};i.DEFAULTS={okalert:!0,reload:!0,loadingmask:!0},i.NAVTAB="navtab",i.prototype.TOOLS=function(){var e=this;return{getPagerForm:function(e,a,i){var n=t.extend({},BJUI.pageInfo);if(i||(i=e.find("#pagerForm:first")[0]),e.data("bjui.clientPaging")&&(a=t.extend({},e.data("bjui.clientPaging"),a),e.data("bjui.clientPaging",a)),i)for(var o in n){var l="";a&&a[o]&&(l=a[o]),i[n[o]]?l&&(i[n[o]].value=l):t('<input type="hidden" name="'+n[o]+'" value="'+l+'">').appendTo(t(i))}return i},getTarget:function(){return e.$element.closest(".navtab-panel").length?i.NAVTAB:"dialog"}}},i.prototype.ajaxdone=function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.error?t[BJUI.keys.message]&&BJUI.alertmsg("error",t[BJUI.keys.message]):t[BJUI.keys.statusCode]==BJUI.statusCode.timeout?(BJUI.alertmsg("info",t[BJUI.keys.message]||BJUI.regional.sessiontimeout),BJUI.loadLogin()):t[BJUI.keys.message]&&BJUI.alertmsg("correct",t[BJUI.keys.message])},i.prototype.ajaxerror=function(t,e,a){var i=t.responseText,n=this,o=n.options,l=o.failCallback;"string"==typeof i&&i.startsWith("{")?this.ajaxdone(i.toObj()):BJUI.alertmsg("error","<div>Http status: "+t.status+" "+t.statusText+"</div><div>ajaxOptions: "+e+" </div><div>thrownError: "+a+" </div><div>"+i+"</div>"),l&&("string"==typeof l&&(l=l.toFunc()),"function"==typeof l?l.apply(n,[i,o]):BJUI.debug("The callback function 'failCallback' is incorrect: "+l))},i.prototype.ajaxcallback=function(e){var a=this,i=a.options,n=i.okCallback,o=i.errCallback,l=i.okAfterCallback,s=[],r=[],d=[],c=[],u=function(){"string"==typeof n&&(n=n.toFunc()),"function"==typeof n?n.apply(a,[e,i]):BJUI.debug("The callback function 'okCallback' is incorrect: "+n)};if("string"==typeof e&&(e=e.toObj()),i.okalert&&a.ajaxdone(e),!e[BJUI.keys.statusCode]&&n)return void u();if(e[BJUI.keys.statusCode]==BJUI.statusCode.ok){if(n)return void u();e.tabid&&t.merge(s,e.tabid.split(",")),i.tabid&&t.merge(s,i.tabid.split(",")),e.dialogid&&t.merge(r,e.dialogid.split(",")),i.dialogid&&t.merge(r,i.dialogid.split(",")),e.divid&&t.merge(d,e.divid.split(",")),i.divid&&t.merge(d,i.divid.split(",")),e.datagrid&&t.merge(c,e.datagrid.split(",")),i.datagrid&&t.merge(c,i.datagrid.split(",")),s.length&&(t.unique(s),setTimeout(function(){BJUI.navtab("reloadFlag",s.join(","))},100)),r.length&&(t.unique(r),setTimeout(function(){BJUI.dialog("refresh",r.join(","))},100)),d.length&&(t.unique(d),setTimeout(function(){a.refreshdiv(d.join(","))},100)),c.length&&setTimeout(function(){t.each(c,function(e,a){t("#"+a.trim()).datagrid("refresh")})},100),a.$target==t.CurrentNavtab?a.navtabcallback(e):a.$target==t.CurrentDialog?a.dialogcallback(e):a.divcallback(e),l&&function(){"string"==typeof l&&(l=l.toFunc()),"function"==typeof l?l.apply(a,[e,i]):BJUI.debug("The callback function 'okAfterCallback' is incorrect: "+l)}()}else o&&function(){"string"==typeof o&&(o=o.toFunc()),"function"==typeof o?o.apply(a,[e,i]):BJUI.debug("The callback function 'errCallback' is incorrect: "+o)}()},i.prototype.divcallback=function(e,a,i){var n=this,i=n.options,o=e.forward||i.forward||null,l=e.forwardConfirm||i.forwardConfirm||null;if(i.reload&&!o&&n.refreshlayout(i),i.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),o){var s=function(){t.extend(i,{url:o}),n.refreshlayout(i)};l?BJUI.alertmsg("confirm",l,{okCall:function(){s()}}):s()}},i.prototype.navtabcallback=function(t){var e=this,a=e.options,i=t.closeCurrent||a.closeCurrent||!1,n=t.forward||a.forward||null,o=t.forwardConfirm||a.forwardConfirm||null;if(i&&!n?BJUI.navtab("closeCurrentTab"):a.reload&&!n&&setTimeout(function(){BJUI.navtab("refresh")},100),n){var l=function(){BJUI.navtab("reload",{url:n})};o?BJUI.alertmsg("confirm",o,{okCall:function(){l()},cancelCall:function(){i&&BJUI.navtab("closeCurrentTab")}}):l()}},i.prototype.dialogcallback=function(t){var e=this,a=e.options,i=t.closeCurrent||a.closeCurrent||!1,n=t.forward||a.forward||null,o=t.forwardConfirm||a.forwardConfirm||null;if(i&&!n?BJUI.dialog("closeCurrent"):a.reload&&!n&&setTimeout(function(){BJUI.dialog("refresh")},100),a.reloadNavtab&&setTimeout(function(){BJUI.navtab("refresh")},100),n){var l=function(){BJUI.dialog("reload",{url:n})};o?BJUI.alertmsg("confirm",t.forwardConfirm,{okCall:function(){l()},cancelCall:function(){i&&BJUI.dialog("closeCurrent")}}):l()}},i.prototype.pagecallback=function(e,a){var n=this,o=t.extend({},i.DEFAULTS,e),l=a||null,s=null;l&&l.length?(s=n.tools.getPagerForm(l,o))&&(t.extend(o,t(s).data()),n.reloadlayout({target:l[0],type:t(s).attr("method")||"POST",url:t(s).attr("action"),data:t(s).serializeArray(),loadingmask:o.loadingmask})):n.tools.getTarget()==i.NAVTAB?(l=t.CurrentNavtab,s=n.tools.getPagerForm(l,o),s&&t.extend(o,t(s).data()),n.$element.navtab("reloadForm",!1,o)):(l=t.CurrentDialog,s=n.tools.getPagerForm(l,o),s&&t.extend(o,t(s).data()),n.$element.dialog("reloadForm",!1,o))},i.prototype.doajax=function(e){var a,n=this,o=n.$element;if(e||(e={}),e.loadingmask||(e.loadingmask=!1),e=t.extend({},i.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e),n.options=e,e.target?a=e.target instanceof jQuery?e.target:t(e.target):o[0]!==t("body")[0]&&(a=o.closest(".bjui-layout")),a&&a.length||(a=t.CurrentDialog||t.CurrentNavtab),n.$target=a,!e.url)return void BJUI.debug("Bjuiajax Plugin: 'doajax' method: the url is undefined!");if(e.url=decodeURI(e.url).replacePlh(a),!e.url.isFinishedTm())return BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("Bjuiajax Plugin: 'doajax' method: The url is incorrect: "+e.url);e.url=encodeURI(e.url);var l=(e.callback&&e.callback.toFunc(),function(){e.callback||(e.callback=t.proxy(function(t){n.ajaxcallback(t)},n)),a.doAjax(e)});e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){l()}}):l()},i.prototype.ajaxform=function(e){var a,i=this,n=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e),o=i.$element,l=null,s=null,r=n.callback;if(o[0]===t("body")[0]?(s=n.form)instanceof jQuery||(s=t(n.form)):(s=o,l=s.closest(".bjui-layout")),!s||!s.length||!s.isTag("form"))return void BJUI.debug("Bjuiajax Plugin: 'ajaxform' method: Not set the form!");a=s.attr("enctype"),n.target&&((l=n.target)instanceof jQuery||(l=t(l))),l&&l.length||(l=t.CurrentDialog||t.CurrentNavtab),i.$target=l,n.url=n.url||s.attr("action"),BJUI.isIE(8)&&!n.type&&(s[0].getAttributeNode("method").specified||(n.type="POST")),n.type=n.type||s.attr("method")||"POST",t.extend(i.options,n),r&&(r=r.toFunc());var d=function(e,a,n){r?r.apply(i,[e,s]):t.proxy(i.ajaxcallback(e),i)},c=function(){var e={loadingmask:i.options.loadingmask,type:i.options.type,url:i.options.url,callback:d,error:t.proxy(i.ajaxerror,i)};a&&"multipart/form-data"==a?window.FormData?t.extend(e,{data:new FormData(s[0]),contentType:!1,processData:!1}):t.extend(e,{data:s.serializeArray(),files:s.find(":file"),iframe:!0,processData:!1}):t.extend(e,{data:s.serializeArray()}),i.options.ajaxTimeout&&(e.ajaxTimeout=i.options.ajaxTimeout),s.doAjax(e)};i.options.confirmMsg?BJUI.alertmsg("confirm",i.options.confirmMsg,{okCall:c}):c()},i.prototype.ajaxsearch=function(e){var a,i,n=this,o=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e),l=n.$element,s={pageCurrent:1},r=o.isValid;if(o.target&&(i=t(o.target)),l[0]===t("body")[0]){if(a=o.form,a instanceof jQuery||(a=t(o.form)),!a||!a.length||!a.isTag("form"))return void BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: Not set the form!");o.target?(i=o.target)instanceof jQuery||(i=t(i)):i=a.closest(".bjui-layout"),i&&i.length||(i=t.CurrentDialog||t.CurrentNavtab)}else{if(a=l,i=a.closest(".bjui-layout"),!a.isTag("form"))return void BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: Not set the form!");i&&i.length||(i=t.CurrentDialog||t.CurrentNavtab),o.url||(o.url=a.attr("action"))}if(n.$target=i,o.url||(o.url=a.attr("action")),!o.url)return void BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: The form's action or url is undefined!");if(o.url=decodeURI(o.url).replacePlh(a.closest(".unitBox")),!o.url.isFinishedTm())return BJUI.alertmsg("error",o.warn||BJUI.regional.plhmsg),void BJUI.debug("Bjuiajax Plugin: 'ajaxsearch' method: The form's action or url is incorrect: "+o.url);o.url=encodeURI(o.url),o.type||(o.type=a.attr("method")||"POST"),n.tools.getPagerForm(i,s,a[0]),o.form=a,t.extend(n.options,o);var d=function(){if(i.hasClass("bjui-layout")){var e=a.serializeJson(),l={};if(o.clearQuery){var s=BJUI.pageInfo;for(var r in s)l[s[r]]=e[s[r]];e=l}n.reloadlayout({target:i[0],type:n.options.type,url:n.options.url,data:e,loadingmask:n.options.loadingmask})}else i[0]===t.CurrentNavtab[0]?BJUI.navtab("reloadForm",n.options.clearQuery,o):BJUI.dialog("reloadForm",n.options.clearQuery,o)};r?d():t.fn.validator?a.isValid(function(t){t&&d()}):d()},i.prototype.doload=function(e){var a=this,i=null,n=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e);return t.extend(a.options,n),n.target&&((i=n.target)instanceof jQuery||(i=t(i))),i&&i.length?n.url?(n.url=decodeURI(n.url).replacePlh(),n.url.isFinishedTm()?(n.url=encodeURI(n.url),i.removeData("bjui.clientPaging").data("options",n),void a.reloadlayout(n)):(BJUI.alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("Bjuiajax Plugin: 'doload' method: The url is incorrect: "+n.url))):void BJUI.debug("Bjuiajax Plugin: 'doload' method: The url is undefined!"):void BJUI.debug("Bjuiajax Plugin: 'doload' method: Not set loaded container, like [data-target].")},i.prototype.refreshlayout=function(e){var i,n=this;if(e&&((i=e)instanceof jQuery||(i=t(i))),!i||!i.length)return a&&clearInterval(a),void BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: No argument, can not refresh DIV.(parameters:[selector/jQuery object/element])");if(i&&i.length){if(!i.data("options"))return void BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: The target(DIV) is not a reload layout!");i.removeData("bjui.clientPaging"),n.reloadlayout(i.data("options"))}},i.prototype.reloadlayout=function(e){var i=null,n=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e),o=n&&n.autorefresh&&(isNaN(String(n.autorefresh))?15:n.autorefresh);return n.target&&((i=n.target)instanceof jQuery||(i=t(i))),i&&i.length?i.data("options")?(n=t.extend({},i.data("options"),n),void i.addClass("bjui-layout").data("options",n).ajaxUrl({type:n.type,url:n.url,data:n.data,loadingmask:n.loadingmask,callback:function(t){BJUI.ui.clientPaging&&i.data("bjui.clientPaging")&&i.pagination("setPagingAndOrderby",i),n.callback&&n.callback.apply(this,[i,t]),a&&clearInterval(a),o&&(a=setInterval(function(){i.bjuiajax("refreshlayout",i)},1e3*o))}})):void BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: This target(DIV) is not initialized!"):(a&&clearInterval(a),void BJUI.debug("Bjuiajax Plugin: 'refreshlayout' method: Not set loaded container, like [data-target]."))},i.prototype.refreshdiv=function(t){if(t&&"string"==typeof t)for(var e=t.split(","),a=0;a<e.length;a++)this.refreshlayout("#"+e[a])},i.prototype.ajaxdownload=function(e){var a,i=this,n=t.extend({},"object"===(void 0===e?"undefined":_typeof(e))&&e);if(n.loadingmask=!1,t.extend(i.options,n),n.target&&((a=n.target)instanceof jQuery||(a=t(a))),a&&a.length||(a=t.CurrentDialog||t.CurrentNavtab),i.$target=a,!n.url)return void BJUI.debug("Bjuiajax Plugin: 'ajaxdownload' method: The url is undefined!");if(n.url=decodeURI(n.url).replacePlh(a),!n.url.isFinishedTm())return BJUI.alertmsg("error",n.warn||BJUI.regional.plhmsg),void BJUI.debug("Bjuiajax Plugin: 'ajaxdownload' method: The url is incorrect: "+n.url);var o=function(){var e={};e.failCallback=function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),i.ajaxdone(t),a.trigger("bjui.ajaxError")},e.prepareCallback=function(t){n.loadingmask&&a.trigger("bjui.ajaxStart")},e.successCallback=function(t){a.trigger("bjui.ajaxStop")},n.type&&!n.httpMethod&&(n.httpMethod=n.type),console.log(n),t.extend(e,n),e.data||(e.data={}),void 0===e.data.ajaxrequest&&(e.data.ajaxrequest=!0),t.fileDownload(n.url,e)};n.confirmMsg?BJUI.alertmsg("confirm",n.confirmMsg,{okCall:function(){o()}}):o()},i.prototype.doexport=function(e){var a,n=this,o=n.$element,l=e.target?t(e.target):null;if(!e.url)return void BJUI.debug("Error trying to open a ajax link: url is undefined!");if(e.url=decodeURI(e.url).replacePlh(o.closest(".unitBox")),!e.url.isFinishedTm())return BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("The ajax url is incorrect: "+e.url);var s=function(){l&&l.length||(l=n.tools.getTarget()==i.NAVTAB?t.CurrentNavtab:t.CurrentDialog),a=n.tools.getPagerForm(l),a&&(e.data||(e.data={}),t.extend(e.data,t(a).serializeJson())),t.fileDownload(e.url,{failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),n.ajaxdone(t)},data:e.data||{}})};e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){s()}}):s()},i.prototype.doexportchecked=function(e){var a,n=this,o=n.$element,l=e.target?t(e.target):null;if(!e.url)return void BJUI.debug("Error trying to open a export link: url is undefined!");if(e.url=decodeURI(e.url).replacePlh(o.closest(".unitBox")),!e.url.isFinishedTm())return BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("The ajax url is incorrect: "+e.url);var s=function(){if(!e.group)return void BJUI.alertmsg("error",e.warn||BJUI.regional.nocheckgroup);l&&l.length||(l=n.tools.getTarget()==i.NAVTAB?t.CurrentNavtab:t.CurrentDialog);var o=[],s=l.find(":checkbox[name="+e.group+"]:checked");if(!s.length)return void BJUI.alertmsg("error",BJUI.regional.notchecked);s.each(function(){o.push(t(this).val())}),a=e.idname||"ids",e.data=e.data||{},e.data[a]=o.join(","),t.fileDownload(e.url,{failCallback:function(t,e){t.trim().startsWith("{")&&(t=t.toObj()),n.ajaxdone(t)},data:e.data})};e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){s()}}):s()},i.prototype.doajaxchecked=function(e){var a,n=this,o=n.$element,l=e.target?t(e.target):null;if(e=t.extend({},i.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e),!e.url)return void BJUI.debug("Error trying to open a del link: url is undefined!");if(e.url=decodeURI(e.url).replacePlh(o.closest(".unitBox")),!e.url.isFinishedTm())return BJUI.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("The ajax url is incorrect: "+e.url);var s=function(){if(!e.group)return void BJUI.alertmsg("error",e.warn||BJUI.regional.nocheckgroup);l&&l.length||(l=n.tools.getTarget()==i.NAVTAB||e.isNavtab?t.CurrentNavtab:t.CurrentDialog);var s=[],r=l.find(":checkbox[name="+e.group+"]:checked"),d=e.callback&&e.callback.toFunc();if(!r.length)return void BJUI.alertmsg("error",BJUI.regional.notchecked);r.each(function(){s.push(t(this).val())}),a=e.idname||"ids",e.data=e.data||{},e.data[a]=s.join(","),o.doAjax({type:e.type,url:e.url,data:e.data,callback:d||t.proxy(function(t){n.ajaxcallback(t)},n)})};e.confirmMsg?BJUI.alertmsg("confirm",e.confirmMsg,{okCall:function(){s()}}):s()};var n=t.fn.bjuiajax;t.fn.bjuiajax=e,t.fn.bjuiajax.Constructor=i,t.fn.bjuiajax.noConflict=function(){return t.fn.bjuiajax=n,this},BJUI.ajax=function(){e.apply(t("body"),arguments)},t(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxform"]',function(a){var i=t(this),n=i.data();e.call(i,"ajaxform",n),a.preventDefault()}),t(function(){t.fn.validator?t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('form[data-toggle="ajaxsearch"]').each(function(){var a=t(this),i=a.data();i.isValid=!0,a.validator({valid:function(t){e.call(a,"ajaxsearch",i)}})})}):t(document).on("submit.bjui.bjuiajax.data-api",'form[data-toggle="ajaxsearch"]',function(a){var i=t(this),n=i.data();e.call(i,"ajaxsearch",n),a.preventDefault()})}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadsearch"]',function(a){var i,n=t(this),o=n.closest("form");o&&o.length&&(i=o.data(),i.clearQuery=n.data("clearQuery")||!0,e.call(o,"ajaxsearch",i),a.preventDefault())}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxload"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"===(void 0===o?"undefined":_typeof(o))&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"doload",n),a.preventDefault()}),t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('[data-toggle="autoajaxload"]').each(function(){var a=t(this),i=a.data();i.target=this,e.call(a,"doload",i)})}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="refreshlayout"]',function(a){var i=t(this),n=i.data("target");e.call(i,"refreshlayout",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="reloadlayout"]',function(a){var i=t(this),n=i.data();e.call(i,"reloadlayout",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajax"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"===(void 0===o?"undefined":_typeof(o))&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"doajax",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="ajaxdownload"]',function(a){var i=t(this),n=i.data(),o=n.options;o&&("string"==typeof o&&(o=o.toObj()),"object"===(void 0===o?"undefined":_typeof(o))&&(delete n.options,t.extend(n,o))),n.url||(n.url=i.attr("href")),e.call(i,"ajaxdownload",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexport"]',function(a){var i=t(this),n=i.data();n.url||(n.url=i.attr("href")),e.call(i,"doexport",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doexportchecked"]',function(a){var i=t(this),n=i.data();n.url||(n.url=i.attr("href")),e.call(i,"doexportchecked",n),a.preventDefault()}),t(document).on("click.bjui.bjuiajax.data-api",'[data-toggle="doajaxchecked"]',function(a){var i=t(this),n=i.data();n.url||(n.url=i.attr("href")),e.call(i,"doajaxchecked",n),a.preventDefault()})}(jQuery),function(t){function e(e){var a=arguments,i=e,n=t("body"),l=n.data("bjui.alertmsg");return this.each(function(){var s=(t(this),t.extend({},o.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e));l?l.options=s:l=new o(s),n.data("bjui.alertmsg",l),"string"==typeof i&&t.isFunction(l[i])&&([].shift.apply(a),a?l[i].apply(l,a):l[i]())})}var a,i,n;t(function(){!function(){a=t(FRAG.alertBoxFrag).hide().html(""),i=t(FRAG.alertBackground).hide().html(""),t("body").append("\x3c!-- alert msg box --\x3e").append(a).append("\x3c!-- alert msg box mask bg --\x3e").append(i)}()});var o=function(t){this.options=t,this.tools=this.TOOLS(),this.clearTime=null};o.DEFAULTS={displayPosition:"topcenter",displayMode:"slide",autoClose:null,alertTimeout:3e3,mask:null,types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},fas:{error:"fa-times-circle",info:"fa-info-circle",warn:"fa-exclamation-circle",correct:"fa-check-circle",confirm:"fa-question-circle"}},o.prototype.TOOLS=function(){var e=this
;return{getTitle:function(t){return e.options.title||BJUI.regional.alertmsg.title[t]},keydownOk:function(t){return t.which!=BJUI.keyCode.ENTER||(t.data.target.trigger("click"),!1)},keydownEsc:function(t){t.which==BJUI.keyCode.ESC&&t.data.target.trigger("click")},openPosition:function(){var t=BJUI.alertMsg.displayPosition,i=BJUI.alertMsg.displayMode,n=a.outerHeight(),o={},l={};switch(t?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(t=e.options.displayPosition):t=e.options.displayPosition,i?e.options.displayMode&&"silde"!=e.options.displayMode&&(i=e.options.displayMode):i=e.options.displayMode,t){case"topleft":o={top:0-n,left:0,"margin-left":0},l={top:0};break;case"topcenter":o={top:0-n},l={top:0};break;case"topright":o={top:0-n,left:"auto",right:0,"margin-left":0},l={top:0};break;case"middleleft":o={top:"50%",left:-460,"margin-left":0,"margin-top":0-n/2},l={left:0};break;case"middlecenter":o={top:"0","margin-top":0-n/2},l={top:"50%"};break;case"middleright":o={top:"50%",left:"auto",right:-460,"margin-top":0-n/2},l={right:0};break;case"bottomleft":o={top:"auto",left:0,bottom:0-n,"margin-left":0},l={bottom:0};break;case"bottomcenter":o={top:"auto",bottom:0-n},l={bottom:0};break;case"bottomright":o={top:"auto",left:"auto",right:0,bottom:0-n,"margin-left":0},l={bottom:0}}"slide"==i?a.css(o).show().animate(l,500):"fade"==i?(o.opacity=.1,a.css(o).css(l).show().animate({opacity:1},500)):a.css(o).css(l).show()},closePosition:function(){var n=BJUI.alertMsg.displayPosition,o=BJUI.alertMsg.displayMode,l=a.outerHeight(),s={};switch(n?e.options.displayPosition&&"topcenter"!=e.options.displayPosition&&(n=e.options.displayPosition):n=e.options.displayPosition,o?e.options.displayMode&&"silde"!=e.options.displayMode&&(o=e.options.displayMode):o=e.options.displayMode,n){case"topleft":case"topcenter":case"topright":s={top:0-l};break;case"middleleft":s={left:-460};break;case"middlecenter":s={top:0-l};break;case"middleright":s={right:-460};break;case"bottomleft":case"bottomcenter":case"bottomright":s={bottom:0-l}}"slide"==o?a.animate(s,500,function(){i.hide(),t(this).hide().empty()}):"fade"==o?a.animate({opacity:0},500,function(){i.hide(),t(this).hide().empty()}):(a.hide().remove(),i.hide())},open:function(o,l,s){var r,d,c=this,u="",h=BJUI.alertMsg.alertTimeout;if(s)for(var f=0;f<s.length;f++){var p=s[f].call?"callback":"",g=s[f].cls?s[f].cls:"default",m=s[f].cls&&"green"==s[f].cls?"check":"close";u+=FRAG.alertBtnFrag.replace("#btnMsg#",'<i class="fa fa-'+m+'"></i> '+s[f].name).replace("#callback#",p).replace("#class#",g)}r=t(FRAG.alertBoxFrag.replace("#type#",o).replace("#fa#",e.options.fas[o]).replace("#title#",this.getTitle(o)).replace("#message#",l).replace("#btnFragment#",u)).hide().appendTo("body"),a&&a.length&&a.remove(),a=r,c.openPosition(),n&&(clearTimeout(n),n=null),null==e.options.mask&&e.options.types.info!=o&&e.options.types.correct!=o&&i.show(),null==e.options.autoClose&&(e.options.types.info!=o&&e.options.types.correct!=o||(h?e.options.alertTimeout&&3e3!=e.options.alertTimeout&&(h=e.options.alertTimeout):h=e.options.alertTimeout,n=setTimeout(function(){c.close()},h))),d=a.find(".btn"),d.each(function(a){t(this).on("click",t.proxy(function(){e.tools.close();var t=s[a].call;"string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call()},e)),s[a].keyCode===BJUI.keyCode.ENTER&&t(document).on("keydown.bjui.alertmsg.ok",{target:d.eq(a)},c.keydownOk),s[a].keyCode===BJUI.keyCode.ESC&&t(document).on("keydown.bjui.alertmsg.esc",{target:d.eq(a)},c.keydownEsc)})},alert:function(a,i,n){t.extend(e.options,"object"===(void 0===n?"undefined":_typeof(n))&&n);var o=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null},e.options),l=[{name:o.okName,call:o.okCall,cls:"default",keyCode:BJUI.keyCode.ENTER}];this.open(a,i,l)},close:function(){t(document).off("keydown.bjui.alertmsg.ok").off("keydown.bjui.alertmsg.esc"),this.closePosition()}}},o.prototype.error=function(t,e){this.tools.alert(this.options.types.error,t,e)},o.prototype.info=function(t,e){this.tools.alert(this.options.types.info,t,e)},o.prototype.warn=function(t,e){this.tools.alert(this.options.types.warn,t,e)},o.prototype.ok=function(t,e){this.tools.alert(this.options.types.correct,t,e)},o.prototype.correct=function(t,e){this.tools.alert(this.options.types.correct,t,e)},o.prototype.confirm=function(e,a){t.extend(this.options,"object"===(void 0===a?"undefined":_typeof(a))&&a);var i=t.extend({},{okName:BJUI.regional.alertmsg.btnMsg.ok,okCall:null,cancelName:BJUI.regional.alertmsg.btnMsg.cancel,cancelCall:null},this.options),n=[{name:i.okName,call:i.okCall,cls:"green",keyCode:BJUI.keyCode.ENTER},{name:i.cancelName,call:i.cancelCall,cls:"red",keyCode:BJUI.keyCode.ESC}];this.tools.open(this.options.types.confirm,e,n)};var l=t.fn.alertmsg;t.fn.alertmsg=e,t.fn.alertmsg.Constructor=o,t.fn.alertmsg.noConflict=function(){return t.fn.alertmsg=l,this},BJUI.alertmsg=function(){e.apply(t("body"),arguments)},t(document).on("click.bjui.alertmsg.data-api",'[data-toggle="alertmsg"]',function(a){var i,n=t(this),o=n.data(),l=o.options;if(l&&("string"==typeof l&&(l=l.toObj()),"object"===(void 0===l?"undefined":_typeof(l))&&t.extend(o,l)),!(i=o.type))return!1;o.msg||l.msg&&(o.msg=l.msg),e.call(n,i,o.msg||i,o),a.preventDefault()})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.pagination");s||o.data("bjui.pagination",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};a.DEFAULTS={first:"li.j-first",prev:"li.j-prev",next:"li.j-next",last:"li.j-last",nums:"li.j-num > a",jump:"li.jumpto",pageNumFrag:'<li class="#liClass#"><a href="javascript:;">#pageNum#</a></li>',total:0,pageSize:10,pageNum:10,pageCurrent:1,callback:function(){return!1}},a.prototype.TOOLS=function(){var t=this.options;return{pageNums:function(){return Math.ceil(t.total/t.pageSize)},getInterval:function(){var e=Math.ceil(t.pageNum/2),a=this.pageNums(),i=a-t.pageNum;return{start:(this.getCurrentPage()>e?Math.max(Math.min(this.getCurrentPage()-e,i),0):0)+1,end:(this.getCurrentPage()>e?Math.min(this.getCurrentPage()+e,a):Math.min(t.pageNum,a))+1}},getCurrentPage:function(){var e=parseInt(t.pageCurrent);return isNaN(e)?1:e},hasPrev:function(){return this.getCurrentPage()>1},hasNext:function(){return this.getCurrentPage()<this.pageNums()}}},a.prototype.init=function(){function e(e,i){e.on("click",function(e){var n={pageCurrent:i,pageSize:a.options.pageSize};a.setClientPaging(n),t(this).bjuiajax("pageCallback",n,a.$element.closest(".bjui-layout")),e.preventDefault()})}BJUI.ui.clientPaging&&!this.getClientPaging()&&this.setClientPaging({pageCurrent:this.options.pageCurrent,pageSize:this.options.pageSize});for(var a=this,i=this.options,n=this.tools,o=n.getInterval(),l="",s=FRAG.pagination,r=BJUI.regional.pagination,d=o.start;d<o.end;d++)l+=i.pageNumFrag.replaceAll("#pageNum#",d).replaceAll("#liClass#",d==n.getCurrentPage()?"selected j-num":"j-num");s=s.replaceAll("#pageNumFrag#",l).replaceAll("#pageCurrent#",n.getCurrentPage()).replaceAll("#first#",r.first).replaceAll("#last#",r.last).replaceAll("#prev#",r.prev).replaceAll("#next#",r.next).replaceAll("#jumpto#",r.jumpto).replaceAll("#jump#",r.jump),this.$element.html(s);var c=this.$element.find(i.first),u=this.$element.find(i.prev),h=this.$element.find(i.next),f=this.$element.find(i.last);n.hasPrev()?(c.add(u).find("> span").hide(),e(u,n.getCurrentPage()-1),e(c,1)):c.add(u).addClass("disabled").find("> a").hide(),n.hasNext()?(h.add(f).find("> span").hide(),e(h,n.getCurrentPage()+1),e(f,n.pageNums())):h.add(f).addClass("disabled").find("> a").hide(),this.$element.find(i.nums).each(function(a){e(t(this),a+o.start)}),this.$element.find(i.jump).each(function(){var e=t(this).find(":text"),n=t(this).find(".goto");n.on("click",function(){var n=e.val(),o={pageCurrent:n,pageSize:i.pageSize};n&&n.isPositiveInteger()&&(a.setClientPaging(o),t(this).bjuiajax("pageCallback",o,a.$element.closest(".bjui-layout")))}),e.keyup(function(t){t.keyCode==BJUI.keyCode.ENTER&&n.trigger("click")})})},a.prototype.changePagesize=function(){var t=this,e=t.$element.val(),a={pageSize:e};isNaN(e)||(t.setClientPaging(a),t.$element.bjuiajax("pageCallback",a,t.$element.closest(".bjui-layout")))},a.prototype.orderBy=function(e){var a=this;a.$element.css({cursor:"pointer"}).click(function(){var e=t(this).data("orderField"),i=t(this).data("orderDirection"),n={orderField:e,orderDirection:i};a.setClientPaging(n),t(this).bjuiajax("pageCallback",n,a.$element.closest(".bjui-layout"))})},a.prototype.destroy=function(){this.$element.removeData("bjui.pagination").empty()},a.prototype.getTarget=function(){var e=this;return e.$element.closest(".bjui-layout").length?e.$element.closest(".bjui-layout"):e.$element.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog},a.prototype.getClientPaging=function(){return this.getTarget().data("bjui.clientPaging")},a.prototype.setClientPaging=function(e){if(BJUI.ui.clientPaging){var a=this.getTarget();a.data("bjui.clientPaging",t.extend({},a.data("bjui.clientPaging")||{},e))}},a.prototype.setClientOrder=function(t){if(BJUI.ui.clientPaging){var e=this.getClientPaging();e&&e.orderField||this.setClientPaging(t)}},a.prototype.setPagingAndOrderby=function(t){var e=t.data("bjui.clientPaging");t.find('[data-toggle="pagination"]').pagination("destroy").pagination(e),e.pageSize&&t.find('select[data-toggle-change="changepagesize"]').selectpicker("val",e.pageSize),e.orderField&&t.find('th[data-order-field="'+e.orderField+'"]').addClass(e.orderDirection).siblings().removeClass("asc desc")};var i=t.fn.pagination;t.fn.pagination=e,t.fn.pagination.Constructor=a,t.fn.pagination.noConflict=function(){return t.fn.pagination=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('[data-toggle="pagination"]');i.length&&e.call(i)}),t(document).on("change.bjui.pagination.data-api",'select[data-toggle-change="changepagesize"]',function(a){var i=t(this);i.data();e.call(i,"changePagesize"),a.preventDefault()})}(jQuery),function($){function LZ(t){return(t<0||t>9?"":"0")+t}function formatDate(t,e){e+="";var a,i="",n=0,o="",l="",s=t.getYear()+"",r=t.getMonth()+1,d=t.getDate(),c=t.getDay(),a=t.getHours(),u=t.getMinutes(),h=t.getSeconds(),f={};for(s.length<4&&(s=""+(s-0+1900)),f.y=""+s,f.yyyy=s,f.yy=s.substring(2,4),f.M=r,f.MM=LZ(r),f.MMM=MONTH_NAMES[r-1],f.NNN=MONTH_NAMES[r+11],f.d=d,f.dd=LZ(d),f.E=DAY_NAMES[c+7],f.EE=DAY_NAMES[c],f.H=a,f.HH=LZ(a),f.h=a?a>12?a-12:a:12,f.hh=LZ(f.h),f.K=a>11?a-12:a,f.k=a+1,f.KK=LZ(f.K),f.kk=LZ(f.k),f.a=a>11?"PM":"AM",f.m=u,f.mm=LZ(u),f.s=h,f.ss=LZ(h);n<e.length;){for(o=e.charAt(n),l="";e.charAt(n)==o&&n<e.length;)l+=e.charAt(n++);null!=f[l]?i+=f[l]:i+=l}return i}function _isInteger(t){return new RegExp(/^\d+$/).test(t)}function _getInt(t,e,a,i){for(var n=i;n>=a;n--){var o=t.substring(e,e+n);if(o.length<a)return null;if(_isInteger(o))return o}return null}function parseDate(t,e){t+="",e+="";for(var a,i,n=0,o=0,l="",s="",r=new Date(1900,0,1),d=r.getYear(),c=r.getMonth()+1,u=1,h=r.getHours(),f=r.getMinutes(),p=r.getSeconds(),g="";o<e.length;){for(l=e.charAt(o),s="";e.charAt(o)==l&&o<e.length;)s+=e.charAt(o++);if("yyyy"==s||"yy"==s||"y"==s){if("yyyy"==s&&(a=4,i=4),"yy"==s&&(a=2,i=2),"y"==s&&(a=2,i=4),null==(d=_getInt(t,n,a,i)))return 0;n+=d.length,2==d.length&&(d=d>70?d-0+1900:d-0+2e3)}else if("MMM"==s||"NNN"==s){c=0;for(var m=0;m<MONTH_NAMES.length;m++){var b=MONTH_NAMES[m];if(t.substring(n,n+b.length).toLowerCase()==b.toLowerCase()&&("MMM"==s||"NNN"==s&&m>11)){c=m+1,c>12&&(c-=12),n+=b.length;break}}if(c<1||c>12)return 0}else if("EE"==s||"E"==s)for(var m=0;m<DAY_NAMES.length;m++){var v=DAY_NAMES[m];if(t.substring(n,n+v.length).toLowerCase()==v.toLowerCase()){n+=v.length;break}}else if("MM"==s||"M"==s){if(null==(c=_getInt(t,n,s.length,2))||c<1||c>12)return 0;n+=c.length}else if("dd"==s||"d"==s){if(null==(u=_getInt(t,n,s.length,2))||u<1||u>31)return 0;n+=u.length}else if("hh"==s||"h"==s){if(null==(h=_getInt(t,n,s.length,2))||h<1||h>12)return 0;n+=h.length}else if("HH"==s||"H"==s){if(null==(h=_getInt(t,n,s.length,2))||h<0||h>23)return 0;n+=h.length}else if("KK"==s||"K"==s){if(null==(h=_getInt(t,n,s.length,2))||h<0||h>11)return 0;n+=h.length}else if("kk"==s||"k"==s){if(null==(h=_getInt(t,n,s.length,2))||h<1||h>24)return 0;n+=h.length,h--}else if("mm"==s||"m"==s){if(null==(f=_getInt(t,n,s.length,2))||f<0||f>59)return 0;n+=f.length}else if("ss"==s||"s"==s){if(null==(p=_getInt(t,n,s.length,2))||p<0||p>59)return 0;n+=p.length}else if("a"==s){if("am"==t.substring(n,n+2).toLowerCase())g="AM";else{if("pm"!=t.substring(n,n+2).toLowerCase())return 0;g="PM"}n+=2}else{if(t.substring(n,n+s.length)!=s)return 0;n+=s.length}}if(n!=t.length)return 0;if(2==c)if(d%4==0&&d%100!=0||d%400==0){if(u>29)return 0}else if(u>28)return 0;return(4==c||6==c||9==c||11==c)&&u>30?0:(h<12&&"PM"==g?h=h-0+12:h>11&&"AM"==g&&(h-=12),new Date(d,c-1,u,h,f,p))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");Date.prototype.formatDate=function(t){return formatDate(this,t)},String.prototype.parseDate=function(t){return this.length<t.length&&(t=t.slice(0,this.length)),parseDate(this,t)},Date.prototype.formatDateTm=function(t){var e=this.getFullYear(),a=this.getMonth()+1,i=this.getDate(),n=t.replaceAll("%y",e).replaceAll("%M",a).replaceAll("%d",i);n=replaceTmEval(n);var o=1900,l=0,s=1,r=n.split("-");return r.length>0&&(o=r[0]),r.length>1&&(l=r[1]-1),r.length>2&&(s=r[2]),new Date(o,l,s).formatDate("yyyy-MM-dd")}}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),o=t.extend({},x.DEFAULTS,n.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),l=n.data("bjui.datepicker");l||n.data("bjui.datepicker",l=new x(this,o)),"string"==typeof i&&t.isFunction(l[i])?([].shift.apply(a),a?l[i].apply(l,a):l[i]()):l.init()})}var a,i,n,o,l,s,r,d,c,u,h,f,p,g,m,b,v,y;t(function(){!function(){var e=BJUI.regional.datepicker,x=FRAG.calendarFrag.replace("#close#",e.close).replace("#prev#",e.prev).replace("#next#",e.next).replace("#clear#",e.clear).replace("#ok#",e.ok);a=t(x).hide(),t("body").append("\x3c!-- datepicker --\x3e").append(a),i=a.find("> .main"),n=a.find("a.prev"),o=a.find("a.next"),l=a.find("select[name=year]"),s=a.find("select[name=month]"),r=a.find(".time"),d=r.find(":text"),c=r.find("ul > li"),u=r.find(".hh"),h=r.find(".mm"),f=r.find(".ss"),p=i.find("> .tm"),g=a.find(".close"),m=i.find("> .body > .days"),b=i.find("> .body > .dayNames"),v=a.find(".clearBtn"),y=a.find(".okBtn");var k="",C=BJUI.regional.datepicker;t.each(C.dayNames,function(t,e){k+="<dt>"+e+"</dt>"}),b.html(k),t.each(C.monthNames,function(t,e){var a=t+1;s.append('<option value="'+a+'">'+e+"</option>")}),a.on("selectstart",function(){return!1})}()});var x=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$dateBtn=null;var i=new Date;this.options.minDate=i.formatDateTm(this.options.minDate),this.options.maxDate=i.formatDateTm(this.options.maxDate),this.events={focus_time:"focus.bjui.datepicker.time",click_prev:"click.bjui.datepicker.prev",click_next:"click.bjui.datepicker.next",click_ok:"click.bjui.datepicker.ok",click_days:"click.bjui.datepicker.days",click_clear:"click.bjui.datepicker.clear",click_close:"click.bjui.datepicker.close",click_tm:"click.bjui.datepicker.tm",click_spinner:"click.bjui.datepicker.spinner",mousedown_sp:"mousedown.bjui.datepicker.spinner",mouseup_sp:"mouseup.bjui.datepicker.spinner",change_ym:"change.bjui.datepicker.ym",click_time:"click.bjui.datepicker.time",keydown_time:"keydown.bjui.datepicker.time",keyup_time:"keyup.bjui.datepicker.time"}};x.DEFAULTS={pattern:"yyyy-MM-dd",minDate:"1900-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},x.EVENTS={afterChange:"afterchange.bjui.datepicker"},x.prototype.TOOLS=function(){var e=this,i={changeTmMenu:function(t){p.removeClass("hh").removeClass("mm").removeClass("ss"),t&&(p.addClass(t),d.removeClass("slt").filter("."+t).addClass("slt"))},clickTmMenu:function(a,i){p.find("> ul").hide().filter("."+i).show().find("> li").off(e.events.click_tm).on(e.events.click_tm,function(){var e=t(this),i=parseInt(e.text())<10?"0"+e.text():e.text();a.val(i)})},keydownInt:function(t){if(!(t.keyCode>=48&&t.keyCode<=57||t.keyCode==BJUI.keyCode.DELETE||t.keyCode==BJUI.keyCode.BACKSPACE))return!1},changeTm:function(t,e){var a=parseInt(t.val()),i=parseInt(t.data("start"))||0,n=parseInt(t.data("end")),o=parseInt(t.data("step")||1),l=e?e.data("add")?e.data("add"):-1:0,s=a;1==l?a<=n-o&&(s=a+o):-1==l?a>=i+o&&(s=a-o):a>n?s=n:a<i&&(s=i),s<10&&(s="0"+s),t.val(s)},closeCalendar:function(n){i.changeTmMenu(),n&&(t(document).off(e.events.click_close),a.hide())},get:function(t){return e.options[t]},getDays:function(t,e){return 2==e?t%4||!(t%100)&&t%400?28:29:/4|6|9|11/.test(e)?30:31},minMaxDate:function(t){var e=t.split("-").length-1,a="y-M-d";return 1==e?a="y-M":e||(a="y"),t.parseDate(a)},getMinDate:function(){return this.minMaxDate(e.options.minDate)},getMaxDate:function(){var t=e.options.maxDate,a=t.split("-").length-1,i=this.minMaxDate(t);if(a<2){var n=this.getDays(i.getFullYear(),i.getMonth()+1);i.setDate(n),a||i.setMonth(11)}return i},getDateWrap:function(t){t||(t=this.parseDate(e.sDate)||new Date);var a=t.getFullYear(),i=t.getMonth()+1,n=this.getDays(a,i);return{year:a,month:i,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),days:n,date:t}},changeDate:function(t,a,i){var n=new Date(t,a-1,i||1);return e.sDate=this.formatDate(n),n},changeDateTime:function(t,a,i,n,o,l){var s=new Date(t,a-1,i,n,o,l);return e.sDate=this.formatDate(s),s},changeDay:function(t,e){e||(e=0);var a=this.getDateWrap();return this.changeDate(a.year,a.month+parseInt(e),t)},changeMonth:function(t){var e=l.get(0).selectedIndex,a=l.find("option").length,i=1*s.val()+t;i?13==i&&(e==a-1?i=12:(i=1,e++,l.get(0).selectedIndex=e)):e?(i=12,e--,l.get(0).selectedIndex=e):i=1,s.val(i).change()},parseDate:function(t){return t?t.parseDate(e.options.pattern):null},formatDate:function(t){return t.formatDate(e.options.pattern)},hasHour:function(){return-1!=e.options.pattern.indexOf("H")},hasMinute:function(){return-1!=e.options.pattern.indexOf("m")},hasSecond:function(){return-1!=e.options.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){for(var t=["y","M","d","E"],a=0;a<t.length;a++)if(-1!=e.options.pattern.indexOf(t[a]))return!0;return!1},afterChange:function(t){var a=this.formatDate(t);e.$element.trigger(x.EVENTS.afterChange,{date:t,value:a})}};return i},x.prototype.addBtn=function(){var e=this,a=e.$element;if(!this.$dateBtn&&!this.options.addbtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$dateBtn=t(FRAG.dateBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var i=this.$element.parent(),n=this.$element.addClass("form-control").innerHeight();i.css({position:"relative",display:"inline-block"}),this.$dateBtn.css({height:n,lineHeight:n+"px"}).appendTo(i),this.$dateBtn.on("selectstart",function(){return!1})}},x.prototype.init=function(){this.$element.val()&&(this.sDate=this.$element.val().trim());var e=this,a=(this.options,this.tools),i=a.getDateWrap(),r=a.getMinDate(),d=a.getMaxDate(),c=r.getFullYear(),p=d.getFullYear();l.empty();for(var b=c;b<=p;b++)l.append('<option value="'+b+'"'+(i.year==b?" selected":"")+">"+b+"</option>");s.val(i.month),l.add(s).off(this.events.change_ym).on(this.events.change_ym,function(){if(a.hasTime()){var t=m.find(".slt"),n=a.changeDateTime(l.val(),s.val(),t.data("day"),i.hour,i.minute,i.second);e.create(a.getDateWrap(n),r,d)}else{var t=m.find(".slt"),n=a.changeDate(l.val(),s.val(),t.data("day"));e.create(a.getDateWrap(n),r,d)}}),n.off(this.events.click_prev).on(this.events.click_prev,function(){e.tools.changeMonth(-1)}),o.off(this.events.click_prev).on(this.events.click_prev,function(){e.tools.changeMonth(1)}),v.off(this.events.click_clear).on(this.events.click_clear,function(){e.$element.val(""),a.closeCalendar(!0)}),y.off(this.events.click_ok).on(this.events.click_ok,function(){var t=m.find("dd.slt");if(t.hasClass("disabled"))return!1;var i=a.changeDay(t.data("day"),t.data("month"));a.hasTime()&&(i.setHours(parseInt(u.val())),i.setMinutes(parseInt(h.val())),i.setSeconds(parseInt(f.val()))),a.closeCalendar(!0),e.$element.val(a.formatDate(i)).focus(),a.afterChange(i)}),g.off(this.events.click_close).on(this.events.click_close,function(){a.closeCalendar(!0)}),t(document).on(this.events.click_close,function(i){var n=t(i.target);i.target!=e.$element.get(0)&&(n.closest("#calendar").length||("datepicker"==n.data("toggle")||"datepickerbtn"==n.parent().data("toggle")||"datepickerbtn"==n.data("toggle")?a.closeCalendar(!1):a.closeCalendar(!0)))}),this.create(i,r,d)},x.prototype.create=function(e,n,o){var l=this,s=this.options,g=this.tools,b=new Date(e.year,e.month-1,1),v=b.getDay(),y="";if(v>0){b.setMonth(b.getMonth()-1);for(var x=g.getDateWrap(b),k=x.days-v+1;k<=x.days;k++){var C=new Date(e.year,e.month-2,k),j=C>=n&&C<=o?"":" disabled";y+='<dd class="other'+j+'" data-month="-1" data-day="'+k+'">'+k+"</dd>"}}for(var k=1;k<=e.days;k++){var C=new Date(e.year,e.month-1,k),j=C>=n&&C<=o?"":"disabled";k==e.day&&(j+=" slt"),y+='<dd class="'+j+'" data-day="'+k+'">'+k+"</dd>"}for(var k=1;k<=42-v-e.days;k++){var C=new Date(e.year,e.month,k),j=C>=n&&C<=o?"":" disabled";y+='<dd class="other'+j+'" data-month="1" data-day="'+k+'">'+k+"</dd>"}var w=m.html(y).find("dd");if(w.not(".disabled").off(this.events.click_days).on(this.events.click_days,function(){var e=t(this);if(g.hasTime())w.removeClass("slt"),e.addClass("slt");else{var a=g.changeDay(e.data("day"),e.data("month"));g.closeCalendar(!0),l.$element.val(g.formatDate(a)).focus(),g.afterChange(a)}}),g.hasDate()?i.removeClass("nodate"):i.addClass("nodate"),g.hasTime()){r.show(),u.val(e.hour<10?"0"+e.hour:e.hour).off(this.events.focus_time).on(this.events.focus_time,function(){g.changeTmMenu("hh")});var $=parseInt(e.minute/s.mmStep)*s.mmStep;h.val($<10?"0"+$:$).data("step",s.mmStep).off(this.events.focus_time).on(this.events.focus_time,function(){g.changeTmMenu("mm")}),f.val(g.hasSecond()?e.second<10?"0"+e.second:e.second:"00").data("step",s.ssStep).off(this.events.focus_time).on(this.events.focus_time,function(){g.changeTmMenu("ss")}),a.off("click").on("click",function(e){t(e.target).closest(".time").length||(p.find("> ul").hide(),g.changeTmMenu())}),d.off(this.events.keydown_time).on(this.events.keydown_time,g.keydownInt).each(function(){var e=t(this);e.off(l.events.keyup_time).on(l.events.keyup_time,function(){g.changeTm(e)})}).off(this.events.click_time).on(this.events.click_time,function(){g.clickTmMenu(t(this),t(this).data("type"))});var T=null;c.off(this.events.click_spinner).on(this.events.click_spinner,function(e){var a=t(this);d.filter(".slt").each(function(){g.changeTm(t(this),a)}),e.preventDefault()}).off(this.events.mousedown_sp).on(this.events.mousedown_sp,function(e){var a=t(this);T=setInterval(function(){d.filter(".slt").each(function(){g.changeTm(t(this),a)})},150)}).off(this.events.mouseup_sp).on(this.events.mouseup_sp,function(t){clearTimeout(T)}),g.hasHour()||u.attr("disabled",!0),g.hasMinute()||h.attr("disabled",!0),g.hasSecond()||f.attr("disabled",!0)}else r.hide();this.show()},x.prototype.show=function(){var e=this.$element.offset(),i=e.top+this.$element.get(0).offsetHeight,n=a.outerHeight(!0);i>n&&i>t(window).height()-n&&(i=e.top-n),a.css({left:e.left,top:i}).show().click(function(t){t.stopPropagation()})};var k=t.fn.datepicker;t.fn.datepicker=e,t.fn.datepicker.Constructor=x,t.fn.datepicker.noConflict=function(){return t.fn.datepicker=k,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('[data-toggle="datepicker"]');i.length&&(i.data("nobtn")||e.call(i,"addBtn"))}),t(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepickerbtn"]',function(a){var i=t(this).prevAll('[data-toggle="datepicker"]');i&&i.is(":text")&&(e.call(i,i.data()),a.preventDefault())}),t(document).on("click.bjui.datepicker.data-api",'[data-toggle="datepicker"]',function(a){var i=t(this);i.data("onlybtn")||i.is(":text")&&(e.call(i,i.data()),a.preventDefault())})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.ajaxtab");s||o.data("bjui.ajaxtab",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a};a.DEFAULTS={url:void 0,target:void 0,reload:!1},a.prototype.init=function(){var t=this.options;if(!t.url)return void BJUI.debug("Ajaxtab Plugin: Error trying to open a tab, url is undefined!");if(t.url=decodeURI(t.url).replacePlh(this.$element.closest(".unitBox")),!t.url.isFinishedTm())return this.$element.alertmsg("error",t.warn||BJUI.regional.plhmsg),void BJUI.debug("Ajaxtab Plugin: The new ajaxtab's url is incorrect, url: "+t.url);if(t.url=encodeURI(t.url),!t.target)return void BJUI.debug("Ajaxtab Plugin: Attribute 'target' is not defined!");if(t.reload)this.load();else{this.$element.data("bjui.ajaxtab.reload")?this.$element.tab("show"):this.load()}},a.prototype.load=function(){var e=this.$element,a=this.options;t(a.target).ajaxUrl({url:a.url,data:{},callback:function(){e.data("bjui.ajaxtab.reload",!0).tab("show")}})};var i=t.fn.ajaxtab;t.fn.ajaxtab=e,t.fn.ajaxtab.Constructor=a,t.fn.ajaxtab.noConflict=function(){return t.fn.ajaxtab=i,this},t(document).on("click.bjui.ajaxtab.data-api",'[data-toggle="ajaxtab"]',function(a){var i=t(this),n=i.data();n.url||(n.url=i.attr("href")),e.call(i,n),a.preventDefault()})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend(!0,{},a.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.datagrid");s||o.data("bjui.datagrid",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.datanames={tbody:"bjui.datagrid.tbody.dom",td_html:"bjui.datagrid.td.html",changeData:"bjui.datagrid.tr.changeData"},this.classnames={s_checkbox:"datagrid-checkbox",s_linenumber:"datagrid-linenumber",s_edit:"datagrid-column-edit",s_lock:"datagrid-lock",s_menu:"datagrid-menu-box",s_filter:"datagrid-filter-box",s_showhide:"datagrid-showhide-box",th_cell:"datagrid-cell",th_menu:"datagrid-column-menu",btn_menu:"datagrid-column-menu-btn",th_col:"datagrid-col",th_field:"datagrid-col-field",th_sort:"datagrid-sortable",th_resize:"datagrid-resize-head",th_resizemark:"datagrid-column-resizemark",tr_child:"datagrid-child-tr",tr_edit:"datagrid-edit-tr",tr_add:"datagrid-add-tr",tr_selected:"datagrid-selected-tr",td_edit:"datagrid-edit-td",td_changed:"datagrid-changed",td_child:"datagrid-child-td",td_linenumber:"datagrid-linenumber-td",td_checkbox:"datagrid-checkbox-td",li_asc:"datagrid-li-asc",li_desc:"datagrid-li-desc",li_filter:"datagrid-li-filter",li_showhide:"datagrid-li-showhide",li_lock:"datagrid-li-lock",li_unlock:"datagrid-li-unlock"}};a.DEFAULTS={gridTitle:"",columns:null,data:null,dataUrl:null,updateRowUrl:null,postData:null,loadType:"POST",dataType:"json",local:"remote",fieldSortable:!0,filterThead:!0,sortAll:!1,filterAll:!1,filterMult:!0,selectMult:!1,linenumberAll:!1,showLinenumber:!0,showCheckboxcol:!1,showChildcol:void 0,showEditbtnscol:!1,showTfoot:!1,showToolbar:!1,showNoDataTip:!0,toolbarItem:"",toolbarCustom:"",columnResize:!0,columnMenu:!0,columnShowhide:!0,columnFilter:!1,columnLock:!0,paging:!0,pagingAlign:"center",hasChild:!1,childOptions:{width:"100%",height:"auto",paging:!1,columnMenu:!1,filterThead:!1,childUpdate:!1},editUrl:null,editCallback:null,editMode:"inline",editDialogOp:null,editType:"POST",inlineEditMult:!0,saveAll:!0,addLocation:"first",delUrl:null,delType:"POST",delPK:null,delConfirm:!0,delCallback:null,jsonPrefix:"",contextMenuH:!0,contextMenuB:!1,hScrollbar:!1,fullGrid:!1,importOption:null,exportOption:null,beforeEdit:null,beforeDelete:null,beforeSave:null,afterSave:null,afterDelete:null},a.renderItem=function(e,a,i){if(!i||!i.length)return"";var n="";return t.each(i,function(t,a){if(void 0!==a[e])return n=a[e],!1}),n},a.renderItemMulti=function(e,a,i){if(!i||!i.length)return"";var n=[],o="array"===t.type(e)?e:String(e).split(",");return t.each(i,function(e,a){t.each(o,function(t,e){if(void 0!==a[e])return n.push(a[e]),!1})}),n.join(",")},a.prototype.TOOLS=function(){var e=this,i=e.options,n={getPageCount:function(t,e){return Math.ceil(e/t)},getPageInterval:function(t,e,a){var i=Math.ceil(a/2),n=t-a,o=e>i?Math.max(Math.min(e-i,n),0):0,l=e>i?Math.min(e+i,t):Math.min(a,t);return l-o==a&&(l+=1),l<a&&(l+=1),o+1==l&&(l+=1),{start:o+1,end:l}},getRight:function(a){var i=0,n=a.data("index"),o=e.$tbody.find("> tr:first > td:lt("+(n+1)+")");return o&&o.length||(o=e.$colgroupH.find("> col:lt("+(n+1)+")")),o.each(function(){var e=t(this),a=e.is(":hidden")?0:e.outerWidth();i+=a}),i},getRight4Lock:function(a){var i=0,n=e.$lockTbody.find("> tr:first > td:eq("+a+")"),o=n&&n.prevAll().add(n);return o&&o.length||(o=e.$lockColgroupH.filter(":lt("+(a+1)+")")),o.each(function(){var e=t(this),a=e.is(":hidden")?0:e.outerWidth();i+=a}),i},beforeEdit:function(t,a){var n=i.beforeEdit;return!n||("string"==typeof n&&(n=n.toFunc()),"function"!=typeof n)||n.call(e,t,a)},beforeSave:function(t,a){var n=i.beforeSave;return!n||("string"==typeof n&&(n=n.toFunc()),"function"!=typeof n)||n.call(e,t,a)},afterSave:function(a,n){var o=i.afterSave,l=e.options.childUpdate,s=e.$element.data("bjui.datagrid.parent"),r=function(t){t.closest("table").datagrid("updateRow",t)};if(o&&("string"==typeof o&&(o=o.toFunc()),"function"==typeof o&&o.call(e,a,n)),a.each(function(){t(this).removeData("datagrid.addData")}),s&&l&&("string"==typeof l&&-1===l.indexOf("all")?n.addFlag&&-1!==l.indexOf("add")?r(s):-1!==l.indexOf("edit")&&r(s):r(s)),e.fixedColumnWidth){var d,c,u,h,f=t('<div class="bjui-datagrid"></div>');t.each(e.columnModel,function(a,i){i.fixedWidth&&(d||(d=e.$element.clone().addClass("table table-bordered").appendTo(f),d.prepend(e.$thead.clone()),f.appendTo(t("body")),d.attr("style","width:auto !important;").initui(),d.find("colgroup").remove(),d.find(".datagrid-filter").remove()),c=d.find("> tbody > tr:first-child"),c.hasClass("datagrid-nodata")?(e.$trsH.length>1?rowspan=e.$trsH.length-parseInt(i.th.attr("rowspan")||1,10):rowspan=0,u=d.find("> thead > tr:eq("+rowspan+") > th:eq("+i.th.index()+")").css("width",""),h=u.outerWidth()+5):(u=d.find("> tbody > tr:first-child > td:eq("+a+")").css({width:"","white-space":"nowrap"}),h=u.outerWidth()+5),e.$colgroupH.find("> col").eq(a).css("width",h),e.$colgroupB.find("> col").eq(a).css("width",h),e.$colgroupF&&e.$colgroupF.find("> col").eq(a).css("width",h))}),f&&f.remove(),e.fixedColumnWidth=null}"auto"===i.height&&(e.$boxB.scrollTop(5),e.$boxB.scrollTop&&e.fixedHeight())},afterDelete:function(){var t=i.afterDelete;t&&("string"==typeof t&&(t=t.toFunc()),"function"==typeof t&&t.call(e))},setColspan:function(t,e){t.colspan&&(t.colspan=t.colspan+e-1),t.index=t.index+e-1,t.parent&&this.setColspan(t.parent,e)},setOp:function(t){return t.name?(t.menu=void 0===t.menu||t.menu,t.lock=void 0===t.lock||t.lock,
t.edit=void 0===t.edit||t.edit,t.add=void 0===t.add||t.add,t.quicksort=void 0===t.quicksort||t.quicksort,t.quickfilter=void 0===t.quickfilter||t.quickfilter):t.menu=t.lock=t.edit=t.add=t.quickSort=t.quickfilter=!1,t.hide=void 0!==t.hide&&t.hide,t},createTrsByData:function(a,i){var o;e.$tbody||(e.$tbody=t("<tbody></tbody>")),a&&(o=a.list?a.list:a,e.paging.total=o.length||0,e.paging.total||(o=[]),"object"===(void 0===a?"undefined":_typeof(a))&&e.paging.total&&(a[BJUI.pageInfo.total]&&(e.paging.total=parseInt(a[BJUI.pageInfo.total],10)),a[BJUI.pageInfo.pageSize]&&(i&&e.paging.pageSize!=a[BJUI.pageInfo.pageSize]&&e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.pageSize",a[BJUI.pageInfo.pageSize]),e.paging.pageSize=parseInt(a[BJUI.pageInfo.pageSize],10))),e.paging.pageCount=n.getPageCount(e.paging.pageSize,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount),e.paging.pageCurrent||(e.paging.pageCurrent=1),this.initTbody(o,i)),e.init_tbody||e.$tbody.appendTo(e.$tableB),e.init_thead||e.initThead()},initTbody:function(a,n){var o,l=this,s=e.allData,r=i.dataType||"json",d=e.columnModel,c=e.hiddenFields,u=(e.regional,[]),h=e.attach,f=e.paging,p=0,g=f.pageSize,m=function(){if(r=r.toLowerCase(),a&&(s=e.allData=a),"local"===i.local&&e.$element.data("allData",a),s.length?"local"===i.local?(p=f.pageSize*(f.pageCurrent-1),g=p+f.pageSize,f.total!=s.length&&(f.total=s.length),p>s.length&&(p=f.pageSize*(f.pageCount-1))):s.length>f.pageSize&&(g=f.pageSize):g=0,g>s.length&&(g=s.length),"array"===r&&a&&a.length&&"array"===t.type(a[0])){var m,b=p,v=g,y=[];"local"===i.local&&(b=0,v=s.length);for(var x=b;x<v;x++)o={},m=0,t.each(s[x],function(e,a){var i,n=a;d[m]&&d[m].gridNumber&&m++,d[m]&&d[m].gridCheckbox&&m++,"string"==typeof n&&(n='"'+n+'"'),d[m]&&!d[m].gridEdit?(i='{"'+d[m].name+'":'+n+"}",t.extend(o,JSON.parse(i))):(d[m]&&d[m].gridEdit&&m++,m>=d.length&&c&&c[e-d.length]&&(i='{"'+c[e-d.length]+'":'+n+"}",t.extend(o,JSON.parse(i)))),m++}),y.push(o);s=e.allData=y}for(var x=p;x<g;x++)o=t.extend({},e.allData[x],h),u.push(o);l.createTrs(u,n),e.data=u,e.$element.trigger("afterLoad.bjui.datagrid",{datas:u})};n&&e.$boxM?e.$boxM.show().trigger("bjui.ajaxStop").trigger("bjui.ajaxStart",[50,m]):m()},createTrs:function(a,n){var o=this,l=e.columnModel,s=e.paging,r=[],d=BJUI.doRegional(FRAG.gridEditBtn,e.regional),c=BJUI.doRegional(FRAG.gridExpandBtn,e.regional),u=!1;if(n&&(t.each(l,function(t,a){a.locked&&(e.colLock(a.th,!1),a.lock_refresh=!0)}),e.$tbody.empty(),e.$lockTableH&&e.$lockTableH.empty(),e.$lockTableB&&e.$lockTableB.empty()),!a.length&&!n){var h={};h[l[0].name]="0",u=!0,a=[],a.push(h)}var f=(new Date).getTime();e.begintime=f;for(var p=0,g=a.length;p<g;p++){var m,b,v,y,x,k,C,j,w=a[p],$=l.length,T=i.linenumberAll?(s.pageCurrent-1)*s.pageSize+(p+1):p+1,I=[],B=BJUI.StrBuilder();t.extend(w,{gridNumber:T,gridIndex:p});for(var U=0;U<$;U++){if(m=l[U],b=m.name||"datagrid-noname",v=w[b],k="",C=[],y="",j="",x="",void 0!==v&&"null"!==v&&null!==v||(v=""),y=v,m.align&&(k=' align="'+m.align+'"'),m.gridChild&&(v=c),m.gridCheckbox&&(v='<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'),m.gridEdit&&(v=d,C.push(e.classnames.s_edit)),m.calc){m.calc_count||(m.calc_count=a.length);var D=v&&String(v).isNumber()?Number(v):0;"sum"===m.calc||"avg"===m.calc?m.calc_sum=(m.calc_sum||0)+D:"max"===m.calc?m.calc_max=m.calc_max?m.calc_max<D?D:m.calc_max:D:"min"===m.calc&&(m.calc_min=m.calc_min?m.calc_min>D?D:m.calc_min:D)}if(m.gridChild&&C.push(e.classnames.td_child),m.gridNumber&&C.push(e.classnames.td_linenumber),m.gridCheckbox&&C.push(e.classnames.td_checkbox),C=C.length?' class="'+C.join(" ")+'"':"",n&&m.hidden&&(j=' style="display:none;"'),m.items&&!m.render&&(m.attrs&&m.attrs.multiple?m.render=t.datagrid.renderItemMulti:m.render=t.datagrid.renderItem),m.render&&"string"==typeof m.render&&(m.render=m.render.toFunc()),m.render&&"function"==typeof m.render)if(m.items){"string"==typeof m.items&&(m.items.trim().startsWith("[")?m.items=m.items.toObj():m.items=m.items.toFunc()),e.renderTds||(e.renderTds=[]);"function"==typeof m.items?(p||(e.delayRender||(e.delayRender=0),e.delayRender++,function(a,i,n,o){t.when(o.items.call(e)).done(function(t){o.items=t,e.delayRender--})}(0,0,0,m)),e.renderTds.push({trindex:p,tdindex:U,label:y,data:w,render:m.render})):x=m.render.call(e,y,w,m.items)}else x=m.render.call(e,y,w);B.add("<td").add(k).add(C).add(j).add("><div>").add(x||v).add("</div></td>"),I.push(B.toString())}r.push("<tr>"+I.join("")+"</tr>"),u?(r=[],r.push(o.createNoDataTr(!0)||"")):r.push(o.createChildTr(null,w))}e.$tbody.html(r.join("")),n&&(e.initEvents(),i.editMode&&e.edit(),a.length||o.createNoDataTr(),e.$boxP&&e.$boxP.trigger("bjui.datagrid.paging.jump"),t.each(l,function(t,a){a.lock_refresh&&(e.colLock(a.th,!0),delete a.lock_refresh)}),setTimeout(function(){e.$tableB.initui(),e.$lockTableB&&e.$lockTableB.initui(),e.fixedHeight(),e.$boxM&&e.$boxM.trigger("bjui.ajaxStop").hide()},a.length+1))},replacePlh:function(t,e){return t.replace(/{\/?[^}]*}/g,function(t){var a=t.replace(/[{}]+/g,""),i=e[a];return void 0!==i&&"null"!==i&&null!==i||(i=""),i})},createNoDataTr:function(a){if(e.options.showNoDataTip){if(a)return'<tr class="datagrid-nodata"><td colspan="'+e.columnModel.length+'">'+("string"==typeof e.options.showNoDataTip?e.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td></tr>";e.$tbody.find("> tr").length||t('<tr class="datagrid-nodata"></tr>').html('<td colspan="'+e.columnModel.length+'">'+("string"==typeof e.options.showNoDataTip?e.options.showNoDataTip:BJUI.getRegional("datagrid.noData"))+"</td>").appendTo(e.$tbody)}},createChildTr:function(n,o){if(!(n&&n.next()&&n.next().hasClass(e.classnames.tr_child))&&i.hasChild&&i.childOptions&&i.childOptions.dataUrl){e.childOptions=t.extend(!0,{},a.DEFAULTS,i.childOptions);var l='<tr class="'+e.classnames.tr_child+'"><td colspan="'+e.columnModel.length+'" style="width:100%; padding:10px; background:#FAFAFA;"><table class="table-child"></table></td></tr>';if(!n||!n.length)return l;n.after(l)}},getNoChildTrIndex:function(t){var a;if(isNaN(t)){if(!t||!t.length)return-1;a=t.index()}else a=parseInt(t,10);return e.options.hasChild&&e.options.childOptions&&(a*=2),a},getNoChildDataIndex:function(t){var a;return-1===(a=isNaN(t)?this.getNoChildTrIndex(t):parseInt(t,10))?a:(e.options.hasChild&&e.options.childOptions&&(a/=2),a)},loadData:function(a,n){var o=this,l=i.dataUrl,s=i.dataType||"json";e.columnModel;e.$boxM&&e.$boxM.show().trigger("bjui.ajaxStart"),s=s.toLowerCase(),"array"===s&&(s="text"),i.postData&&("string"==typeof i.postData&&(i.postData.trim().startsWith("{")?i.postData=i.postData.toObj():i.postData=i.postData.toFunc()),"function"==typeof i.postData&&(i.postData=i.postData.apply()),"object"===_typeof(i.postData)&&(a=a?t.extend({},i.postData,a):i.postData)),BJUI.ajax("doajax",{url:l,data:a||{},type:i.loadType,cache:i.cache||!1,dataType:s,okCallback:function(e){if("json"===s)o.createTrsByData(e,n);else if("text"===s)"array"!==t.type(e)&&(e=[]),o.createTrsByData(e,n);else if("xml"===s){var a,i=[];t(e).find("row").each(function(){a={},t(this).find("cell").each(function(e){var i=t(this),n=i.text(),o=i.attr("name");a[o]=n}),i.push(a)}),i.length&&o.createTrsByData(i,n)}else BJUI.debug("Datagrid Plugin: The options 'dataType' is incorrect!")},errCallback:function(){e.destroy()},failCallback:function(){e.destroy()}})},appendColumns:function(){e.childColumn={name:"gridChild",gridChild:!0,width:30,minWidth:30,label:"...",align:"center",menu:!1,edit:!1,quicksort:!1},e.linenumberColumn={name:"gridNumber",gridNumber:!0,width:30,minWidth:30,label:"No.",align:"center",menu:!1,edit:!1,quicksort:!1},e.checkboxColumn={name:"gridCheckbox",gridCheckbox:!0,width:30,minWidth:30,label:"Checkbox",align:"center",menu:!1,edit:!1,quicksort:!1},e.editBtnsColumn={name:"gridEdit",gridEdit:!0,width:110,minWidth:110,label:"string"==typeof i.showEditbtnscol?i.showEditbtnscol:"Edit",align:"center",menu:!1,edit:!1,hide:!1,quicksort:!1}},setBoxbH:function(t){var a,n=t||e.boxH||i.height,o=0;n<100||(isNaN(n)&&("auto"===n?(n=(e.$boxT?e.$boxT.outerHeight():0)+(e.$boxH?e.$boxH.outerHeight():0)+(e.$toolbar?e.$toolbar.outerHeight():0)+(e.$boxP?e.$boxP.outerHeight():0)+(e.$boxB?e.$boxB.outerHeight():0)+(e.$boxF?e.$boxF.outerHeight():0)+25,e.$grid.height(n),e.boxH=n):n=e.$grid.height()),e.$boxT&&(a=e.$boxT.outerHeight(),n-=a,o+=a),e.$toolbar&&(a=e.$toolbar.outerHeight(),n-=a,o+=a),e.$boxP&&(n-=e.$boxP.outerHeight()),e.$boxF&&(n-=e.$boxF.outerHeight()),o+=e.$tableH.outerHeight(),n-=e.$boxH.outerHeight(),n<0&&(n=0),e.$boxB.height(n),e.$boxM.height(n).css({top:o}),e.$lockB&&e.$lockB.height(n),e.$element.data("bjui.datagrid.parent")&&e.$element.data("bjui.datagrid.parent").closest("table").datagrid("fixedHeight"))},showSubMenu:function(a,i,n){var o,l,s=i.outerWidth(),r=n.data("width")||n.outerWidth(),d=e.$boxH.width(),c=function(a,i,n){o=i.offset().left-e.$grid.offset().left-1,l={left:"50%"},a.removeClass("active"),i.hasClass("position-right")||d-o<s+r?(n.css({left:"auto",right:"100%"}),l={right:"50%"}):n.css({left:"100%",right:"auto"}),l.opacity=.2,n.stop().animate(l,"fast",function(){t(this).hide()})};a.hover(function(){if(n.appendTo(a),a.hasClass(e.classnames.li_filter)&&n.is(":visible"))return!1;var t=a.siblings("."+e.classnames.li_filter);t.length&&t.hasClass("active")&&c(t,i,t.find("> ."+e.classnames.s_filter)),o=i.offset().left-e.$grid.offset().left-1,l={left:"100%"},i.hasClass("position-right")||d-o<s+r?(n.css({left:"auto",right:"50%"}),l={right:"100%"}):n.css({left:"50%",right:"auto"}),l.opacity=1,a.addClass("active"),n.show().stop().animate(l,"fast")},function(){if(a.hasClass(e.classnames.li_filter))return!1;c(a,i,n)}),a.on("bjui.datagrid.th.submenu.hide",function(e,a,i){c(t(this),a,i)})},locking:function(t){var a=t.data("index"),i=e.columnModel[a],n=i.lock,o=i.locked,l=e.$menu,s=l.find("> ul"),r=s.find("> li."+e.classnames.li_lock),d=r.next();o?(r.addClass("disable"),d.removeClass("disable")):(d.addClass("disable"),r.removeClass("disable")),n?(r.show().off("click").on("click",function(){r.hasClass("disable")||(l.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!0))}),d.show().off("click").on("click",function(){d.hasClass("disable")||(l.hide().data("bjui.datagrid.menu.btn").removeClass("active"),e.colLock(t,!1))})):(r.hide().off("click"),d.hide().off("click"))},createShowhide:function(){var a;e.$showhide||(e.col_showhide_count=e.columnModel.length,a=t('<ul class="'+e.classnames.s_showhide+'" role="menu"></ul>'),t.each(e.columnModel,function(i,n){(n.gridNumber||n.gridCheckbox||n.gridEdit)&&e.col_showhide_count--;var o=t(FRAG.gridShowhide.replaceAll("#index#",n.index).replaceAll("#label#",n.label||"")).toggleClass("nodisable",!!(n.gridNumber||n.gridCheckbox||n.gridEdit));!function(i){o.click(function(){if(t(this).hasClass("disable"))return!1;var n=t(this),o=!n.find("i").hasClass("fa-check-square-o");i.index;n.toggleClass("datagrid-col-check").find("i").attr("class","fa fa"+(o?"-check":"")+"-square-o"),e.showhideColumn(i.th,o),i.gridNumber||i.gridCheckbox||i.gridEdit||(e.col_showhide_count=o?e.col_showhide_count+1:e.col_showhide_count-1),1==e.col_showhide_count?a.find("> li.datagrid-col-check").addClass("disable"):a.find("> li.disable").removeClass("disable"),a.find("> li.nodisable").removeClass("disable")})}(n),o.appendTo(a),n.hide&&o.trigger("click")}),a.appendTo(e.$grid),a.data("width",a.outerWidth()),e.$showhide=a)},showhide:function(t,a){var i=t.index,n=t.th,o=e.$tbody.find("> tr"),l=a?"":"none";void 0===t.hidden&&(t.hidden=!1),t.hidden!==!a&&(t.hidden=!a,n.css("display",l),o.find("> td:eq("+i+")").css("display",l),e.$colgroupH.find("> col").eq(i).css("display",l),e.$colgroupB.find("> col").eq(i).css("display",l),e.$thead.find("> tr.datagrid-filter > th:eq("+i+")").css("display",l),e.$boxF&&(e.$tableF.find("> thead > tr > th:eq("+i+")").css("display",l),e.$colgroupF.find("> col").eq(i).css("display",l)),t.calc&&e.$tfoot&&e.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),t.parent&&function t(e){var i=e.colspan;a?i++:i--,i?e.th.css("display",""):e.th.css("display","none"),e.th.attr("colspan",i),e.colspan=i,e.parent&&t(e.parent)}(t.parent),e.$tbody.find("> tr."+e.classnames.tr_child+":visible > td table").trigger("bjui.datagrid.child.resize"))},jumpPage:function(t,a){var n,o=e.allData;t&&(e.paging.oldPageCurrent=e.paging.pageCurrent,e.paging.pageCurrent=t),a&&(e.paging.oldPageSize=e.paging.pageSize,e.paging.pageSize=a,e.paging.pageCount=this.getPageCount(a,e.paging.total),e.paging.pageCurrent>e.paging.pageCount&&(e.paging.pageCurrent=e.paging.pageCount)),"remote"===i.local?(n=this.getRemoteFilterData(!0),this.loadData(n,!0)):this.initTbody(o,!0)},quickSort:function(t){if(e.isDom){if("local"===i.local)return;i.sortAll=!0}if(e.$tbody.find("> tr."+e.classnames.tr_edit).length)return void e.$tbody.alertmsg("info",BJUI.getRegional("datagrid.editMsg"));var a,n,o=t.th,l=e.data,s=e.allData,r=t.name,d=t.type,c=e.$thead.find("> tr > th.datagrid-quicksort-th");r||(r="datagrid-noname");var u=function(e){e.sort(function(e,a){var i=(_typeof(e[r]),_typeof(a[r]));return"boolean"===d||"number"===d||"number"===i||"boolean"===i?t.sortAsc?e[r]-a[r]:a[r]-e[r]:t.sortAsc?String(e[r]).localeCompare(a[r]):String(a[r]).localeCompare(e[r])})};c.find("> div > .datagrid-label > i").remove(),t.sortAsc?(n="desc",t.sortAsc=!1):(n="asc",t.sortAsc=!0),o.find("> div > .datagrid-label").prepend('<i class="fa fa-long-arrow-'+(t.sortAsc?"up":"down")+'"></i>'),i.sortAll?"remote"===i.local?(a={},a[BJUI.pageInfo.orderField]=r,a[BJUI.pageInfo.orderDirection]=n,a[BJUI.pageInfo.pageSize]=e.paging.pageSize,a[BJUI.pageInfo.pageCurrent]=e.paging.pageCurrent,this.loadData(a,!0)):(u(s),this.initTbody(s,!0)):(u(l),this.createTrs(l,!0))},quickFilter:function(a,n){if(e.isDom){if("remote"!=i.local)return void BJUI.debug("Datagrid Plugin: Please change the local option is remote!");if(!i.dataUrl)return void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!")}var o,l=this,s=(a.th,e.data),r=e.allData,d=a.name,c=function(e,a,i,n){var o=!1;switch(e){case"=":o=String(a)===String(i);break;case"!=":o=String(a)!==String(i);break;case">":o=parseFloat(i)>parseFloat(a);break;case"<":o=parseFloat(i)<parseFloat(a);break;case"like":n&&"select"===n.type?(o=String(a)===String(i),n.attrs&&n.attrs.multiple&&t.isArray(a)&&(o=-1!=t.inArray(i,a))):o=String(i).indexOf(String(a))>=0}return o},u=function(e,a){var i=function(e){var i=0;return t.each(a,function(t,a){var n=a.datas;if(i++,!n)return i--,a.model.isFiltered=!1,a.model.th.trigger("bjui.datagrid.th.filter",[!1]),a.model.$quickfilter&&a.model.$quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0;a.model.isFiltered=!0,a.model.th.trigger("bjui.datagrid.th.filter",[!0]),n.andor?"and"===n.andor?c(n.operatorA,n.valA,e[t],a.model)&&c(n.operatorB,n.valB,e[t],a.model)&&i--:"or"===n.andor&&(c(n.operatorA,n.valA,e[t],a.model)||c(n.operatorB,n.valB,e[t],a.model))&&i--:n.operatorB?c(n.operatorB,n.valB,e[t],a.model)&&i--:c(n.operatorA,n.valA,e[t],a.model)&&i--}),!i};return t.grep(e,function(t,e){return i(t)})};e.filterDatas||(e.filterDatas={}),i.filterMult?e.filterDatas[d]={datas:n,model:a}:(e.filterDatas={},e.filterDatas[d]={datas:n,model:a}),"remote"!==i.local&&r&&(e.oldAllData?r=e.oldAllData.concat():e.oldAllData=r.concat()),i.filterAll?"remote"===i.local?l.loadData(l.getRemoteFilterData(),!0):(o=u(r,e.filterDatas),e.paging.pageCurrent=1,e.paging.pageCount=this.getPageCount(e.paging.pageSize,o.length),this.initTbody(o,!0)):e.isDom?l.loadData(l.getRemoteFilterData(),!0):(e.oldData?s=e.oldData.concat():e.oldData=s.concat(),o=u(s,e.filterDatas),this.createTrs(o,!0))},getRemoteFilterData:function(a,n,o){var l={};return e.filterDatas&&!t.isEmptyObject(e.filterDatas)&&(t.each(e.filterDatas,function(t,e){if(!e.datas)return e.model.isFiltered=!1,e.model.th.trigger("bjui.datagrid.th.filter",[!1]),e.model.$quickfilter&&e.model.$quickfilter.trigger("bjui.datagrid.thead.clearfilter"),!0;e.model.isFiltered=!0,e.model.th.trigger("bjui.datagrid.th.filter",[!0]),i.jsonPrefix&&(t=i.jsonPrefix+"."+t),e.datas.andor&&(l.andor=e.datas.andor),e.datas.operatorA&&(l[t]=e.datas.valA,l[t+".operator"]=e.datas.operatorA),e.datas.operatorB&&(l[t]?(l[t]=[l[t],e.datas.valB],l[t+".operator"]=[l[t+".operator"],e.datas.operatorB]):(l[t]=e.datas.valB,l[t+".operator"]=e.datas.operatorB))}),a||(e.paging.pageCurrent=1)),l[BJUI.pageInfo.pageSize]=e.paging.pageSize,l[BJUI.pageInfo.pageCurrent]=e.paging.pageCurrent,e.$element.data("filterDatas",l),l},setDomData:function(a){var i=e.columnModel,n={},o=a.attr("data-hidden-datas"),l=e.attach;return a.find("> td").each(function(e){var a=t(this),o=i[e],l=a.attr("data-val")||a.text();o.name?n[o.name]=l:n["datagrid-noname"+e]=l}),o&&(o=o.toObj()),t.extend(n,l,{gridNumber:a.index()+1},o),a.data("initData",n),n},initEditInputs:function(){var a=e.columnModel;return e.inputs=[],t.each(a,function(a,i){var n=i.name,o="",l="",s=[],r="";if(i)if(i.attrs&&"object"===_typeof(i.attrs)&&t.each(i.attrs,function(t,e){"object"===(void 0===e?"undefined":_typeof(e))&&(e=JSON.stringify(e).replaceAll('"',"'")),r+=" "+t+"="+e}),i===e.childColumn||i===e.linenumberColumn||i===e.checkboxColumn||i===e.editBtnsColumn)e.inputs.push("");else if(n)if(i.rule?o=' data-rule="'+i.label+"："+i.rule+'"':"date"===i.type&&(o=' data-rule="pattern('+(i.pattern||"yyyy-MM-dd")+')"'),i.type)switch(i.type){case"date":i.pattern||(i.pattern="yyyy-MM-dd"),l=' data-pattern="'+i.pattern+'"',e.inputs.push('<input type="text" name="'+n+'" data-toggle="datepicker"'+l+o+r+">");break;case"select":if(!i.items)return;t.each(i.items,function(e,a){t.each(a,function(t,e){s.push('<option value="'+t+'">'+e+"</option>")})}),e.inputs.push('<select name="'+n+'" data-toggle="selectpicker"'+o+r+' data-width="100%">'+s.join("")+"</select>");break;case"boolean":e.inputs.push('<input type="checkbox" name="'+n+'" data-toggle="icheck"'+o+r+' value="true">');break;case"lookup":e.inputs.push('<input type="text" name="'+n+'" data-toggle="lookup" data-custom-event="true"'+o+r+">");break;case"findgrid":e.inputs.push('<input type="text" name="'+n+'" data-toggle="findgrid" data-custom-event="true"'+o+r+">");break;case"spinner":e.inputs.push('<input type="text" name="'+n+'" data-toggle="spinner"'+o+r+">");break;case"textarea":e.inputs.push('<textarea data-toggle="autoheight" rows="1"'+o+r+"></textarea>");break;default:e.inputs.push('<input type="text" name="'+n+'"'+o+r+">")}else e.inputs.push('<input type="text" name="'+n+'"'+o+r+">");else e.inputs.push("")}),e.inputs},contextmenuH:function(){var a=this;e.$tableH.on("contextmenu","tr:not(.datagrid-filter)",function(i){e.$showhide||a.createShowhide();var n=i.pageX,o=i.pageY;t(window).width()<n+e.$showhide.width()&&(n-=e.$showhide.width()),t(window).height()<o+e.$showhide.height()&&(o-=e.$showhide.height()),e.$menu&&e.$grid.trigger("click.bjui.datagrid.filter"),e.$showhide.appendTo("body").css({left:n,top:o,opacity:1,"z-index":9999}).show(),t(document).on("click",function(a){t(a.target).closest("."+e.classnames.s_showhide).length||e.$showhide.css({left:"50%",top:0,opacity:.2,"z-index":""}).hide().appendTo(e.$grid)}),i.preventDefault(),i.stopPropagation()})},contextmenuB:function(t,a){t.contextmenu("show",{exclude:"input, .bootstrap-select",items:[{icon:"refresh",title:BJUI.getRegional("datagrid.refresh"),func:function(t,a){e.refresh()}},{title:"diver"},{icon:"plus",title:BJUI.getRegional("datagrid.add"),func:function(t,a){e.add()}},{icon:"edit",title:BJUI.getRegional("datagrid.edit"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.doEditRow(n)}},{icon:"undo",title:BJUI.getRegional("datagrid.cancel"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),n.hasClass(e.classnames.tr_edit)||(n=e.$tbody.find("> tr."+e.classnames.tr_edit)),e.doCancelEditRow(n)}},{icon:"remove",title:BJUI.getRegional("datagrid.del"),func:function(t,i){var n=t;a&&(n=e.$tbody.find("> tr:eq("+n.index()+")")),e.delRows(n)}}]})}};return n},a.prototype.init=function(){if(this.$element.isTag("table")&&!this.$element.data("bjui.datagrid.init")){this.$element.data("bjui.datagrid.init",!0);var e=this,a=e.options,i=e.tools,n=(e.$element.parent(),BJUI.StrBuilder());if(a.height=a.height||"auto",e.isDom=!1,e.columnModel=[],e.inputs=[],e.regional=BJUI.regional.datagrid,n.add('<div class="bjui-datagrid">').add(a.gridTitle?'<div class="datagrid-title">'+a.gridTitle+"</div>":"").add(a.showToolbar?'<div class="datagrid-toolbar"></div>':"").add('<div class="datagrid-box-h"><div class="datagrid-wrap-h"><table class="table table-bordered"><colgroup></colgroup></table></div></div>').add('<div class="datagrid-box-b"><div class="datagrid-wrap-b"></div></div>').add('<div class="datagrid-box-m"></div>').add(a.paging?'<div class="datagrid-paging-box"></div>':"").add("</div>"),e.$grid=t(n.toString()).insertAfter(e.$element).css("height",a.height),e.$boxH=e.$grid.find("> div.datagrid-box-h"),e.$boxB=e.$boxH.next(),e.$boxM=e.$boxB.next().css("height",a.height),e.$boxP=a.paging?e.$boxM.next():null,e.$boxT=a.gridTitle?e.$grid.find("> div.datagrid-title"):null,e.$toolbar=a.showToolbar?e.$boxH.prev():null,e.$tableH=e.$boxH.find("> div > table"),e.$tableB=e.$element,e.$grid.data("bjui.datagrid.table",e.$element.clone()),e.$boxB.find("> div").append(e.$element),e.initTop(),"string"==typeof a.paging&&(a.paging=a.paging.toObj()),e.paging=t.extend({},{pageSize:30,selectPageSize:"30,60,90",pageCurrent:1,total:0,showPagenum:5},"object"===_typeof(a.paging)&&a.paging),e.attach={gridNumber:0,gridCheckbox:"#checkbox#",gridEdit:"#edit#"},e.$thead=e.$element.find("> thead"),e.$tbody=e.$element.find("> tbody"),e.$tbody&&e.$tbody.find("> tr").length)e.isDom=!0,e.setColumnModel(),e.$tbody.find("> tr > td").each(function(){var e=t(this),a=e.html();e.html("<div>"+a+"</div>")}),e.paging.total?e.paging.pageCount=i.getPageCount(e.paging.pageSize,e.paging.total):(e.paging.total=e.$tbody.find("> tr").length,e.paging.pageCount=1),e.paging.pageCurrent=1,e.initThead();else{if(e.$tbody=null,e.$element.find("> tbody").remove(),a.columns)"string"==typeof a.columns&&(a.columns.trim().startsWith("[")?a.columns=a.columns.toObj():a.columns=a.columns.toFunc()),"function"==typeof a.columns&&(a.columns=a.columns.call()),e.$thead=null,e.$element.find("> thead").remove(),e.createThead();else{if(!(e.$thead&&e.$thead.length&&e.$thead.find("> tr").length))return BJUI.debug("Datagrid Plugin: No set options 'columns' !"),void e.destroy();e.setColumnModel()}a.data||a.dataUrl?e.createTbody():(BJUI.debug("Datagrid Plugin: No options 'data' or 'dataUrl'!"),e.destroy())}}},a.prototype.setColumnModel=function(){var e=this,a=e.options,i=e.$thead.find("> tr"),n=[],o=[],l=i.length;if(!e.isDom){e.tools.appendColumns();var s,r=l>1?' rowspan="'+l+'"':"";a.showCheckboxcol&&(e.columnModel.push(e.checkboxColumn),"lock"===a.showCheckboxcol&&(e.checkboxColumn.initLock=!0),s=t('<th class="'+e.classnames.td_checkbox+'"'+r+'><input type="checkbox" data-toggle="icheck"></th>'),s.prependTo(i.first()),r&&s.data("datagrid.column",e.checkboxColumn)),a.showLinenumber&&(e.columnModel.unshift(e.linenumberColumn),"lock"===a.showLinenumber&&(e.linenumberColumn.initLock=!0),s=t('<th class="'+e.classnames.td_linenumber+'"'+r+">No.</th>"),s.prependTo(i.first()),r&&s.data("datagrid.column",e.linenumberColumn)),(a.showChildcol||void 0===a.showChildcol&&a.hasChild&&a.childOptions)&&(e.columnModel.unshift(e.childColumn),s=t('<th class="'+e.classnames.td_child+'"'+r+">...</th>"),s.prependTo(i.first()),r&&s.data("datagrid.column",e.childColumn)),a.showEditbtnscol&&(s=t("<th"+r+">"+e.editBtnsColumn.label+"</th>"),s.appendTo(i.first()),r&&s.data("datagrid.column",e.editBtnsColumn),e.columnModel[s.index()]=e.editBtnsColumn)}i.length&&1==l?i.find("> th").each(function(i){var n=t(this).addClass("single-row").data("index",i),o=n.data("options"),l=n.attr("width")||"auto",s=n.html();e.columnModel.length&&e.columnModel[i]?(o=e.columnModel[i],o.index=i):(o&&"string"==typeof o&&(o=o.toObj()),"object"!==(void 0===o?"undefined":_typeof(o))&&(o={}),o.index=i,o.label=s,o.width=void 0===o.width?l:o.width,o=e.tools.setOp(o),e.columnModel[i]=o),e.columnModel[i].th=n,n.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+s+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),o.menu&&a.columnMenu&&n.addClass(e.classnames.th_menu),a.fieldSortable&&o.quicksort&&n.addClass("datagrid-quicksort-th"),o.align&&n.attr("align",o.align)}):i.each(function(i){var l=[],s=[],r=-1,d=0;n.length&&(l=n.concat(),s=o.concat()),n=[],o=[],t(this).find("> th").each(function(i){var c=t(this),u=c.data("options")||c.data("datagrid.column")||{},h=parseInt(c.attr("colspan")||0,10),f=parseInt(c.attr("rowspan")||0,10),p=c.attr("width")||"auto",g=c.html();if(u&&"string"==typeof u&&(u=u.toObj()),"object"!==(void 0===u?"undefined":_typeof(u))&&(u={}),BJUI.isIE(8)&&1===h&&(h=0),u.label=g,u.th=c,u.gridCheckbox&&(u.label="Checkbox"),r++,h){u.colspan=h;for(var m=l.length?l[r]:r,b=m;b<m+h;b++)n[d++]=b,o[d-1]=u;r+=h-1,c.data("index",r),l.length&&(u.parent=s[r])}f&&1!=f||c.addClass("single-row"),h?c.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+g+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'):(u.width=void 0===u.width?p:u.width,u=e.tools.setOp(u),c.html('<div><div class="datagrid-space"></div><div class="datagrid-label">'+g+'</div><div class="'+e.classnames.th_cell+'"><div class="'+e.classnames.th_resizemark+'"></div></div></div>'),u.menu&&a.columnMenu&&c.addClass(e.classnames.th_menu),a.fieldSortable&&u.quicksort&&c.addClass("datagrid-quicksort-th"),u.align&&c.attr("align",u.align),l.length?(u.index=l[r],u.parent=s[r],e.columnModel[l[r]]=u):(u.index=r,e.columnModel[r]=u),c.data("index",u.index))})})},a.prototype.createThead=function(){var e,a,i,n,o,l,s,r=this,d=r.options,c=d.columns,u=[];r.tools.appendColumns(),d.showCheckboxcol&&(c.unshift(r.checkboxColumn),"lock"===d.showCheckboxcol&&(r.checkboxColumn.initLock=!0)),d.showLinenumber&&(c.unshift(r.linenumberColumn),"lock"===d.showLinenumber&&(r.linenumberColumn.initLock=!0)),(d.showChildcol||void 0===d.showChildcol&&d.hasChild&&d.childOptions)&&c.unshift(r.childColumn),d.showEditbtnscol&&c.push(r.editBtnsColumn),u=function e(a,i,n,o){return i||(i=[]),n||(n=0),i[n]||(i[n]=[]),t.each(a,function(t,a){var l,s=i[n].length;if(o&&(a.parent=o),a.columns)return l=a.columns.length,n&&a.parent&&r.tools.setColspan(a.parent,l),a.index=r.columnModel.length+l-1,a.colspan=l,a.quicksort=!1,i[n][s++]=a,e(a.columns,i,n+1,a);a.rowspan=n,a.index=r.columnModel.length,a=r.tools.setOp(a),i[n][s++]=a,r.columnModel.push(a)}),i}(c,u),r.columnModel[r.columnModel.length-(d.showEditbtnscol?2:1)].lock=!1,d.hiddenFields&&(r.hiddenFields=d.hiddenFields),r.$thead=t("<thead></thead>"),t.each(u,function(c,h){var f,p=t('<tr style="height:25px;"></tr>');t.each(h,function(c,h){e=h.label||h.name,a=h.align?' align="'+h.align+'"':"",i=h.width?' width="'+h.width+'"':"",n=h.colspan?' colspan="'+h.colspan+'"':"",o=u.length-h.rowspan>1?' rowspan="'+(u.length-h.rowspan)+'"':"",l='<div class="'+r.classnames.th_resizemark+'"></div>',s="",h.gridCheckbox&&(e='<input type="checkbox" data-toggle="icheck">'),h.colspan&&(a=' align="center"'),h.thalign&&(a=' align="'+h.thalign+'"'),h.menu&&d.columnMenu&&(s=' class="'+r.classnames.th_menu+'"'),f=t("<th"+s+i+a+n+o+'><div><div class="datagrid-space"></div><div class="datagrid-label">'+e+'</div><div class="'+r.classnames.th_cell+'">'+l+"</div></div></th>"),f.data("index",h.index).appendTo(p),o||f.addClass("single-row"),h.gridChild&&f.addClass(r.classnames.td_child),h.gridNumber&&f.addClass(r.classnames.td_linenumber),h.gridCheckbox&&f.addClass(r.classnames.td_checkbox),d.fieldSortable&&h.quicksort&&f.addClass("datagrid-quicksort-th"),h.th=f}),p.appendTo(r.$thead)}),r.$thead.appendTo(r.$element).initui()},a.prototype.createTbody=function(){var t=this,e=t.options,a=e.data;t.columnModel;a?("string"==typeof a&&(a=a.trim().startsWith("[")||a.trim().startsWith("{")?a.toObj():a.toFunc()),"function"==typeof a&&(a=a.call()),e.data=a,t.tools.createTrsByData(a)):e.dataUrl&&t.tools.loadData()},a.prototype.refresh=function(){var e=this,a=e.options,i=e.tools,n=(e.isDom,BJUI.pageInfo),o=e.paging,l={};if(!a.dataUrl)return a.data&&a.data.length?void i.initTbody(e.allData,!0):void BJUI.debug("Datagrid Plugin: Not Set the dataUrl option!");a.postData&&a.postData[n.pageSize]||(l[n.pageSize]=o.pageSize,l[n.pageCurrent]=o.pageCurrent),i.loadData(l,!0),e.filterDatas=null,t.each(e.columnModel,function(t,e){e.th.trigger("bjui.datagrid.th.filter",[!1]),e.isFiltered=!1,e.$quickfilter&&e.$quickfilter.trigger("bjui.datagrid.thead.clearfilter")}),e.$thead.find("> tr > th.datagrid-quicksort-th").find("> div > .datagrid-label > i").remove()},a.prototype.refreshParent=function(){var t=this,e=t.$element.data("bjui.datagrid.parent");e&&e.length&&e.closest("table").datagrid("refresh")},a.prototype.refreshChild=function(e){var a,i=this,n=i.$tbody.find("> tr"),o=function(t){(a=t.data("bjui.datagrid.child"))&&a.length&&a.isTag("table")&&a.datagrid("refresh")};e instanceof jQuery?e.each(function(){o(t(this))}):isNaN(e)?t.each(e.split(","),function(t,e){2*e<n.length&&o(n.eq(2*e))}):2*e<n.length&&o(n.eq(2*e))},a.prototype.showChild=function(e,a,i){void 0===a&&(a=!0);var n,o,l,s,r,d,c,u=this,h=u.options,f=u.$tbody.find("> tr:not(."+u.classnames.tr_child+")"),p=function(){h.fullGrid||u.fixedWidth(),u.fixedHeight()},g=function(t,e,a){if(u.$lockTableB){var i=u.$lockTableB.find("> tbody > tr:eq("+t+")");i.toggle(e),a?i.height(a):i.height()||i.height(n.height())}},m=function(e,a,n){o.find("> div").html(BJUI.doRegional(FRAG.gridShrinkBtn,u.regional)),a.fadeIn("normal",function(){n.data("bjui.datagrid.init")?(p(),g(s,!0),i&&i.apply(u,[n])):(d=t.extend(!0,{},u.childOptions),c=d.dataUrl,r=u.isDom?e.data("initData")||u.tools.setDomData(e):u.data[u.tools.getNoChildDataIndex(e.index())],c&&!c.isFinishedTm()&&(c=u.tools.replacePlh(c,r),c.isFinishedTm()?d.dataUrl=c:BJUI.debug("Datagrid Plugin: The datagrid options 'childOptions' in the 'dataUrl' options is incorrect: "+c)),n.datagrid(d).data("bjui.datagrid.parent",e).on("completed.bjui.datagrid",t.proxy(function(){p(),g(s,!0,a.outerHeight()),i&&i.apply(u,[n])},u)).on("bjui.datagrid.child.resize",function(){n.datagrid("fixedWidth").datagrid("fixedHeight")}),e.data("bjui.datagrid.child",n))})},b=function(t,e,a){e.fadeOut("normal",function(){o.find("> div").html(BJUI.doRegional(FRAG.gridExpandBtn,u.regional)),p(),g(s,!1),i&&i.apply(u,[a])})},v=function(t){(n=t.next("."+u.classnames.tr_child))&&n.length&&(o=t.find("> td."+u.classnames.td_child),s=n.index(),(l=n.find("> td").find("table.table-child"))&&l.length&&(n.is(":visible")?a||b(0,n,l):a&&m(t,n,l)))};if(i&&("string"==typeof i&&(i=i.toFunc()),"function"!=typeof i&&(i=!1)),e instanceof jQuery)e.each(function(){v(t(this))});else if(isNaN(e))t.each(e.split(","),function(t,e){var a=f.eq(parseInt(e.trim(),10));a&&a.length&&v(a)});else if(!isNaN(e)){var y=f.eq(e);y&&y.length&&v(y)}},a.prototype.updateRow=function(e,a){var i,n,o,l,s=this,r=s.options,d=function(a,i){if(t.extend(n,"object"===(void 0===i?"undefined":_typeof(i))&&i),s.dialogEditComplete(a,n),n["refresh.datagrid.child"]){var o=a.data("bjui.datagrid.child");o&&o.length?o.datagrid("refresh"):s.showChild(e)}"auto"===r.height&&(s.$boxB.scrollTop(5),s.$boxB.scrollTop&&s.fixedHeight())};if(e instanceof jQuery)l=e;else{if(isNaN(e))return void BJUI.debug("Datagrid Plugin: Func 'updateRow', Parameter 'row' is incorrect!");l=s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").eq(parseInt(e,10))}if(s.isDom?n=l.data("initData")||s.tools.setDomData(l):(i=s.tools.getNoChildDataIndex(l.index()),n=s.data[i]),a){if("string"==typeof a&&(a=a.trim().startsWith("{")?a.toObj():a.toFunc()),
"function"==typeof a&&(a=a.apply()),"object"!==(void 0===a?"undefined":_typeof(a))&&!r.updateRowUrl)return void BJUI.debug("Datagrid Plugin: Func 'updateRow', Parameter 'updateData' is incorrect!");d(l,a)}else r.updateRowUrl?(o=s.tools.replacePlh(r.updateRowUrl,n),o.isFinishedTm()?BJUI.ajax("doajax",{url:o,type:r.loadType,okCallback:function(t){d(l,t)}}):BJUI.debug("Datagrid Plugin: The datagrid options 'updateRowUrl' is incorrect!")):BJUI.debug("Datagrid Plugin: The datagrid options 'updateRowUrl' is not set!")},a.prototype.doAjaxRow=function(t,e){var a,i,n,o,l=this;l.options;if(t instanceof jQuery)a=t;else{if(isNaN(t))return void BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', Parameter 'row' is incorrect!");a=l.$tbody.find("> tr:not(."+l.classnames.tr_child+")").eq(parseInt(t,10))}"object"===(void 0===e?"undefined":_typeof(e))&&e.url?(void 0===e.reload&&(e.reload=!1),e.callback||e.okCallback||(e.okCallback=function(t,e){l.updateRow(a,"object"===(void 0===t?"undefined":_typeof(t))&&!t[BJUI.keys.statusCode]&&t)}),l.isDom?i=a.data("initData")||l.tools.setDomData(a):(n=l.tools.getNoChildDataIndex(a.index()),i=l.data[n]),o=e.url,o=!i||i.addFlag?o.replace(/{\/?[^}]*}/g,""):l.tools.replacePlh(o,i),o.isFinishedTm()||BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', options 'url' is incorrect: "+o),e.url=o,BJUI.ajax("doajax",e)):BJUI.debug("Datagrid Plugin: Func 'doAjaxRow', options is incorrect or the property 'url' is not set!")},a.prototype.reload=function(e){var a=this.options;e&&"object"===(void 0===e?"undefined":_typeof(e))&&(e.clearOldPostData&&delete a.postData,t.extend(!0,a,e)),!a.dataUrl&&a.data&&(this.allData=a.data),this.refresh()},a.prototype.destroy=function(){var t=this,e=t.$grid.data("bjui.datagrid.table");e&&(t.$element.html(e.html()).insertBefore(t.$grid),t.$grid.remove())},a.prototype.initTop=function(){var e,a=this,i=a.options,n=(a.regional,!1),o='<button type="button" class="btn" data-icon=""></button>';if(i.showToolbar&&(i.toolbarItem||i.toolbarCustom)){if(i.toolbarItem){var l=i.toolbarItem.toFunc();"function"==typeof l&&(i.toolbarItem=l.apply()),n=!0,i.toolbarItem.indexOf("all")>=0&&(i.toolbarItem="add, edit, cancel, save, |, del, |, refresh, |, import, export"),t.each(i.toolbarItem.split(","),function(n,l){if(l=l.trim().toLocaleLowerCase(),(!e||"|"===l)&&(e=t('<div class="btn-group" role="group"></div>').appendTo(a.$toolbar),"|"===l))return!0;"add"===l?a.$toolbar_add=t(o).attr("data-icon","plus").addClass("btn-blue").text(BJUI.getRegional("datagrid.add")).appendTo(e).on("click",function(t){a.add()}):"edit"===l?a.$toolbar_edit=t(o).attr("data-icon","edit").addClass("btn-green").text(BJUI.getRegional("datagrid.edit")).appendTo(e).on("click",function(e){var n=a.$tbody.find("> tr."+a.classnames.tr_selected);if(!i.editMode)return!1;n.length?i.inlineEditMult?a.doEditRow(n):a.$lastSelect?a.doEditRow(a.$lastSelect):a.doEditRow(n.first()):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"cancel"===l?a.$toolbar_calcel=t(o).attr("data-icon","undo").addClass("btn-orange").text(BJUI.getRegional("datagrid.cancel")).appendTo(e).on("click",function(t){a.doCancelEditRow(a.$tbody.find("> tr."+a.classnames.tr_edit))}):"save"===l?a.$toolbar_save=t(o).attr("data-icon","save").addClass("btn-default").text(BJUI.getRegional("datagrid.save")).appendTo(e).on("click",function(t){a.doSaveEditRow()}):"del"===l?a.$toolbar_del=t(o).attr("data-icon","times").addClass("btn-red").text(BJUI.getRegional("datagrid.del")).appendTo(e).on("click",function(e){var i=a.$tbody.find("> tr."+a.classnames.tr_selected);i.length?a.delRows(i):t(this).alertmsg("info",BJUI.getRegional("datagrid.selectMsg"))}):"refresh"===l?a.$toolbar_refresh=t(o).attr("data-icon","refresh").addClass("btn-green").text(BJUI.getRegional("datagrid.refresh")).appendTo(e).on("click",function(t){a.refresh()}):"import"===l?a.$toolbar_add=t(o).attr("data-icon","sign-in").addClass("btn-blue").text(BJUI.getRegional("datagrid.import")).appendTo(e).on("click",function(t){if(i.importOption){var e=i.importOption;"string"==typeof e&&(e=e.toObj()),e.options&&e.options.url&&("dialog"===e.type?a.$grid.dialog(e.options):"navtab"===e.type?a.$grid.navtab(e.options):a.$grid.bjuiajax("doajax",e.options))}}):"export"===l&&(a.$toolbar_add=t(o).attr("data-icon","sign-out").addClass("btn-green").text(BJUI.getRegional("datagrid.export")).appendTo(e).on("click",function(t){if(i.exportOption){var e=i.exportOption;"string"==typeof e&&(e=e.toObj()),e.options&&e.options.url&&("dialog"===e.type?BJUI.dialog(e.options):"navtab"===e.type?BJUI.navtab(e.options):"file"===e.type?(e.options.target=a.$boxB,BJUI.ajax("ajaxdownload",e.options)):BJUI.ajax("doajax",e.options))}}))})}if(i.toolbarCustom){var s,r=t('<div style="display:inline-block;"></div>');if("string"==typeof i.toolbarCustom){var d=t(i.toolbarCustom);d&&d.length?s=d:(d=d.toFunc())&&"string"==typeof(s=d.call(a))&&(s=t(s))}else"function"==typeof i.toolbarCustom?"string"==typeof(s=i.toolbarCustom.call(a))&&(s=t(s)):s=i.toolbarCustom;s&&s.length&&"string"!=typeof s&&(n&&r.css("margin-left","5px"),r.appendTo(a.$toolbar),s.appendTo(r))}a.$toolbar.initui()}},a.prototype.initThead=function(){var e,a,i,n,o=this,l=o.options,s=o.tools,r=o.columnModel,d=[],c=t('<div class="bjui-datagrid"></div>');o.$tableH.append(o.$thead),o.init_thead=!0,o.$trsH=o.$thead.find("> tr"),o.table_width=0,o.$colgroupH=o.$tableH.find("> colgroup"),o.fixtedColumnWidthCount=0,t.each(o.columnModel,function(l,s){var r="";s!==o.linenumberColumn&&s!==o.checkboxColumn&&s!==o.childColumn&&s!==o.editBtnsColumn||(r=' class="datagrid_col_lockwidth"'),e=s.width,e&&"auto"!==e||(a||(a=o.$element.clone().addClass("table table-bordered").appendTo(c),a.prepend(o.$thead.clone()),c.appendTo(t("body")),a.attr("style","width:auto !important;").initui()),o.fixtedColumnWidthCount++,s.fixedWidth=!0,i=a.find("> tbody > tr:first-child"),i.hasClass("datagrid-nodata")?(n=o.$trsH.length>1?o.$trsH.length-parseInt(s.th.attr("rowspan")||1,10):0,e=a.find("> thead > tr:eq("+n+") > th:eq("+s.th.index()+")").outerWidth()+5):e=a.find("> tbody > tr:first-child > td:eq("+l+")").outerWidth()+5),d.push('<col style="width:'+e+'px;"'+r+">"),s.width=e,o.table_width+=e}),c&&c.remove(),o.$colgroupH.html(d.join("")),setTimeout(function(){o.$thead.find("> tr:not(.datagrid-filter)").each(function(){t(this).find("> th").each(function(){var e=t(this),a=e.outerHeight();e.find("> div").height(a)})})},10);var u=o.$trsH.find("> th");u.filter(".datagrid-quicksort-th").on("click.bjui.datagrid.quicksort",function(e){t(e.target).closest("."+o.classnames.th_cell).length||o.isResize||s.quickSort(r[t(this).data("index")])}),u.filter(".datagrid-column-menu").on("bjui.datagrid.th.filter",function(e,a){var i=t(this),n=i.find("> div > ."+o.classnames.th_cell+"> ."+o.classnames.btn_menu+"> .btn");a?(i.addClass("filter-active"),n.find("> i").attr("class","fa fa-filter")):(i.removeClass("filter-active"),n.find("> i").attr("class","fa fa-bars"))}),l.contextMenuH&&s.contextmenuH(),o.initTbody(),l.columnResize&&o.colResize(),l.columnMenu&&o.colMenu(),l.paging&&o.initPaging(),l.editMode&&o.edit(),o.$element.hasClass("table-child")||o.resizeGrid();var h=function(){if(l.showTfoot&&o.initTfoot(),s.setBoxbH(),o.renderTds&&o.renderTds.length)for(var t=o.$tbody.find("> tr:not(."+o.classnames.tr_child+", .datagrid-nodata)"),e=o.renderTds&&o.renderTds.length,a=0;a<e;a++){var i=o.renderTds[a],n=i.render.call(o,i.label,i.trData,o.columnModel[i.tdindex].items);t.eq(i.trindex).find("> td:eq("+i.tdindex+")").html("<div>"+n+"</div>")}o.initEvents(),o.$tableB.initui(),o.$lockTableB&&o.$lockTableB.initui(),setTimeout(function(){o.fixedWidth("init"),o.initLock(),o.$element.trigger("completed.bjui.datagrid",{datas:o.data}),o.$boxM&&o.$boxM.trigger("bjui.ajaxStop").hide()},50),o.delayFilterTimeout&&clearInterval(o.delayFilterTimeout)};l.filterThead?o.delayRender?o.delayFilterTimeout=setInterval(function(){o.delayRender||(o.filterInThead(),h())},100):(o.filterInThead(),h()):h()},a.prototype.fixedWidth=function(e){var a,i=this,n=i.options,o=i.columnModel;o.length;if(!e||!i.initFixedW){i.initFixedW=!0;!function(){if(String(i.options.width).endsWith("%")&&i.$grid.css("width",""),i.$boxH.find("> div").css("width",""),i.$boxB.find("> div").css("width",""),i.$boxF&&i.$boxF.find("> div").css("width",""),i.$boxP&&i.$boxP.find("> div.paging-content").css("width",""),a=i.$boxB.find("> div").width(),i.options.hasChild&&(i.$boxB.scrollTop(5),i.$boxB.scrollTop()&&(a-=18)),a&&(i.$boxB.find("> div").width(a),i.$boxH.find("> div").width(a),i.$boxF&&i.$boxF.find("> div").width(a),i.table_width>a||n.fullGrid?i.$boxP&&i.$boxP.find("> div.paging-content").width(a):i.$boxP&&i.$boxP.find("> div.paging-content").width(i.table_width)),n.fullGrid){var e,o,l=i.$tbody.find("> tr:first"),s=i.$colgroupB.find("> col");s.filter(":not(.datagrid_col_lockwidth)").css("width",""),t.each(i.columnModel,function(t,a){if(a===i.linenumberColumn||a===i.checkboxColumn||a===i.childColumn||a===i.editBtnsColumn)return!0;l.hasClass("datagrid-nodata")?(o=i.$trsH.length>1?i.$trsH.length-parseInt(a.th.attr("rowspan")||1,10):0,e=i.$trsH.eq(o).find("> th:eq("+a.th.index()+")").width()):e=l.find("> td:eq("+t+")").width(),s.eq(t).css("width",e)}),i.$colgroupH.html(i.$colgroupB.html())}}()}},a.prototype.fixedHeight=function(t){var e=this;"auto"===e.options.height?(e.boxH="auto",e.$grid.css("height",""),e.$boxB.css("height",""),e.tools.setBoxbH()):e.tools.setBoxbH(t),e.$boxB.scrollLeft(5),e.$boxB.scrollLeft()&&e.fixedWidth()},a.prototype.initTbody=function(){var t=this,e=t.options,a=(t.tools,t.$tbody.find("> tr")),i=(a.find("> td"),"0");t.init_tbody=!0,t.$colgroupB=t.$colgroupH.clone(),t.$tableB.prepend(t.$colgroupB),e.fullGrid&&(i="100%"),t.$tableH.css("width",i),t.$tableB.css("width",i),t.$tableB.removeAttr("data-toggle width").addClass("table table-bordered").removeClass("table-hover"),t.$boxB.scroll(function(){t.$boxH.find("> div").prop("scrollLeft",this.scrollLeft),t.$boxF&&t.$boxF.find("> div").prop("scrollLeft",this.scrollLeft),t.$lockB&&t.$lockB.prop("scrollTop",this.scrollTop)}),t.isDom&&(e.showLinenumber&&t.showLinenumber(e.showLinenumber),e.showCheckboxcol&&t.showCheckboxcol(e.showCheckboxcol),e.showEditbtnscol&&t.showEditCol(e.showEditbtnscol),t.$grid.data(t.datanames.tbody,t.$tbody.clone()))},a.prototype.initEvents=function(e){var a=this,i=a.options,n=a.$tbody.find("> tr");e||(e=n),e.on("click.bjui.datagrid.tr",function(e,n){var o,l,s=t(this),r=s.index(),d=a.$tbody.find("> tr."+a.classnames.tr_selected),c=a.$lastSelect;a.$lockTbody&&a.$lockTbody.find("> tr");if(n)l=n.is(":checked"),l||(a.$lastSelect=s),a.selectedRows(s,!l);else{if(s.hasClass(a.classnames.tr_edit))return;i.selectMult?a.selectedRows(s):BJUI.KeyPressed.ctrl||BJUI.KeyPressed.shift?(window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),BJUI.KeyPressed.ctrl?(s.hasClass(a.classnames.tr_selected)||(a.$lastSelect=s),a.selectedRows(s)):BJUI.KeyPressed.shift&&(c||(c=a.$lastSelect=s),c.length&&(a.selectedRows(null),c.index()!=r?c.index()>r?a.selectedRows(s.nextUntil(c).add(s).add(c),!0):a.selectedRows(s.prevUntil(c).add(s).add(c),!0):a.selectedRows(r)))):d.length>1&&s.hasClass(a.classnames.tr_selected)?(a.selectedRows(d.not(s)),a.$lastSelect=s):(d.length&&d[0]!=this&&a.selectedRows(null),s.hasClass(a.classnames.tr_selected)||(a.$lastSelect=s),a.selectedRows(s))}o=a.isDom?a.tools.setDomData(s):a.data[a.tools.getNoChildDataIndex(r)],a.$element.trigger("clicked.bjui.datagrid.tr",{data:o})}).on("mouseenter.bjui.datagrid",function(e){var i=t(this),n=i.index();i.addClass("datagrid-hover"),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(e){var i=t(this),n=i.index();i.removeClass("datagrid-hover"),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")}).on("bjui.datagrid.tr.delete",function(e){e.stopPropagation();var i,n=t(this),o=n.index(),l=o,s=a.data,r=a.allData,d=a.$lockTbody&&a.$lockTbody.find("> tr");if(n.hasClass("datagrid-nodata"))return!1;a.options.hasChild&&a.options.childOptions&&(l/=2,n.next().remove(),d&&d.eq(o).next().remove()),a.isDom||(i=s[l].gridIndex,a.data=s.remove(l),a.allData=r.remove(i)),-1!=t.inArray(a.linenumberColumn,a.columnModel)&&(n.nextAll(":not(."+a.classnames.tr_child+")").each(function(){var e=t(this).find("> td."+a.classnames.td_linenumber),i=parseInt(e.text(),10);e.text(i-1)}),d&&d.eq(o).trigger("bjui.datagrid.tr.delete",[o])),n.remove(),d&&d.eq(o).remove(),a.tools.createNoDataTr()}),a.$grid.off("click.bjui.datagrid.tr.child").on("click.bjui.datagrid.tr.child","td."+a.classnames.td_child,function(e){e.stopPropagation();var i=t(this),n=i.closest("tr"),o=n.next("."+a.classnames.tr_child);o&&o.length&&a.showChild(n,!o.is(":visible"))}).off("ifClicked").on("ifClicked","td."+a.classnames.td_checkbox+" input",function(e){e.stopPropagation();var i=t(this),n=i.closest("tr"),o=n.index();a.$tbody.find("> tr:eq("+o+")").trigger("click.bjui.datagrid.tr",[i])}).off("ifChanged").on("ifChanged","th."+a.classnames.td_checkbox+" input",function(e){e.stopPropagation();var i=t(this).is(":checked"),n=a.$tbody.find('> tr:not(".'+a.classnames.tr_child+'")');a.selectedRows(n,i)}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this))}),a.$tableB.off("click.bjui.datagrid.refresh").on("click.bjui.datagrid.refresh",'tbody > tr > td [data-toggle="update.datagrid.tr"]',function(e){e.stopPropagation(),a.updateRow(t(this).closest("tr"))}).off("click.bjui.datagrid.edit").on("click.bjui.datagrid.edit",'tbody > tr > td [data-toggle="edit.datagrid.tr"]',function(e){e.stopPropagation();var i=t(this),n=i.data("options"),o=i.closest("tr");n&&"string"==typeof n&&(n=n.toObj()),"object"===(void 0===n?"undefined":_typeof(n))?a.externalEdit(o,n):a.doEditRow(o)}).off("click.bjui.datagrid.ajax").on("click.bjui.datagrid.ajax",'tbody > tr > td [data-toggle="ajax.datagrid.tr"]',function(e){e.stopPropagation();var i=t(this),n=i.data();n.options&&"string"==typeof n.options&&(n.options=n.options.toObj()),t.extend(n,"object"===_typeof(n.options)&&n.options),a.doAjaxRow(i.closest("tr"),n)}).off("click.bjui.datagrid.addchild").on("click.bjui.datagrid.addchild",'tbody > tr > td [data-toggle="addchild.datagrid.tr"]',function(e){e.stopPropagation();var i,n,o=t(this),l=o.closest("tr"),s=l.data("bjui.datagrid.child"),r=l.next("."+a.classnames.tr_child),d=o.data("addData"),c=function(t){return t.replace(/#\/?[^#]*#/g,function(t){var e=t.replace(/[##]+/g,""),a=i[e];return void 0!==a&&"null"!==a&&null!==a||(a=""),a})},u=function(t){d&&("string"==typeof d?(d=c(d),d=d.trim().startsWith("{")?d.toObj():d.toFunc()):("function"==typeof d&&(d=d.toFunc()),"object"===(void 0===d?"undefined":_typeof(d))&&(d=JSON.stringify(d)),d=c(d).toObj()),"object"===(void 0===d?"undefined":_typeof(d))&&(n=d)),t.datagrid("add",!1,n)};r&&r.length&&(i=a.isDom?l.data("initData")||tools.setDomData(l):a.data[a.tools.getNoChildDataIndex(l.index())],s&&s.length?u(s):a.showChild(l,!0,u))}).off("click.bjui.datagrid.del").on("click.bjui.datagrid.del",'tbody > tr > td [data-toggle="del.datagrid.tr"]',function(e){e.stopPropagation(),a.delRows(t(this).closest("tr"))})},a.prototype.initTfoot=function(){var e=this,a=e.options,i=e.tools,n=e.columnModel,o=t("<tr></tr>");e.$boxF=t('<div class="datagrid-box-f"></div>'),e.$colgroupF=e.$colgroupH.clone(),e.$tableF=e.$tableH.clone().empty(),e.$tableF.append(e.$colgroupF),e.$boxF.append(t('<div class="datagrid-wrap-h"></div>').append(e.$tableF)),e.$boxF.insertAfter(e.$boxB),e.$tfoot=t("<thead></thead>"),t.each(n,function(e,a){var i=t("<th><div></div></th>");if(a.calc){var n='<div><div class="datagrid-calcbox">#tit#</div>#number#</div>';"avg"===a.calc?i.html(n.replace("#tit#",a.calcTit||"AVG").replace("#number#",(a.calc_sum/a.calc_count).toFixed(a.calcDecimal||2))):"count"===a.calc?i.html(n.replace("#tit#",a.calcTit||"COUNT").replace("#number#",a.calc_count)):"sum"===a.calc?i.html(n.replace("#tit#",a.calcTit||"SUM").replace("#number#",a.calc_sum)):"max"===a.calc?i.html(n.replace("#tit#",a.calcTit||"MAX").replace("#number#",a.calc_max)):"min"===a.calc&&i.html(n.replace("#tit#",a.calcTit||"MIN").replace("#number#",a.calc_min))}a.hidden&&i.css("display","none"),i.appendTo(o)}),e.$tfoot.append(o).appendTo(e.$tableF),e.$tfoot.on("bjui.datagrid.tfoot.resizeH",function(){i.setBoxbH(a.height)})},a.prototype.selectedRows=function(e,a){var i=this,n=i.$lockTbody&&i.$lockTbody.find("> tr"),o=i.$tbody.find("> tr"),l=function(t){void 0===a&&(a=!0),o.eq(t).hasClass(i.classnames.tr_child)||(o.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"),n&&n.eq(t).toggleClass(i.classnames.tr_selected,a).find("> td."+i.classnames.td_checkbox+" input").iCheck(a?"check":"uncheck"))};null===e?(o.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck"),n&&n.removeClass(i.classnames.tr_selected).find("> td."+i.classnames.td_checkbox+" input").iCheck("uncheck")):"object"===(void 0===e?"undefined":_typeof(e))?e.each(function(){var e=t(this),o=e.index();if(e.hasClass(i.classnames.tr_child))return!0;void 0!==a?l(o):(e.toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck"),n&&n.eq(o).toggleClass(i.classnames.tr_selected).trigger("bjui.datagrid.tr.selected").find("> td."+i.classnames.td_checkbox+" input").iCheck(e.hasClass(i.classnames.tr_selected)?"check":"uncheck"))}):isNaN(e)?t.each(e.split(","),function(t,e){l(parseInt(e.trim(),10))}):isNaN(e)||l(parseInt(e,10)),i.$lastSelect&&!i.$lastSelect.hasClass(i.classnames.tr_selected)&&(i.$lastSelect=null);var s=i.$tbody.find("> tr."+i.classnames.tr_selected),r=[];s.each(function(){var e,a=t(this),n=a.index();n=i.tools.getNoChildDataIndex(n),e=i.isDom?a.data("initData")||i.tools.setDomData(a):i.data[n],r.push(e)}),i.$element.data("selectedTrs",s).data("selectedDatas",r)},a.prototype.initLock=function(){var e=this;e.columnModel;e.col_lock_count=0,t.each(e.columnModel,function(t,a){a.initLock&&e.col_lock_count++}),e.col_lock_count&&e.doLock()},a.prototype.colLock=function(e,a){var i,n,o,l=this;if("number"===t.type(e)){if((n=parseInt(e,10))<0||n>l.columnModel.length-1)return;o=l.columnModel[n],i=o.th}else i=e,n=i.data("index"),o=l.columnModel[n];o!==l.editBtnsColumn&&o.index!==l.columnModel.length-1&&(void 0===o.locked&&(o.locked=!1),o.locked!==a&&(o.initLock=a,a?l.col_lock_count++:l.col_lock_count--,l.col_lock_count<0&&(l.col_lock_count=0),l.doLock()))},a.prototype.fixedLockItem=function(e){var a=this,i=a.columnModel,n=a.$thead.find("> tr.datagrid-filter > th"),o=a.$lockTbody&&a.$lockTbody.find("> tr");if(e){var l=function(t,e){t.clone().html("").insertAfter(t),t.show().insertAfter(e),e.remove()};if(n&&n.length&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);l(i,e)}),a.$lockThead&&-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked){var s=a.$lockThead.find("> tr:first > th."+a.classnames.td_checkbox),r=a.checkboxColumn.index,d=a.$thead.find("> tr:first > th:eq("+r+")");l(d,s)}o&&o.length&&o.each(function(){var e,n,o=t(this),l=o.index(),s=function(t,i,o){e=a.$tbody.find("> tr:eq("+i+")"),n=e.find("> td:eq("+o+")"),n.clone().insertAfter(n),n.show().insertAfter(t),t.remove()};o.hasClass(a.classnames.tr_edit)&&o.find("> td."+a.classnames.td_edit+":visible").each(function(){var e=t(this),a=e.index();i[a].locked&&s(e,l,a)}),-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked&&o.find("> td."+a.classnames.td_checkbox).each(function(){var e=t(this),i=a.checkboxColumn.index;s(e,l,i)})})}else{var l=function(t,e){e.clone().insertAfter(e),e.hide().insertAfter(t),t.remove()};if(n&&n.length&&a.$lockThead&&a.$lockThead.find("> tr.datagrid-filter > th:visible").each(function(){var e=t(this),a=e.index(),i=n.eq(a);l(i,e)}),a.$lockThead&&-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked){var s=a.$lockThead.find("> tr:first > th."+a.classnames.td_checkbox),r=a.checkboxColumn.index,d=a.$thead.find("> tr:first > th:eq("+r+")");l(d,s)}o&&o.length&&o.each(function(){var e,n,o=t(this),l=o.index(),s=function(t,i,o){e=a.$tbody.find("> tr:eq("+i+")"),n=e.find("> td:eq("+o+")"),t.clone().insertAfter(t),t.hide().insertAfter(n),n.remove()};if(o.hasClass(a.classnames.tr_edit)){var r=o.find("> td:eq("+i.lockIndex+")"),d=r.index();r.hasClass(a.classnames.td_edit)&&s(r,l,d)}-1!=t.inArray(a.checkboxColumn,i)&&a.checkboxColumn.locked&&o.find("> td."+a.classnames.td_checkbox).each(function(){var e=t(this),i=a.checkboxColumn.index;s(e,l,i)})})}},a.prototype.doLock=function(){var e,a,i=this,n=(i.options,i.tools),o=i.columnModel,l=(i.$tableH.width(),0),s=0,r=i.$boxF&&!0,d=0;i.$lockBox&&i.$lockBox.length?(i.fixedLockItem(),i.$lockTableH.empty(),i.$lockTableB.empty(),i.$lockTableF&&i.$lockTableF.empty()):(i.$lockBox=t('<div class="datagrid-box-l"></div>'),i.$lockH=t('<div class="datagrid-box-h"></div>'),i.$lockB=t('<div class="datagrid-box-b"></div>'),i.$lockF=t('<div class="datagrid-box-f"></div>'),i.$lockTableH=t('<table class="table table-bordered"></table>'),i.$lockTableB=t("<table></table>").addClass(i.$tableB.attr("class")),i.$lockTableF=t('<table class="table table-bordered"></table>'),i.$lockH.append(i.$lockTableH),i.$lockB.append(i.$lockTableB),i.$lockF.append(i.$lockTableF),i.$lockBox.append(i.$lockH).append(i.$lockB).prependTo(i.$grid),r&&(i.$lockBox.append(i.$lockF),i.$lockF.css("margin-top",i.$boxB.outerHeight()-i.$boxB[0].clientHeight).height(i.$boxF.outerHeight()))),i.$boxT&&(d+=i.$boxT.outerHeight()),i.$toolbar&&(d+=i.$toolbar.outerHeight()),d&&i.$lockBox.css({top:d}),t.each(o,function(t,e){e.lockShow=!1,e.lockHide=!1,e.initLock?(e.hidden&&n.showhide(e,!0),e.lockHide=!0,e.locked=!0,e.lockIndex=s++,l+=e.width):(e.lockShow=!0,e.hidden?e.lockShow=!1:n.showhide(e,!1),e.locked&&(e.lockShow=!0),e.locked=!1)}),i.$lockThead=i.$thead.clone(!0),i.$lockTbody=i.$tbody.clone(),i.$lockColgroupH=i.$colgroupH.clone(),i.$lockColgroupB=i.$colgroupB.clone(),i.$lockTableH.append(i.$lockColgroupH).append(i.$lockThead).css("width",l),i.$lockTableB.append(i.$lockColgroupB).append(i.$lockTbody).css("width",l),r&&(i.$lockTfoot=i.$tableF.find("> thead").clone(),i.$lockColgroupF=i.$colgroupF.clone(),i.$lockTableF.append(i.$lockColgroupF).append(i.$lockTfoot).css("width",l)),t.each(i.columnModel,function(t,e){e.lockShow&&n.showhide(e,!0),e.lockHide&&n.showhide(e,!1)}),i.$boxH.find("> div").css("width",""),i.$boxB.find("> div").css("width",""),i.$boxF&&i.$boxF.find("> div").css("width",""),setTimeout(function(){var t=i.$boxB.find("> div").width();i.$boxB.find("> div").width(t),i.$boxH.find("> div").width(t),i.$boxF&&i.$boxF.find("> div").width(t)},50),i.col_lock_count?i.$lockBox.show():i.$lockBox.hide(),i.$tbody.find("> ."+i.classnames.tr_child+", .datagrid-nodata").each(function(){t(this).find("> td").attr("colspan",i.columnModel.length-i.col_lock_count)}),l>1&&(l-=1),i.$boxH.css("margin-left",l),i.$boxB.css("margin-left",l),r&&i.$boxF.css("margin-left",l),i.$lockB.height(i.$boxB[0].clientHeight),i.$lockB.prop("scrollTop",i.$boxB[0].scrollTop);var c=i.$lockTableH.height(),u=i.$thead.height(),h=i.$lockTableF&&i.$lockTableF.height(),f=i.$tableF&&i.$tableF.height();c!=u&&(c<u?i.$lockTableH.height(u):i.$tableH.height(c)),h&&f&&h!=f&&(h<f?i.$lockTableF.find("> thead > tr:first-child > th:visible:first").height(f):i.$tableF.find("> thead > tr:first-child > th:visible:first").height(h)),a=i.$lockTbody.find("> tr"),e=i.$tbody.find("> tr"),setTimeout(function(){var n=i.$lockTableB.height(),o=i.$tableB.height();n!=o&&(n>o?a.each(function(a){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),e.eq(a).height(o))}):e.each(function(e){var i=t(this),n=i.find("> td:visible:first"),o=n.outerHeight();o>30&&(i.height(o),a.eq(e).height(o))}))},20),i.fixedLockItem(1),a.find("> td:hidden").remove(),i.initLockEvents(a)},a.prototype.initLockEvents=function(e){if(this.$lockTbody){var a=this,i=a.options;e||(e=a.$lockTbody.find("> tr")),e.on("click.bjui.datagrid.tr",function(e){var i=t(this).index();t(e.target).closest("td");a.$tbody.find("> tr:eq("+i+")").trigger("click.bjui.datagrid.tr")}).on("bjui.datagrid.tr.delete",function(e,i){var n=t(this);a.linenumberColumn&&a.linenumberColumn.locked&&n.nextAll(":not(."+a.classnames.tr_child+")").each(function(){var e=t(this).find("> td."+a.classnames.td_linenumber),i=parseInt(e.text(),10);e.text(i-1)})}).on("mouseenter.bjui.datagrid",function(e){var i=t(this),n=i.index();i.addClass("datagrid-hover"),a.$tbody.find("> tr:eq("+n+")").addClass("datagrid-hover")}).on("mouseleave.bjui.datagrid",function(e){var i=t(this),n=i.index();i.removeClass("datagrid-hover"),a.$tbody.find("> tr:eq("+n+")").removeClass("datagrid-hover")}),i.contextMenuB&&e.each(function(){a.tools.contextmenuB(t(this),!0)})}},a.prototype.filterInThead=function(){var e=this,a=(e.options,e.tools),i=e.regional,n=e.columnModel,o=t('<tr class="datagrid-filter"></tr>'),l=function(t,e,a){var i=e.type;"date"===i?t.on("afterchange.bjui.datepicker",function(a,i){s(e,t.val())}).change(function(){s(e,t.val())}):"findgrid"===i?(a.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(t,a){s(e,a.value)}),t.change(function(){s(e,t.val())})):"lookup"===i?(a.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(a,i){for(var n in i)e.name==n&&(t.val(i[n]),s(e,i[n]))}),t.change(function(){s(e,t.val())})):t.change(function(){s(e,t.val())})},s=function(t,e){a.quickFilter(t,e?{operatorA:"like",valA:e}:null)};e.inputs&&e.inputs.length||a.initEditInputs(),t.each(n,function(a,n){var s=t(e.inputs[a]),r=t("<th></th>"),d="";if(!n.quickfilter)return r.appendTo(o),!0;"findgrid"===n.type?s.data("context",o):"spinner"===n.type?s=t('<input type="text" name="'+n.name+'">'):"boolean"===n.type?s=t(BJUI.doRegional('<select name="'+n.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',i)):"select"===n.type&&(n.attrs&&"object"===_typeof(n.attrs)&&t.each(n.attrs,function(t,e){d+=" "+t+"="+e}),!s.find("> option:first-child").val()||n.attrs&&n.attrs.multiple||(s=t('<select name="'+n.name+'" data-toggle="selectpicker"'+d+"></select>").append(BJUI.doRegional('<option value="">#all#</option>',i)).append(s.html()),s.val(""))),r.append(s),n.hidden&&r.hide(),"boolean"===n.type&&r.attr("align","center"),r.appendTo(o),s.data("clearFilter",!1),l(s,n,r),s.on("bjui.datagrid.thead.clearfilter",function(){s.val(""),"boolean"!==n.type&&"select"!==n.type||s.selectpicker("refresh")}),n.$quickfilter=s}),o.appendTo(e.$thead).initui()},a.prototype.showLinenumber=function(e){var a,i=this,n=i.options,o=i.columnModel,l=-1,s=(i.data,t.inArray(i.linenumberColumn,o));if(-1!=s&&(a=o[s]),a)"string"!=typeof e||"lock"!==e&&"unlock"!==e?i.showhideColumn(a.th,!!e):i.colLock(a.th,"lock"===e);else if(e){l=t.inArray(i.childColumn,o),l++,a=i.linenumberColumn,a.index=l,o.splice(l,0,a),i.inputs&&i.inputs.length&&(i.inputs=i.inputs.splice(l,0,""));var r,d=i.$thead.find("> tr"),c='<col style="width:30px;">',u=d.filter(".datagrid-filter"),h=d.length-u.length;r=t('<th align="center"'+(h>1?' rowspan="'+h+' "':"")+'class="'+i.classnames.td_linenumber+(1==h?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label">'+i.linenumberColumn.label+"</div></div></th>"),i.$colgroupH.find("> col:eq("+l+")").before(c),i.$colgroupB.find("> col:eq("+l+")").before(c),i.$colgroupF&&i.$colgroupF.find("> col:eq("+l+")").before(c),u.length&&u.find("> th:eq("+l+")").before("<th></th>"),d.first().find("> th:eq("+l+")").before(r),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+l+")").before("<th></th>"),a.th=r,a.width=30,i.$tbody.find("> tr").each(function(e){var a=t(this),o=i.columnModel.length,s=e,r=i.paging;a.hasClass(i.classnames.tr_child)||a.hasClass("datagrid-nodata")?a.find("> td").attr("colspan",o):(s=i.tools.getNoChildDataIndex(s),n.linenumberAll&&(s=(r.pageCurrent-1)*r.pageSize+s),a.find("> td:eq("+l+")").before('<td align="center" class="'+i.classnames.td_linenumber+'">'+(s+1)+"</td>"))}),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+l+")").before("<th></th>"),t.each(o,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),r.find("> div").height(r.outerHeight()),"lock"===e&&i.colLock(r,!0),i.$showhide&&(i.$showhide.remove(),i.colShowhide(n.columnShowhide))}},a.prototype.showCheckboxcol=function(e){var a,i=this,n=i.options,o=i.columnModel,l=(o[0],-1),s=t.inArray(i.checkboxColumn,o);if(-1!=s&&(a=i.columnModel[s]),a)"string"!=typeof e||"lock"!==e&&"unlock"!==e?i.showhideColumn(a.th,e):i.colLock(a.th,"lock"===e);else if(e){l=t.inArray(i.linenumberColumn,o),-1==l&&(l=t.inArray(i.childColumn,o)),l++,a=i.checkboxColumn,a.index=l,o.splice(l,0,a),i.inputs&&i.inputs.length&&(i.inputs=i.inputs.splice(l,0,""));var r,d,c=i.$thead.find("> tr"),u='<col style="width:30px;">',h=c.filter(".datagrid-filter"),f=c.length-h.length;r=t('<th align="center"'+(f>1?' rowspan="'+f+' "':"")+'class="'+i.classnames.td_checkbox+(1==f?" single-row":"")+'"><div><div class="datagrid-space"></div><div class="datagrid-label"><input type="checkbox" data-toggle="icheck"></div></th>'),i.$colgroupH.find("> col:eq("+l+")").before(u),i.$colgroupB.find("> col:eq("+l+")").before(u),i.$colgroupF&&i.$colgroupF.find("> col:eq("+l+")").before(u),h.length&&h.find("> th:eq("+l+")").before("<th></th>"),c.first().find("> th:eq("+l+")").before(r),i.$tableF&&i.$tableF.find("> thead > tr > th:eq("+l+")").before("<th></th>"),r.initui(),a.th=r,a.width=30,i.$tbody.find("> tr").each(function(e){var a=t(this),n=i.columnModel.length;a.hasClass(i.classnames.tr_child)||a.hasClass("datagrid-nodata")?a.find("> td").attr("colspan",n):(d=t('<td align="center" class="'+i.classnames.td_checkbox+'"><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox"></td>'),a.find("> td:eq("+l+")").before(d),d.initui())}),t.each(o,function(t,e){e.index=t,e.th&&e.th.data("index",t)}),r.find("> div").height(r.outerHeight()),"lock"===e&&i.colLock(r,!0),i.$showhide&&(i.$showhide.remove(),i.colShowhide(n.columnShowhide))}},a.prototype.showEditCol=function(e){var a=this,i=a.options,n=a.columnModel,o=n[n.length-1];a.data;if(o===a.editBtnsColumn)a.showhideColumn(o.th,!!e);else if(e){var l,s,r=a.$thead.find("> tr"),d='<col style="width:110px;">',c=r.filter(".datagrid-filter"),u=r.length-c.length;o=a.editBtnsColumn,n.push(o),a.$colgroupH.append(d),a.$colgroupB.append(d),a.$colgroupF&&a.$colgroupF.append(d),l=t('<th align="center" rowspan="'+u+'">'+a.editBtnsColumn.label+"</th>"),r.first().append(l),c.length&&c.append("<th></th>"),l.initui().data("index",n.length-1),o.th=l,o.width=110,o.index=n.length-1,a.$tbody.find("> tr").each(function(e){var i=t(this),n=a.columnModel.length;i.hasClass(a.classnames.tr_child)||i.hasClass("datagrid-nodata")?i.find("> td").attr("colspan",n):(s=t('<td align="center" class="'+a.classnames.s_edit+'">'+BJUI.doRegional(FRAG.gridEditBtn,a.regional)+"</td>"),i.append(s),s.initui())}),a.edit(a.$tbody.find("> tr")),a.$tableF&&a.$tableF.find("> thead > tr").append("<th></th>"),a.$showhide&&(a.$showhide.remove(),a.colShowhide(i.columnShowhide))}},a.prototype.colResize=function(){var e=this,a=e.tools,i=e.columnModel,n=e.$thead,o=e.$grid.find("> .resizeProxy");o.length||(o=t('<div class="resizeProxy" style="left:0; display:none;"></div>'),o.appendTo(e.$grid)),n.find("> tr > th").each(function(n){var l=t(this);l.find("> div > ."+e.classnames.th_cell+"> ."+e.classnames.th_resizemark).on("mousedown.bjui.datagrid.resize",function(n){var s,r,d,c=e.$boxH.scrollLeft(),u=parseInt(e.$boxH.css("marginLeft")||0,10),h=l.data("index"),f=i[h],p=f.th.width(),g=e.$tbody.find("> tr"),m=e.$lockTbody&&e.$lockTbody.find("> tr"),b=e.$lockTableB&&e.$lockTableB.height(),v=e.$tableB.height();isNaN(u)&&(u=0),s=a.getRight(l)-c+u,e.isResize=!0,
f.locked&&(s=a.getRight4Lock(f.lockIndex),f.lockWidth&&(p=f.lockWidth)),o.show().css({left:s,bottom:e.$boxP?e.$boxP.outerHeight():0,cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:o,move:"horizontal",event:n,stop:function(){var a=o.position().left,i=a-s,n=i+p,l=e.$tableH.width()+i,c=e.$lockTableH&&e.$lockTableH.width()+i;if(n<5&&(n=20),f.minWidth&&n<f.minWidth&&(n=f.minWidth),n!=p+i&&(l=l-i+(n-p),c=c-i+(n-p)),f.width=n,f.locked){if(c<.75*e.$grid.width()){f.lockWidth=n,e.$lockColgroupH.find("> col:eq("+h+")").width(n),e.$lockColgroupB.find("> col:eq("+h+")").width(n),e.$lockColgroupF&&e.$lockColgroupF.find("> col:eq("+h+")").width(n),e.$lockTableH.width(c),e.$lockTableB.width(c),e.$lockTableF&&e.$lockTableF.width(c);var u=e.$lockBox.width();e.$boxH.css("margin-left",u-1),e.$boxB.css("margin-left",u-1),e.$boxH.find("> div").width(e.$boxH.width()),e.$boxB.find("> div").width(e.$boxH.width()),e.$boxF&&e.$boxF.css("margin-left",u-1),e.$colgroupH.find("> col:eq("+h+")").width(n),e.$colgroupB.find("> col:eq("+h+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+h+")").width(n)}}else setTimeout(function(){e.$colgroupH.find("> col:eq("+h+")").width(n),e.$colgroupB.find("> col:eq("+h+")").width(n),e.$colgroupF&&e.$colgroupF.find("> col:eq("+h+")").width(n)},1);setTimeout(function(){g.css("height",""),d=e.$tableB.height(),e.$lockTbody&&(m.css("height",""),r=e.$lockTableB.height(),r==b&&d==v||(r>d?m.each(function(e){var a=t(this),i=a.find("> td:eq("+f.lockIndex+")"),n=i.outerHeight();n>30&&(a.height(n),g.eq(e).height(n))}):g.each(function(e){var a=t(this),i=a.find("> td:eq("+h+")"),n=i.outerHeight();n>30&&(a.height(n),m.eq(e).height(n))})),e.$lockB.height(e.$boxB[0].clientHeight)),f.calc&&e.$tfoot&&e.$tfoot.trigger("bjui.datagrid.tfoot.resizeH"),e.isResize=!1},10),o.hide(),e.resizeFlag=!0}})})})},a.prototype.colMenu=function(){var e=this,a=e.options,i=e.tools,n=e.regional,o=e.$trsH.find("> th."+e.classnames.th_menu),l=e.$grid.find("> ."+e.classnames.s_menu);l.legnth||(l=t(BJUI.doRegional(FRAG.gridMenu,n)),l.hide().appendTo(e.$grid),e.$menu=l),e.colShowhide(a.columnShowhide),o.each(function(){var n,o=t(this),s=o.data("index"),r=e.columnModel[s],d=o.find("> div > ."+e.classnames.th_cell),c=d.find("> ."+e.classnames.btn_menu);c.length||(n=t('<button type="button" class="btn btn-default"><i class="fa fa-bars"></button>'),c=t('<div class="'+e.classnames.btn_menu+'"></div>').append(n),c.appendTo(d),n.click(function(){var s,d=(o.closest("tr"),parseInt(o.attr("rowspan")||1,10)),c=t(this).offset().left-e.$grid.offset().left-1,u=25*(e.$trsH.length-d)+13*d+11,h=l.find("> ul > li.datagrid-li-showhide"),f=l.data("bjui.datagrid.menu.btn");f&&f.length&&f.removeClass("active"),t(this).addClass("active"),h.length&&e.$showhide&&(e.$showhide.appendTo(h),e.$showhide.data("width")),l.css({position:"absolute",top:u,left:c}).show().data("bjui.datagrid.menu.btn",n).siblings("."+e.classnames.s_menu).hide(),s=l.outerWidth();var p=function(t){e.$boxH.width()-t<s?l.css({left:t-s+18}).addClass("position-right"):l.css({left:t}).removeClass("position-right")};p(c),function(t){e.$boxB.scroll(function(){var a=t.offset().left-e.$grid.offset().left-1;p(a)})}(n),a.columnFilter?e.colFilter(o):l.find("> ul > li."+e.classnames.li_filter).hide(),i.locking(o);var g=l.find("> ul > li."+e.classnames.li_asc),m=g.next();g.click(function(){r.sortAsc=!1,i.quickSort(r)}),m.click(function(){r.sortAsc=!0,i.quickSort(r)}),l.on("bjui.datagrid.th.sort",function(t,e){g.toggleClass("sort-active",e),m.toggleClass("sort-active",!e)})}))}),e.$grid.on("click.bjui.datagrid.filter",function(a){var i=t(a.target),n=e.$grid.find("."+e.classnames.s_menu+":visible");n.length&&!i.closest("."+e.classnames.btn_menu).length&&(i.closest("."+e.classnames.s_menu).length||n.hide().data("bjui.datagrid.menu.btn").removeClass("active"))})},a.prototype.colShowhide=function(t){var e=this,a=(e.options,e.tools),i=e.$menu,n=i.find("> ul"),o=n.find("> li."+e.classnames.li_showhide);t?e.$showhide||(a.createShowhide(),a.showSubMenu(o,i,e.$showhide)):o.hide()},a.prototype.showhideColumn=function(e,a){var i,n,o=this,l=o.tools;if("number"===t.type(e)){if((i=parseInt(e,10))<0)return}else i=e.data("index");if(n=o.columnModel[i]){if(n.locked){if(a)return;o.colLock(n.th,a)}l.showhide(n,a)}},a.prototype.colFilter=function(e,a){var i=this,n=(i.options,i.tools),o=i.regional,l=e.data("bjui.datagrid.filter"),s=i.$menu,r=s.find("> ul > li."+i.classnames.li_filter),d=i.columnModel[e.data("index")];if(i.inputs&&i.inputs.length||n.initEditInputs(),d.quickfilter){if(r.find("."+i.classnames.s_filter).addClass("hide"),!l||!l.length){l=t(BJUI.doRegional(FRAG.gridFilter.replaceAll("#label#",e.text()),o)).hide().appendTo(i.$grid);var c,u,h=e.data("index"),d=i.columnModel[h],f=d.type||"string",p=d.operator||[],g=l.find("span.filter-a"),m=l.find("span.filter-b"),b=t('<select data-toggle="selectpicker" data-container="true"></select>'),v=t(i.inputs[h]);v.removeAttr("data-rule").attr("size",10).addClass("filter-input"),"string"===f||"lookup"===f||"findgrid"===f?(p.length||(p=["=","!=","like"]),"findgrid"===f&&v.data("context",l)):"number"===f||"int"===f||"spinner"===f?("spinner"===f&&v.removeAttr("data-toggle"),p.length||(p=["=","!=",">","<",">=","<="])):"date"===f?p.length||(p=["=","!="]):"boolean"===f?(p.length||(p=["=","!="]),v=t(BJUI.doRegional('<select name="'+d.name+'" data-toggle="selectpicker"><option value="">#all#</option><option value="true">#true#</option><option value="false">#false#</option></select>',o))):"select"===f&&(p.length||(p=["=","!="]),v.attr("data-width","80"),v.find("> option:first-child").val()&&(v=t('<select name="'+d.name+'" data-toggle="selectpicker" data-width="80"></select>').append(BJUI.doRegional('<option value="">#all#</option>',o)).append(v.html())));for(var y=0,x=p.length;y<x;y++)b.append('<option value="'+p[y]+'">'+p[y]+"</option>");c=v,u=c.clone(),g.append(b).append(v),m.append(b.clone()).append(u),e.data("bjui.datagrid.filter",l),l.appendTo(r),l.data("width",l.outerWidth()).hide().initui(),l.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){for(var a in e)d.name==a&&v.val(e[a])});var k=l.find("button.ok"),C=l.find("button.clear"),j=l.find("select"),w=j.first(),$=j.last(),T=j.eq(1);k.click(function(){var a=w.val(),o=c.val().trim(),d=$.val(),h=u.val().trim(),f=T.val(),p={};o.length&&t.extend(p,{operatorA:a,valA:o}),h.length&&(o.length&&t.extend(p,{andor:f}),t.extend(p,{operatorB:d,valB:h})),t.isEmptyObject(p)||(n.quickFilter(i.columnModel[e.data("index")],p),i.$grid.trigger("click"),r.trigger("bjui.datagrid.th.submenu.hide",[s,l]))}),C.click(function(){var t=i.columnModel[e.data("index")];j.find("> option:first").prop("selected",!0),j.selectpicker("refresh"),c.val(""),u.val(""),t.isFiltered&&(n.quickFilter(t,null),i.$grid.trigger("click"),r.trigger("bjui.datagrid.th.submenu.hide",[s,l]))})}n.showSubMenu(r,s,l.removeClass("hide")),s.find('> ul > li:not(".'+i.classnames.li_filter+'")').on("mouseover",function(){r.hasClass("active")&&r.trigger("bjui.datagrid.th.submenu.hide",[s,l])})}else r.hide()},a.prototype.initPaging=function(){var e,a=this,i=a.tools,n=(a.options,a.paging),o=BJUI.regional.pagination,l=FRAG.gridPaging,s=[],r=n.pageCount,d=[],c=BJUI.StrBuilder();e=i.getPageInterval(r,n.pageCurrent,n.showPagenum);for(var u=e.start;u<e.end;u++)s.push(FRAG.gridPageNum.replace("#num#",u).replace("#active#",n.pageCurrent==u?" active":""));l=BJUI.doRegional(l.replaceAll("#pageCurrent#",n.pageCurrent).replaceAll("#count#",n.total+"/"+parseInt(r||0,10)),o),c.add('<div class="paging-content" style="width:'+a.$boxB.width()+'px;">').add('<div class="datagrid-pagesize"><button type="button" class="btn-default btn-refresh" title="'+o.refresh+'" data-icon="refresh"></button>').add('<select data-toggle="selectpicker"></select>').add("</div>").add('<div class="datagrid-paging">').add(l.replace("#pageNumFrag#",s.join(""))).add("</div>").add("</div>"),a.$boxP.html(c.toString()),a.$boxP.initui();var h=a.$boxP.find("div.datagrid-pagesize > select"),f=a.$boxP.find("ul.pagination"),p=f.find("> li.page-total"),g=p.next(),m=g.next(),b=m.next(),v=b.nextAll(".page-next"),y=v.next(),x=function(){m.addClass("disabled"),b.addClass("disabled")},k=function(){m.removeClass("disabled"),b.removeClass("disabled")},C=function(){v.addClass("disabled"),y.addClass("disabled")},j=function(){v.removeClass("disabled"),y.removeClass("disabled")},w=function(){x(),j()},$=function(){k(),C()},T=function(e){h.empty(),e||(e=a.paging.pageSize),d=n.selectPageSize.split(","),d.push(String(e)),t.unique(d).sort(function(t,e){return t-e});var i=[];t.each(d,function(t,e){i.push('<option value="'+e+'"'+(e==n.pageSize&&"selected")+">"+e+"/"+o.page+"</option>")}),h.html(i.join("")).selectpicker("refresh")};1==n.pageCurrent&&w(),n.pageCurrent==n.pageCount&&($(),1==n.pageCurrent&&x()),n.total||C(),T(),a.$boxP.on("click.datagrid.pagenum","li.page-num",function(e){var i=t(this);i.hasClass("active")||a.jumpPage(i.text()),e.preventDefault()}).on("click.datagrid.refresh","button.btn-refresh",function(){a.refresh()}).on("bjui.datagrid.paging.jump",function(t){for(var e=a.paging.pageCurrent,o=i.getPageInterval(a.paging.pageCount,e,n.showPagenum),l=[],s=o.start;s<o.end;s++)l.push(FRAG.gridPageNum.replace("#num#",s).replace("#active#",e==s?" active":""));f.find("> li.page-num").remove(),b.after(l.join("")),1==e?(w(),e==a.paging.pageCount&&C(),a.paging.total||C()):e==a.paging.pageCount?$():(k(),j()),g.find("input").val(e),p.find("> span").html(a.paging.total+"/"+a.paging.pageCount)}).on("bjui.datagrid.paging.pageSize",function(t,e){T(e)}).on("change","div.datagrid-pagesize > select",function(){var e=t(this).val();a.jumpPage(null,e)}),g.find("input").on("keyup",function(e){if(e.which===BJUI.keyCode.ENTER){var i=t(this).val();i&&a.jumpPage(i)}}),m.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(1)}),b.on("click",function(){a.paging.pageCurrent>1&&a.jumpPage(a.paging.pageCurrent-1)}),v.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCurrent+1)}),y.on("click",function(){a.paging.pageCurrent<a.paging.pageCount&&a.jumpPage(a.paging.pageCount)})},a.prototype.jumpPage=function(t,e){var a=this,i=a.paging,n=i.pageCount;t&&isNaN(t)||e&&isNaN(e)||t&&(t=parseInt(t,10),t<1&&(t=1),t>n&&(t=n),t==i.pageCurrent)||e&&(e=parseInt(e,10),"remote"!=a.options.local&&i.pageSize>i.total)||a.tools.jumpPage(t,e)},a.prototype.add=function(e,a){if(this.tools.beforeEdit()){if(!this.options.editUrl)return void BJUI.debug("Datagrid Plugin: Edit url is not set!");if(this.options.editMode){if(this.options.inlineEditMult){if("inline"!=this.options.editMode&&this.$tbody.find("> tr."+this.classnames.tr_add).length)return}else this.doCancelEditRow(this.$tbody.find("> tr."+this.classnames.tr_edit));var i,n,o=this,l=o.options,s=(o.tools,o.paging),r={},d=(s.pageCurrent-1)*s.pageSize,c=function(e){var i=t("<tr></tr>").addClass(o.classnames.tr_add),n=i.clone();return t.each(o.columnModel,function(e,a){var l=t("<td></td>");a.gridChild?l.addClass(o.classnames.td_child).html("<div>"+BJUI.doRegional(FRAG.gridExpandBtn,o.regional)+"</div>"):a.gridNumber?l.addClass(o.classnames.td_linenumber).text(0):a.gridCheckbox?l.addClass(o.classnames.td_checkbox).html('<div><input type="checkbox" data-toggle="icheck" name="datagrid.checkbox" value="true"></div>'):a.gridEdit?l.addClass(o.classnames.s_edit).data("isAdd",!0).html(BJUI.doRegional(FRAG.gridEditBtn,o.regional)):l.text(""),a.hidden&&l.css("display","none"),a.align&&l.attr("align",a.align),a.name&&(r[a.name]=""),a.locked?a.gridCheckbox?(l.clone().hide().appendTo(i),l.show().appendTo(n)):(l.clone().show().appendTo(n),l.hide().appendTo(i)):l.appendTo(i)}),a&&"object"===(void 0===a?"undefined":_typeof(a))&&i.data("datagrid.addData",a),r=t.extend({},o.attach,r),o.emptyData||(o.emptyData=r),{tr:i,lockTr:n.find("> td").length?n:null}};e||(e=l.addLocation||"first"),o.$lastSelect||("prev"===e?e="first":"next"===e&&(e="last")),"first"===e?(n=0,i=c(),i.tr.prependTo(o.$tbody),i.lockTr&&i.lockTr.prependTo(o.$lockTbody)):"last"===e?(n=o.data?o.data.length:0,i=c(),i.tr.appendTo(o.$tbody),i.lockTr&&i.lockTr.appendTo(o.$lockTbody)):"prev"===e?(n=o.$lastSelect.index(),i=c(),i.tr.insertBefore(o.$lastSelect),i.lockTr&&i.lockTr.insertBefore(o.$lockTbody.find("> tr:eq("+o.$lastSelect.index()+")"))):"next"===e&&(n=o.$lastSelect.index()+1,i=c(),i.tr.insertAfter(o.$lastSelect),i.lockTr&&i.lockTr.insertAfter(o.$lockTbody.find("> tr:eq("+o.$lastSelect.index()+")")));var a=t.extend({},o.emptyData,{addFlag:!0});o.data||(o.data=[]),o.allData||(o.allData=[]),o.allData.length?o.allData.splice(n+d,0,a):o.allData.push(a),o.data.length?o.data.splice(n,0,a):o.data.push(a),t.each(o.data,function(e,a){var i=l.linenumberAll?d+(e+1):e+1;t.extend(a,{gridNumber:i,gridIndex:e})}),i.tr.initui(),i.lockTr&&i.lockTr.initui(),l.showNoDataTip&&o.$tbody.find("> tr.datagrid-nodata").remove(),"auto"===l.height&&o.fixedHeight(),setTimeout(function(){o.initEvents(i.tr)},20),i.lockTr&&o.initLockEvents(i.lockTr),o.edit(i.tr),l.hasChild&&l.childOptions&&i.tr.after('<tr class="'+o.classnames.tr_child+'"></tr>'),"dialog"!=l.editMode?o.doEditRow(i.tr,"inline",!0):o.dialogEdit(i.tr,!0)}}},a.prototype.edit=function(e){var a,i=this,n=i.options,o=i.tools,l=n.editMode;i.columnModel;if(i.editInit=!1,l){if("object"===(void 0===l?"undefined":_typeof(l))){var s={},r=["dialog","navtab","div"],d=!1;i.editOptions=null;for(var c in l)if(-1!=t.inArray(c,r)){s.type=c,s.options=l[c],d=!0;break}if(!d)return void BJUI.debug("Dialog Plugn: The options 'editModel' set error!");t.isEmptyObject(s)||(i.editOptions=s)}else i.options.editUrl&&(i.options.editUrl=i.options.editUrl.replace(/{\/?[^}]*}/g,"")),"dialog"!=l&&(l="inline");e||(e=i.$tbody.find("> tr")),a=e.find("> td."+i.classnames.s_edit),i.editInit=!0,a.each(function(){var e=t(this),a=e.find("button"),n=a.first(),s=n.next(),r=s.next(),d=r.next(),c=d.next();n.on("click",function(n,c){var u=t(this),h=u.closest("tr"),f=h.index(),p=e.data("isAdd");return f=i.tools.getNoChildDataIndex(f),c||(c=i.isDom?h.data("initData")||o.setDomData(h):i.data[f]),!!o.beforeEdit(h,c)&&(i.editOptions?(i.externalEdit(h,null,c),!1):("dialog"!=l?(i.inlineEdit(h,p),a.hide(),s.show(),d.show(),p&&(s.hide(),r.show())):i.dialogEdit(h,p),void n.stopPropagation()))}),r.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),s.on("click",function(e){var a=t(this),n=a.closest("tr");i.updateEdit(n,a),e.stopPropagation()}).on("bjui.datagrid.update.tr",function(){a.hide(),n.show(),c.show()}),d.on("click",function(e){var o=t(this),l=o.closest("tr");i.cancelEdit(l),a.hide(),n.show(),c.show(),e.stopPropagation()}),c.on("click",function(e){var a=t(this),n=a.closest("tr");i.delRows(n),e.stopPropagation()})})}},a.prototype.externalEdit=function(e,a,i){var n,o,l,s,r=this,d=r.options,c={},u=["dialog","navtab","div"];if(a&&"object"===(void 0===a?"undefined":_typeof(a))){for(var h in a)if(-1!=t.inArray(h,u)){c.type=h,c.options=a[h];break}}else c=t.extend({},r.editOptions);if(e instanceof jQuery)n=e;else{if(isNaN(e))return void BJUI.debug("Datagrid Plugin: Func 'externalEdit', Parameter 'row' is incorrect!");n=r.$tbody.find("> tr:not(."+r.classnames.tr_child+")").eq(parseInt(e,10))}if(void 0===c)return void BJUI.debug("Datagrid Plugin: Func 'externalEdit', Parameter 'editOptions' is incorrect!");if(c&&(i||(r.isDom?i=n.data("initData")||r.tools.setDomData(n):(o=r.tools.getNoChildDataIndex(n.index()),i=r.data[o])),c.options.url&&!c.options["datagrid.nourl"]||(c.options["datagrid.nourl"]=!0,c.options.url=d.editUrl),l=c.options.url,l&&!l.isFinishedTm()&&(l=!i||i.addFlag?l.replace(/{\/?[^}]*}/g,""):r.tools.replacePlh(l,i),l.isFinishedTm()?l=l:BJUI.debug("Datagrid Plugin: Func 'externalEdit', the property 'url' of options 'editOptions' is incorrect: "+l)),l)){c.options.url=l,s=c.type,n.data("datagrid.addData")&&(c.options.data?t.extend(c.options.data,n.data("datagrid.addData")):c.options.data=n.data("datagrid.addData")),c.options.id||(c.options.id="datagrid-external-edit"+(new Date).getTime()),c.options.onClose=function(){n.hasClass(r.classnames.tr_add)&&r.cancelEdit(n)};var f=function(e){var a,o=!1;if("array"===t.type(e)?(o=!0,a=e[0]):"object"===(void 0===e?"undefined":_typeof(e))&&(o=!0,a=e),o&&(t.extend(i,"object"===(void 0===a?"undefined":_typeof(a))&&a),n.hasClass(r.classnames.tr_add)&&n.length===r.$tbody.find("> tr:not(."+r.classnames.tr_child+")").length&&r.fixtedColumnWidthCount&&(r.fixedColumnWidth=!0),i.addFlag&&(i.addFlag=!1),r.dialogEditComplete(n,i),"dialog"===s?BJUI.dialog("close",c.options.id):"navtab"===s&&BJUI.navtab("closeTab",c.options.id),r.tools.afterSave(n,i),i["refresh.datagrid.child"])){var l=n.data("bjui.datagrid.child");l&&l.length?l.datagrid("refresh"):r.showChild(n)}};c.options.onLoad=function(e){var a=e.find("form.datagrid-edit-form");a&&a.length&&(a=a.first(),a.removeAttr("okCallback").data("okCallback",t.proxy(f,r)))},"dialog"===s?BJUI.dialog(c.options):"navtab"===s?BJUI.navtab(c.options):"div"===s&&BJUI.ajax("doload",c.options)}},a.prototype.doEditRow=function(e,a,i){if(this.editInit){var n,o,l=this,s=[];if(a=a||l.options.editMode,"object"===(void 0===e?"undefined":_typeof(e)))n=e;else if(isNaN(e)){var r,d=l.$tbody.find("> tr:not(."+l.classnames.tr_child+")"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a,i=parseInt(e.trim(),10);(a=d.eq(i))&&a.length&&(r=r?r.add(a):a)}),n=r}else isNaN(e)||(n=l.$tbody.find("> tr:not(."+l.classnames.tr_child+")").eq(e));if(n.length&&(n.each(function(){var e,a=t(this),i=a.index();i=l.tools.getNoChildDataIndex(i),e=l.isDom?a.data("initData")||tools.setDomData(a):l.data[i],s.push(e)}),l.tools.beforeEdit(n,s)))return l.options.editUrl?void(l.editOptions?l.externalEdit(n.last(),null,s[n.length-1]):n.each(function(e){var n=t(this);if(o=n.find("> td."+l.classnames.s_edit+" button.edit"),"dialog"==a)return l.dialogEdit(n,i,s[e]),!1;o.length?o.trigger("click",[s[e]]):l.inlineEdit(n,i,s[e])})):void BJUI.debug("Datagrid Plugin: Edit url is not set!")}},a.prototype.doCancelEditRow=function(e){var a,i=this;a="number"===t.type(e)?this.$tbody.find("> tr").eq(e):e,a.each(function(){var e=t(this),a=e.find("> td."+i.classnames.s_edit+" > button.cancel");a.length?a.trigger("click"):i.cancelEdit(e)})},a.prototype.doSaveEditRow=function(e){var a,i=this,n=i.options;if(a="number"===t.type(e)?this.$tbody.find("> tr").eq(e):e||i.$tbody.find("> tr."+i.classnames.tr_edit),!a.length)return void i.$grid.alertmsg("info",BJUI.getRegional("datagrid.saveMsg"));1==a.length?a.hasClass(i.classnames.tr_edit)&&this.updateEdit(a):n.saveAll?i.saveAll(a):a.each(function(){i.updateEdit(t(this))})},a.prototype.delRows=function(e){var a,i=this,n=i.options,o=n.beforeDelete,l=n.delConfirm;if(!o||("string"==typeof o&&(o=o.toFunc()),"function"!=typeof o||o.call(this))){if("object"===(void 0===e?"undefined":_typeof(e)))a=e;else if(isNaN(e)){var s,r=i.$tbody.find("> tr:not(."+i.classnames.tr_child+")"),e=e.split(",");e=e.unique(),e.sort(function(t,e){return t.trim()-e.trim()}),t.each(e,function(t,e){var a=r.eq(parseInt(e.trim(),10));a&&a.length&&(s=s?s.add(a):a)}),a=s}else isNaN(e)||(a=this.$tbody.find("> tr:not(."+i.classnames.tr_child+")").eq(e));if(a&&a.length){var d=function(){a.each(function(){var e=t(this),a=i.options.childUpdate,n=i.$element.data("bjui.datagrid.parent"),o=function(t){t.closest("table").datagrid("updateRow",t)};n&&a&&("string"==typeof a?-1===a.indexOf("all")&&-1===a.indexOf("del")||o(n):o(n)),e.trigger("bjui.datagrid.tr.delete")}),i.tools.afterDelete(),"auto"===n.height&&i.fixedHeight()},c=function(){var e=a.filter("."+i.classnames.tr_add);if(!e.length||(i.cancelEdit(e),a.not(e).length))if(n.delUrl){var o=[],l=n.delCallback;a.not(e).each(function(){var e,a,l=t(this),s=l.index();e=i.isDom?l.data("initData")||i.tools.setDomData(l):i.data[i.tools.getNoChildDataIndex(s)],n.delPK?o.push(e[n.delPK]):(n.jsonPrefix?(a={},t.each(e,function(t,e){if("gridCheckbox"===t||"gridEdit"===t)return!0;a[n.jsonPrefix+"."+t]=e})):(a=t.extend({},e),delete a.gridCheckbox,delete a.gridEdit),o.push(a))}),"string"==typeof l&&(l=l.toFunc());var s=n.delType,r={url:n.delUrl,data:n.delPK?[{name:n.delPK,value:o.join(",")}]:JSON.stringify(o),type:"POST",okCallback:l||function(t){d()}};s&&"raw"===s&&!n.delPK?r.contentType="application/json":(!n.delPK&&(r.data={json:r.data}),s&&"raw"!==s&&(r.type=s)),BJUI.ajax("doajax",r)}else d()};l?("string"!=typeof l&&(l=1==a.length?BJUI.getRegional("datagrid.delMsg"):BJUI.getRegional("datagrid.delMsgM")),i.$grid.alertmsg("confirm",l,{okCall:function(){c()}})):c()}}},a.prototype.inlineEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n=this,o=n.options,l=n.tools,s=n.columnModel,r=e.find("> td"),d=r.length,c=e.index(),u=c;if(u=l.getNoChildDataIndex(u),i||(i=n.isDom?e.data("initData")||l.setDomData(e):n.data[u]),e.hasClass(n.classnames.tr_edit))return!1;n.inputs&&n.inputs.length||l.initEditInputs(),e.addClass(n.classnames.tr_edit).data(n.datanames.changeData,{}),e.data("validator")&&e.validator("destroy"),o.inlineEditMult||n.doCancelEditRow(e.siblings("."+n.classnames.tr_edit)),n.$lastEditTr=e,r.each(function(o){var l,r=t(this),u=s[o],h=u&&u.name&&i[u.name],f=r.html(),p=n.inputs[o];if(r.data(n.datanames.td_html,f),a?u.add||(p=""):(i.addFlag&&(i.addFlag=!1),u.edit||(p="")),p&&(l=t(p),void 0!==h&&"null"!==h&&null!==h||(h=""),"boolean"===u.type?l.prop("checked",h):"findgrid"===u.type?l.data("context",e).val(String(h)):(l.val(String(h)),l.isTag("select")&&l.prop("multiple")&&h&&!t.isArray(h)&&l.val(h.split(","))),a?u.addAttrs&&"object"===_typeof(u.addAttrs)&&t.each(u.addAttrs,function(t,e){l.attr(t,e)}):u.editAttrs&&"object"===_typeof(u.editAttrs)&&t.each(u.editAttrs,function(t,e){l.attr(t,e)}),r.empty().append(l).addClass(n.classnames.td_edit),function(o,l,s){var r=e.data(n.datanames.changeData),d=u.jsontype,c=void 0===u.defaultVal?null:u.defaultVal;switch(u.type){case"date":o.on("afterchange.bjui.datepicker",function(t,e){l.addClass(n.classnames.td_changed),o.val()==s&&l.removeClass(n.classnames.td_changed),r[u.name]=o.val()}).change(function(){l.addClass(n.classnames.td_changed),o.val()==s&&l.removeClass(n.classnames.td_changed),r[u.name]=o.val()});break;case"select":o.change(function(){var e=t(this).val();l.addClass(n.classnames.td_changed),e==String(s)&&l.removeClass(n.classnames.td_changed),o.prop("multiple")?t.isArray(e)&&(e=e.join(",")):d&&("boolean"===d?e=Boolean(e):"number"===d&&!isNaN(Number(e))&&(e=Number(e))),r[u.name]=e});break;case"boolean":o.on("ifChanged",function(){l.toggleClass(n.classnames.td_changed);var e=t(this).is(":checked");e==s&&l.removeClass(n.classnames.td_changed),r[u.name]=e});break;case"findgrid":r[u.name]=o.val(),l.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(t,e){var a=e.value;l.toggleClass(n.classnames.td_changed),a==r[u.name]&&l.removeClass(n.classnames.td_changed),d&&"number"===d&&!isNaN(Number(a))&&(a=Number(a)),r[u.name]=a}),o.change(function(){var e=t(this).val();l.addClass(n.classnames.td_changed),e==s&&l.removeClass(n.classnames.td_changed),d&&"number"===d&&!isNaN(Number(e))&&(e=Number(e)),r[u.name]=e});break;case"lookup":l.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(t,e){l.toggleClass(n.classnames.td_changed);for(var a in e)void 0!==i[a]&&(r[a]=e[a]),u.name==a&&(o.val()==e[a]?l.removeClass(n.classnames.td_changed):o.val(e[a]))}),o.change(function(){l.addClass(n.classnames.td_changed),o.val()==s&&l.removeClass(n.classnames.td_changed),r[u.name]=o.val()});break;case"spinner":o.on("afterchange.bjui.spinner",function(t,e){l.addClass(n.classnames.td_changed),o.val()==s&&l.removeClass(n.classnames.td_changed),r[u.name]=Number(o.val())}).change(function(){l.addClass(n.classnames.td_changed),o.val()==s&&l.removeClass(n.classnames.td_changed),r[u.name]=Number(o.val())});break;default:o.change(function(){var e=t(this).val();l.addClass(n.classnames.td_changed),e==s&&l.removeClass(n.classnames.td_changed),d&&"number"===d&&!isNaN(Number(e))&&(e=Number(e)),r[u.name]=e})}a?"boolean"===u.type?(c=Boolean(c),r[u.name]=c,o.prop("checked",c)):null!=c?(o.isTag("select")&&o.prop("multiple")?o.val(t.isArray(c)?c:c.split(",")):o.val(String(c)),d&&("number"===d?!isNaN(Number(c))&&(c=Number(c)):"boolean"===d&&(c=Boolean(c))),r[u.name]=c):o.isTag("select")&&!o.prop("multiple")&&(r[u.name]=o.val()):d&&o.trigger("change")}(l,r,h),u.locked)){var g=n.$lockTbody.find("tr:eq("+c+")"),m=g.find("> td:eq("+u.lockIndex+")");r.clone().html(f).insertAfter(r),r.show().insertAfter(m).initui(),m.remove()}--d||e.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})})},a.prototype.saveAll=function(e){var a,i,n,o,l,s=this,r=s.options,d=r.editCallback,c=[],u=[],h=[],f=e&&e.length;if(e&&!e.length||(e=s.$tbody.find("> tr."+s.classnames.tr_edit),f=e.length),f&&(e.each(function(){a=t(this),n=s.tools.getNoChildDataIndex(a.index()),i=s.isDom?a.data("initData"):s.data[n],c.push(i),a.isValid(function(e){if(!e)return u=[],!1;o=a.data(s.datanames.changeData),t.extend(i,o),r.jsonPrefix?(l={},t.each(i,function(t,e){if("gridChild"===t||"gridCheckbox"===t||"gridEdit"===t)return!0;l[r.jsonPrefix+"."+t]=e})):(l=t.extend({},i),delete l.gridChild,delete l.gridCheckbox,delete l.gridEdit),f--,u.push(l)})}),!f&&(d=d?d.toFunc():function(o){"array"===t.type(o)?h=o:"object"===(void 0===o?"undefined":_typeof(o))&&h.push(o),e.filter("."+s.classnames.tr_add).length===s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").length&&s.fixtedColumnWidthCount&&(s.fixedColumnWidth=!0),e.each(function(e){a=t(this),n=a.index(),s.columnModel[0]===s.childColumn&&(n/=2),i=s.isDom?a.data("initData"):s.data[n],t.extend(i,"object"===_typeof(h[e])&&h[e]),s.allData&&s.allData[i.gridIndex]&&t.extend(s.allData[i.gridIndex],i),s.inlineEditComplete(a,i)}),s.tools.afterSave(e,u)},s.tools.beforeSave(e,c)))){var p=r.editType,g={url:r.editUrl,data:JSON.stringify(u),type:"POST",okCallback:d};p&&"raw"===p?g.contentType="application/json":(g.data={json:g.data},p&&(g.type=p)),BJUI.ajax("doajax",g)}},a.prototype.updateEdit=function(e,a){var i,n,o,l,s=this,r=s.options,d=r.editCallback,c=[],u=[],h=e.index();h=s.tools.getNoChildDataIndex(h),i=s.isDom?e.data("initData"):s.data[h],e.hasClass(s.classnames.tr_edit)&&e.isValid(function(h){if(h&&(n=e.data(s.datanames.changeData),t.extend(i,n),r.jsonPrefix?(o={},t.each(i,function(t,e){if("gridChild"===t||"gridCheckbox"===t||"gridEdit"===t)return!0;o[r.jsonPrefix+"."+t]=e})):(o=t.extend({},i),delete o.gridChild,delete o.gridCheckbox,delete o.gridEdit),d=d?d.toFunc():function(n){"array"===t.type(n)?l=n[0]:"object"===(void 0===n?"undefined":_typeof(n))&&(l=n),t.extend(i,"object"===(void 0===l?"undefined":_typeof(l))&&l),s.allData&&s.allData[i.gridIndex]&&t.extend(s.allData[i.gridIndex],i),e.hasClass(s.classnames.tr_add)&&e.length===s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").length&&s.fixtedColumnWidthCount&&(s.fixedColumnWidth=!0),s.inlineEditComplete(e,i,a),s.tools.afterSave(e,i)},c.push(i),s.tools.beforeSave(e,c))){u.push(o);var f=r.editType,p={url:r.editUrl,data:JSON.stringify(u),type:"POST",okCallback:d};f&&"raw"===f?p.contentType="application/json":(p.data={json:p.data},f&&(p.type=f)),BJUI.ajax("doajax",p)}})},a.prototype.cancelEdit=function(e){var a=this,i=a.columnModel;e.each(function(){var e=t(this),n=e.index(),o=n;e.hasClass(a.classnames.tr_edit)&&e.removeClass(a.classnames.tr_edit).find("> td."+a.classnames.td_edit).each(function(){var e=t(this),o=e.index(),l=i[o],s=e.data(a.datanames.td_html);if(e.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(s),l.locked){var r=a.$lockTbody.find("tr:eq("+n+")"),d=r.find("> td:eq("+l.lockIndex+")");s=d.data(a.datanames.td_html),r.removeClass(a.classnames.tr_edit),d.removeClass(a.classnames.td_edit).removeClass(a.classnames.td_changed).html(s)}}),e.hasClass(a.classnames.tr_add)&&(o=a.tools.getNoChildDataIndex(o),a.data=a.data.remove(o),e.next().hasClass(a.classnames.tr_child)&&(e.next().remove(),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").next().remove()),a.$lockTbody&&a.$lockTbody.find("> tr:eq("+n+")").remove(),e.remove(),a.tools.createNoDataTr(),"auto"===a.options.height&&a.fixedHeight())})},a.prototype.inlineEditComplete=function(e,i,n){var o=this,l=o.columnModel,s=e.index(),r=e.find("> td"),d=!1,c=o.$lockTbody&&o.$lockTbody.find("> tr:eq("+s+")");if(t.each(l,function(t,e){if(e.gridNumber&&(d=!0),e.gridChild||e.gridNumber||e.gridCheckbox||e.gridEdit)return!0;var n,l=e.name?i[e.name]:"",s=r.eq(e.index);if(void 0===l&&(l=""),s.text(l).removeClass(o.classnames.td_edit).removeClass(o.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(n=e.render.call(o,l,i,e.items),s.html(n)):(n=e.render.call(o,l,i),s.html(n)):e.items&&(n=a.renderItem.call(o,l,i,e.items),s.html(n)),e.locked&&c){c.find("> td:eq("+e.lockIndex+")").removeClass(o.classnames.td_changed).html(s.html())}}),e.removeClass(o.classnames.tr_edit).initui(),c&&c.removeClass(o.classnames.tr_edit).initui(),n||(n=r.filter("."+o.classnames.s_edit).find("button.update")),n&&n.length&&n.trigger("bjui.datagrid.update.tr"),e.hasClass(o.classnames.tr_add)){if(e.removeClass(o.classnames.tr_add),e.find("> td."+o.classnames.s_edit).removeData("isAdd"),d){var u;o.linenumberColumn.locked&&(o.colLock(o.linenumberColumn.th,!1),u=!0),o.$tbody.find("> tr:not(."+o.classnames.tr_child+")").each(function(e){t(this).find("> td."+o.classnames.td_linenumber).text(e+1)}),u&&o.colLock(o.linenumberColumn.th,!0)}e.next("."+o.classnames.tr_child).remove(),o.tools.createChildTr(e,i)}},a.prototype.dialogEdit=function(e,a,i){if(!this.tools.beforeEdit(e,i))return!1;var n,o,l,s=this,r=s.options,d=s.tools,c=s.columnModel,u=e.index(),h=u;i||(h=d.getNoChildDataIndex(h),i=s.isDom?e.data("initData")||d.setDomData(e):s.data[h]),s.inputs&&s.inputs.length||d.initEditInputs(),l=r.gridTitle||"datagrid",a?l+=" - "+BJUI.getRegional("datagrid.add"):(i.addFlag&&(i.addFlag=!1),l+=" - "+BJUI.getRegional("datagrid.edit")),n=t('<div><div class="bjui-pageContent"></div><div class="bjui-pageFooter"></div></div>'),o=t('<form class="datagrid-dialog-edit-form"></form>');var f=function(e,n,o,l){var r=e.data(s.datanames.changeData),d=l.jsontype,c=void 0===l.defaultVal?null:l.defaultVal;switch(l.type){case"date":o.on("afterchange.bjui.datepicker",function(e,a){r[l.name]=t(this).val()}).change(function(){r[l.name]=t(this).val()});break;case"select":o.change(function(){var e=t(this),a=e.val(),i=e.prop("multiple");i&&t.isArray(a)&&(a=a.join(",")),!i&&d&&("boolean"===d?a=Boolean(a):"number"===d&&!isNaN(Number(a))&&(a=Number(a))),r[l.name]=a});break;case"boolean":o.on("ifChanged",function(){r[l.name]=t(this).is(":checked")});break;case"findgrid":n.on("afterchange.bjui.findgrid",'[data-toggle="findgrid"]',function(t,e){var a=e.value;d&&"number"===d&&!isNaN(Number(a))&&(a=Number(a)),r[l.name]=a}),o.change(function(){r[l.name]=t(this).val()});break;case"lookup":n.on("customEvent.bjui.lookup",'[data-toggle="lookupbtn"]',function(e,a){for(var n in a)void 0!==i[n]&&(r[n]=a[n]),l.name==n&&t(this).val(a[n])}),o.change(function(){r[l.name]=t(this).val()});break;case"spinner":o.on("afterchange.bjui.spinner",function(e,a){r[l.name]=Number(t(this).val())}).change(function(){r[l.name]=Number(t(this).val())});break;default:o.change(function(){var e=t(this).val();d&&"number"===d&&!isNaN(Number(e))&&(e=Number(e)),r[l.name]=e})}a?"boolean"===l.type?(c=Boolean(c),r[l.name]=c,o.prop("checked",c)):null!=c?(o.isTag("select")&&o.prop("multiple")?o.val(t.isArray(c)?c:c.split(",")):o.val(String(c)),d&&("number"===d?!isNaN(Number(c))&&(c=Number(c)):"boolean"===d&&(c=Boolean(c))),r[l.name]=c):o.isTag("select")&&!o.prop("multiple")&&(r[l.name]=o.val()):d&&o.trigger("change")},p=function(n){
var o,l,u=n.find("form.datagrid-dialog-edit-form"),h=n.find("div.bjui-pageFooter button"),p=h.first(),g=h.eq(1),m=h.eq(2),b=h.last(),v=function(e,i,n){i.empty(),n.data(s.datanames.changeData)||n.data(s.datanames.changeData,{}),i.data("validator")&&i.validator("destroy"),t.each(c,function(o,l){if(!l.name||l===s.childColumn||l===s.linenumberColumn||l===s.checkboxColumn||l===s.editBtnsColumn)return!0;var r,d=s.inputs[o],c=t("<p></p>"),u="datagrid-dialog-edit-column-"+o,h=e[l.name];a?l.add||(d=""):l.edit||(d=""),void 0!==h&&"null"!==h&&null!==h||(h=""),d?(r=t(d).attr("id",u),r.isTag("select")?r.attr("data-width","auto"):r.isTag("checkbox")||r.attr("size",30),"boolean"===l.type?r.prop("checked",h):"findgrid"===l.type?r.val(String(h)).data("context",i):r.val(String(h)),r.isTag("select")&&r.prop("multiple")&&h&&!t.isArray(h)&&r.val(h.split(",")),a?l.addAttrs&&"object"===_typeof(l.addAttrs)&&t.each(l.addAttrs,function(t,e){r.attr(t,e)}):l.editAttrs&&"object"===_typeof(l.editAttrs)&&t.each(l.editAttrs,function(t,e){r.attr(t,e)})):a||l.edit||(d=h),c.append('<label class="control-label x120" for="'+u+'">'+l.label+"：</label>").append(t('<span class="datagrid-dialog-column-span"></span>').append(r||d)).appendTo(i),r&&f(n,i,r,l)}),i.initui().validator({msgClass:"n-bottom",theme:"red_bottom_effect_grid"})};u.is(":empty")&&v(i,u,e),o=e.index(),s.columnModel[0]===s.childColumn&&(o*=2),o||p.addClass("disabled"),o==s.data.length-1&&g.addClass("disabled"),p.click(function(){var t,a=e.prev();s.options.hasChild&&s.options.childOptions&&(a=a.prev()),a.length?(l=s.tools.getNoChildDataIndex(a.index()),t=s.isDom?a.data("initData")||d.setDomData(a):s.data[l],e=a,v(t,u,e),g.removeClass("disabled"),a.prev().length||p.addClass("disabled")):p.addClass("disabled")}),g.click(function(){var t,a,i=e.next();s.options.hasChild&&s.options.childOptions&&(i=i.next()),i.length?(a=i.next(),l=s.tools.getNoChildDataIndex(i.index()),s.options.hasChild&&s.options.childOptions&&(a=a.length&&a.next()),t=s.isDom?i.data("initData")||d.setDomData(i):s.data[l],e=i,v(t,u,e),u.initui(),p.removeClass("disabled"),a&&a.length||g.addClass("disabled")):g.addClass("disabled")}),b.click(function(){var a,i,n,o,d=[],c=r.editCallback;l=s.tools.getNoChildDataIndex(e.index()),i=s.isDom?e.data("initData"):s.data[l],u.isValid(function(l){if(l&&(a=e.data(s.datanames.changeData),t.extend(i,a),r.jsonPrefix?(n={},t.each(i,function(t,e){return"gridChild"===t||"gridCheckbox"===t||"gridEdit"===t||(!(t&&edit&&add)||void(n[r.jsonPrefix+"."+t]=e))})):(n=t.extend({},i),delete n.gridCheckbox,delete n.gridEdit),c=c?c.toFunc():function(a){"array"===t.type(a)?o=a[0]:"object"===(void 0===a?"undefined":_typeof(a))&&(o=a),t.extend(i,"object"===(void 0===o?"undefined":_typeof(o))&&o),e.hasClass(s.classnames.tr_add)&&e.length===s.$tbody.find("> tr:not(."+s.classnames.tr_child+")").length&&s.fixtedColumnWidthCount&&(s.fixedColumnWidth=!0),s.dialogEditComplete(e,i),s.$grid.dialog("close","datagrid-dialog-edit"),s.tools.afterSave(e,i)},d.push(i),s.tools.beforeSave(e,d))){var u=r.editType,h={url:r.editUrl,data:JSON.stringify(n),type:"POST",okCallback:c};u&&"raw"===u?h.contentType="application/json":(h.data={json:h.data},u&&(h.type=u)),BJUI.ajax("doajax",h)}})}),m.click(function(){s.$grid.dialog("close","datagrid-dialog-edit")})},g=function(){var e=!1;s.$tbody.find("> tr."+s.classnames.tr_add).each(function(){var a=t(this),i=a.index(),n=i;n=s.tools.getNoChildDataIndex(n),s.data=s.data.remove(n),a.next().hasClass(s.classnames.tr_child)&&(a.next().remove(),s.$lockTbody&&s.$lockTbody.find("> tr:eq("+i+")").next().remove()),s.$lockTbody&&s.$lockTbody.find("> tr:eq("+i+")").remove(),a.remove(),e=!0}),e&&"auto"===s.options.height&&s.fixedHeight()};n.find("> div:first").append(o).next().append(BJUI.doRegional(FRAG.gridDialogEditBtns,s.regional));var m=t.extend({},{id:"datagrid-dialog-edit",fresh:!0,target:n[0],width:520,height:400,mask:!0,title:l,onLoad:p,onClose:g},"object"===_typeof(r.editDialogOp)&&r.editDialogOp);s.$grid.dialog(m)},a.prototype.dialogEditComplete=function(e,i){var n=this,o=n.columnModel,l=e.index(),s=e.find("> td"),r=!1,d=(n.$tbody.find("> tr"),n.$lockTbody&&n.$lockTbody.find("> tr:eq("+l+")"));if(t.each(o,function(t,e){if(e.gridNumber&&(r=!0),e.gridChild||e.gridNumber||e.gridCheckbox||e.gridEdit)return!0;var o,l=e.name?i[e.name]:"",c=s.eq(e.index);if(void 0!==l&&"null"!==l&&null!==l||(l=""),c.text(l).removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed),e.render&&"function"==typeof e.render?e.items?(o=e.render.call(n,l,i,e.items),c.html(o)):(o=e.render.call(n,l,i),c.html(o)):e.items&&(o=a.renderItem.call(n,l,i,e.items),c.html(o)),e.locked&&d){d.find("> td:eq("+e.lockIndex+")").removeClass(n.classnames.td_edit).removeClass(n.classnames.td_changed).html(c.html())}}),e.initui(),d&&d.initui(),e.hasClass(n.classnames.tr_add)){if(e.removeClass(n.classnames.tr_add),r){var c;n.linenumberColumn.locked&&(n.colLock(n.linenumberColumn.th,!1),c=!0),n.$tbody.find("> tr:not(."+n.classnames.tr_child+")").each(function(e){t(this).find("> td."+n.classnames.td_linenumber).text(e+1)}),c&&n.colLock(n.linenumberColumn.th,!0)}e.next("."+n.classnames.tr_child).remove(),n.tools.createChildTr(e,i)}},a.prototype.resizeGrid=function(){var e,a=this,i=(a.$grid.getPageTarget(),function(){a.initFixedW&&String(a.options.width).endsWith("%")&&(e=a.$grid.parent().width(),a.fixedWidth(),a.options.hasChild&&a.options.childOptions&&a.$tbody.find("> tr."+a.classnames.tr_child+":visible").each(function(){var e=t(this),a=e.prev(),i=a.data("bjui.datagrid.child");i&&i.length&&i.datagrid("fixedWidth")})),String(a.options.height).endsWith("%")&&a.tools.setBoxbH()});t('a[data-toggle="tab"]').on("shown.bs.tab",t.proxy(function(e){if(!a.$element.data("bjui.datagrid.init.tab")){var i=t(e.target),n=i.data("target"),o=i.attr("href");n||(n=t(o)),n&&n.length&&n.find(a.$element).length&&(a.$element.data("bjui.datagrid.init.tab",!0),a.$element.datagrid("fixedHeight"))}},a)),t(window).on(BJUI.eventType.resizeGrid,t.proxy(i,a))};var i=t.fn.datagrid;t.fn.datagrid=e,t.datagrid=a,t.fn.datagrid.noConflict=function(){return t.fn.datagrid=i,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('table[data-toggle="datagrid"]').each(function(){var a=t(this),i=a.data();a.length&&(i.options&&"string"==typeof i.options&&(i.options=i.options.toObj()),t.extend(i,"object"===_typeof(i.options)&&i.options),e.call(a,i))})})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.tablefixed");s||o.data("bjui.tablefixed",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};a.SCROLLW=18,a.DEFAULTS={width:"100%"},a.prototype.TOOLS=function(){return{getLeft:function(e){var a=0;return e.prevAll().each(function(){a+=t(this).outerWidth()}),a},getRight:function(e){var a=0;return e.prevAll().addBack().each(function(){a+=t(this).outerWidth()}),a-1},getCellNum:function(t){return t.prevAll().addBack().size()},getColspan:function(t){return t.attr("colspan")||1},getStart:function(e){var a=1;return e.prevAll().each(function(){a+=parseInt(t(this).attr("colspan")||1)}),a},getPageCoord:function(t){for(var e={x:0,y:0};t;)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;return e},getOffset:function(e,a){if(!t.support.leadingWhitespace){var i=e.offset(),n={offsetX:a.pageX||a.screenX,offsetY:a.pageY||a.screenY},o={offsetX:n.offsetX-i.left,offsetY:n.offsetY-i.top};return o}var l=a.target;void 0==l.offsetLeft&&(l=l.parentNode);var s=this.getPageCoord(l),r={x:window.pageXOffset+a.clientX,y:window.pageYOffset+a.clientY},o={offsetX:r.x-s.x,offsetY:r.y-s.y};return o}}},a.prototype.resetWidth=function(){var e=this.$element,i=e.width(),n=e.find("table"),o=n&&n.width(),l=n.eq(0)&&n.eq(0).find("tr:first-child > th"),s=n.eq(1)&&n.eq(1).find("tr:first-child > td");if(n&&i-o<a.SCROLLW){var r=parseInt((i-o)/l.length);n.width(i-a.SCROLLW),l.each(function(e){var a=parseInt(t(this).css("width"));t(this).width(a+r),s.eq(e)&&s.eq(e).width(a+r)})}},a.prototype.init=function(){if(this.$element.isTag("table")){this.$container=this.$element.parent().addClass("bjui-resizeGrid"),this.$fixed=void 0;var t=this.$container.width(),e=this.options.height;this.$container.hasClass("tab-pane")&&(t=this.$container.parent().width()-20),"string"==typeof this.options.width&&this.options.width.indexOf("%")?this.options.newWidth=t*(this.options.width.replace("%","")/100):this.options.newWidth=parseInt(this.options.width),this.options.styles=[],this.$element.wrap('<div class="bjui-tablefixed clearfix"></div>'),this.$fixed=this.$element.parent(),this.initHead(),this.initBody(),this.resizeCol(),this.resizeGrid(),e&&!this.$fixed.closest(".tab-content").length&&this.$fixed.height(e).addClass("fixedH")}},a.prototype.initHead=function(){var e=this.options.styles=[],i=this.$element.find("thead > tr"),n=i.eq(0).find("> th"),o=(this.$element,0),l=[],s=[],r=-1;n.each(function(e){for(var a=t(this),i=parseInt(a.attr("colspan")||1),n=a.attr("width"),o=a.attr("align"),d="",c=0;c<i;c++)1==i&&n&&(d=' width="'+n+'"'),o&&a.removeAttr("align").addClass(o),l.push("<th"+d+"></th>");a.attr("colsNum",r+=i),s[e]=i});var d=l.length,c=t('<tr class="resize-head">'+l.join("")+"</tr>");if(i.length>1){r=0;var u=i.eq(1).find("> th");t.each(s,function(t,e){if((e=parseInt(e))>1)for(var a=parseInt(n.eq(t).attr("colsnum")),i=e-1;i>=0;i--){var o=u.eq(r++),l=a-i,s=o.attr("width"),d=o.attr("align"),h=c.find("> th").eq(l);o&&o.length&&o.attr("colsnum",l),s&&h.attr("width",s),d&&o.addClass(d).removeAttr("align")}})}this.$fixed.html(this.$element.html());var h=this.$fixed.find("thead");h.prepend(c),c.find("> th").each(function(a){var i=t(this),n=[],l=i.innerWidth();n[0]=parseInt(l),o+=n[0],e[e.length]=n}),o=parseInt((this.options.newWidth-a.SCROLLW-o)/d);var f=h.find("> tr:eq(0) > th");this.options.$ths=f,f.each(function(a){var i=t(this),n=e[a],l=i.attr("width");i.removeAttr("align").width(n[0]+o),n[0]=n[0]+o,l&&(n[0]=parseInt(l),i.width(l).removeAttr("width"))}),h.find("> tr:gt(0) > th").each(function(){var e=t(this);e.html('<div class="fixedtableCol">'+e.html()+"</div>")}),h.wrap('<div class="fixedtableHeader" style="width:'+(this.options.newWidth-a.SCROLLW)+'px;overflow:hidden;"><div class="fixedtableThead"><table class="table table-bordered" style="width:'+(this.options.newWidth-a.SCROLLW)+"px; max-width:"+(this.options.newWidth-a.SCROLLW)+'px;"></table></div></div>'),this.$fixed.append('<div class="resizeMarker" style="display:none; height:300px; left:57px;"></div><div class="resizeProxy" style="left:377px; display:none; height:300px;"></div>')},a.prototype.initBody=function(){var e,i,n=this,o=this.$fixed.find("> tbody");this.options.styles;if(this.options.height)i=this.options.height-this.$fixed.find(".fixedtableHeader").height()+"px";else{i="100%";var l=function(){var t=n.$fixed.parent().height();n.$fixed.parent().css("overflow","hidden"),n.$fixed.height(t).find(".fixedtableScroller").height(t-n.$fixed.find(".fixedtableHeader").height())};t(document).one(BJUI.eventType.afterInitUI,function(t){l()})}e='style="height:'+i+'; overflow-y:auto;"',o.wrap('<div class="fixedtableScroller"'+e+' style="width:'+this.options.newWidth+'px;"><div class="fixedtableTbody"><table style="width:'+(this.options.newWidth-a.SCROLLW)+"px; max-width:"+(this.options.newWidth-a.SCROLLW)+'px;"></table></div></div>'),this.$element.attr("class")?o.parent().addClass(this.$element.attr("class")):o.parent().addClass("table table-striped table-bordered table-hover"),void 0!==this.$element.attr("data-selected-multi")&&o.parent().attr("data-selected-multi",this.$element.attr("data-selected-multi")),o.before('<thead><tr class="resize-head">'+this.$fixed.find("thead > tr").html()+"</tr></thead>"),this.options.$tds=o.prev().find("> tr:first-child > th"),this.options.nowrap&&o.parent().addClass("nowrap"),o.closest(".fixedtableScroller").scroll(function(e){var a=t(this),i=a.scrollLeft();return a.prev().find("> .fixedtableThead").css({position:"relative",left:-i}),!1})},a.prototype.resizeCol=function(){var e=this,i=this.$fixed,n=this.options.$ths,o=this.options.$tds,l=this.tools;i.find("thead > tr:gt(0) > th").each(function(s){var r=t(this);r.mouseover(function(t){var s=parseInt(i.find(".fixedtableThead").css("left"))||0,d=l.getOffset(r,t).offsetX,c=n.eq(r.attr("colsnum"));return r.outerWidth()-d<5?r.css("cursor","col-resize").off("mousedown.bjui.tablefixed.resize").on("mousedown.bjui.tablefixed.resize",function(t){i.find("> .resizeProxy").show().css({left:l.getRight(c)+s+i.position().left,top:i.position().top,height:i.height(),cursor:"col-resize"}).basedrag({scop:!0,cellMinW:20,relObj:i.find(".resizeMarker"),move:"horizontal",event:t,stop:function(){var t=i.find(".resizeProxy").position().left,n=i.find(".resizeMarker").position().left,s=t-n-c.outerWidth()-9,r=l.getCellNum(c),d=(c.width(),c.width()+s),u=o.eq(r-1),h=i.find("> .fixedtableHeader .table").width();if(c.width(d),u.width(d),i.find(".table").width(h+s),i.find(".resizeMarker, .resizeProxy").hide(),h+s+a.SCROLLW<e.options.newWidth)i.find(".fixedtableScroller").width(h+s+a.SCROLLW);else{var d=i.closest(".bjui-resizeGrid").innerWidth();h+s+a.SCROLLW<d&&(d=h+s+a.SCROLLW),i.find(".fixedtableHeader").width(d-a.SCROLLW),i.find(".fixedtableScroller").width(d),i.width(d)}i.data("resizeGrid",!0)}}),i.find("> .resizeMarker").show().css({left:l.getLeft(c)+s+i.position().left,top:i.position().top,height:i.height()})}):r.css("cursor","default").off("mousedown.bjui.tablefixed.resize"),!1})})},a.prototype.setOrderBy=function(e){var a=this.$element,i=a.find(".fixedtableCol"),n=t(BJUI.doRegional(FRAG.orderby,BJUI.regional.orderby));e=e||this.options,a.addClass("orderby"),e.orderDirection&&(BJUI.ui.clientPaging||a.addClass(e.orderDirection),a.pagination("setClientOrder",{orderField:e.orderField,orderDirection:e.orderDirection})),i.length||(i=t('<div class="fixedtableCol">'+a.html()+"</div>").appendTo(a.empty())),n.data("orderField",e.orderField).appendTo(i).pagination("orderBy")},a.prototype.resizeGrid=function(){var e=this,i=function(){t("div.bjui-resizeGrid").each(function(){var i,n=t(this),o=n.width(),l=n.height(),s=n.find(".bjui-tablefixed"),r=s.find(".fixedtableThead").height(),d=e.options.newWidth;o&&n.find(".bjui-tablefixed").each(function(){var e=t(this);i=e.data("resizeGrid")?d:o,e.width(i),e.find(".table").width(i-a.SCROLLW),e.find(".fixedtableHeader").width(i-a.SCROLLW),e.find(".fixedtableScroller").width(i)}),n.css("overflow","hidden"),s.height(l).find(".fixedtableScroller").height(l-r)})};t(window).on(BJUI.eventType.resizeGrid,i)};var i=t.fn.tablefixed;t.fn.tablefixed=e,t.fn.tablefixed.Constructor=a,t.fn.tablefixed.noConflict=function(){return t.fn.tablefixed=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('table[data-toggle="tablefixed"]');i.length&&e.call(i)}),t(document).on(BJUI.eventType.afterInitUI,function(a){var i=t(a.target).find("th[data-order-field]");i.length&&e.call(i,"setOrderBy")}),t(document).on("click.bjui.tr.data-api","tr[data-id]",function(e){var a=t(this),i=a.closest("table"),n=i.data("selectedMulti"),o=a.attr("data-id"),l=i.closest(".unitBox").find("#bjui-selected");a.toggleClass("selected"),n?(o=[],a.siblings(".selected").add(a.hasClass("selected")?a:"").each(function(){o.push(t(this).attr("data-id"))}),o=o.join(",")):(a.siblings().removeClass("selected"),a.hasClass("selected")||(o="")),l&&l.length?l.val(o):(l=t('<input type="hidden" id="bjui-selected" value="'+o+'">'),l.appendTo(i.closest(".unitBox")))})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.tabledit");s||o.data("bjui.tabledit",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$tbody=this.$element.find("> tbody"),this.$tbody.length||(this.$tbody=t("<tbody></tbody>"),this.$element.append(this.$tbody)),this.$numAdd=this.$btnAdd=null};a.DEFAULTS={singleNoindex:!0},a.EVENTS={afterDelete:"afterdelete.bjui.tabledit"},a.prototype.TOOLS=function(){var e=this;return{initSuffix:function(e){e.find("> tr").each(function(e){t(this).find(":input, :file, a, label, div").each(function(){var a=t(this),i=a.attr("name"),n=a.val(),o=a.attr("for"),l=a.attr("id"),s=a.attr("href"),r=a.attr("data-group"),d=a.attr("data-suffix");if(i&&a.attr("name",i.replaceSuffix(e)),o&&a.attr("for",o.replaceSuffix(e)),l&&a.attr("id",l.replaceSuffix(e).replaceSuffix2(e)),s&&a.attr("href",s.replaceSuffix(e)),r&&a.attr("data-group",r.replaceSuffix(e)),d&&a.attr("data-suffix",d.replaceSuffix(e)),n&&n.indexOf("#index#")>=0&&a.val(n.replace("#index#",e+1)),a.hasClass("no")){var c=a.data("prefix")?a.data("prefix"):"";a.val(c+(e+1))}})})},initEnter:function(e){var a=e.find(":text");a.each(function(e){t(this).bind("keydown",function(t){if(t.which==BJUI.keyCode.ENTER){var i=e+1;a.eq(i)&&a.eq(i).focus(),t.preventDefault()}})}),this.initInput(e)},initInput:function(e){e.find("> tr > td").each(function(){var e=t(this).find(".input-hold");e.length||(e=t('<span class="input-hold" style="display:block; padding:0 4px; height:0px; font-size:12px; visibility:hidden;"></span>'),t(this).append(e)),t.support.leadingWhitespace?t(this).on("input",":text",function(a){e.text(t(this).val())}):t(this).on("propertychange",":text",function(a){e.text(t(this).val())})})},initTbody:function(){function a(e){e.removeClass("readonly").find("> td *").each(function(){var e=t(this),a=e.closest("td"),i=a.data("val"),n=e.attr("data-toggle-old"),o=a.data("readonly");if(void 0===i&&(i=a.html()),a.data("notread"))return!0;if(e.isTag("select")&&e.val(a.attr("data-val")).selectpicker("refresh").nextAll(".bootstrap-select").removeClass("readonly").find("button").removeClass("disabled"),e.is(":checkbox")&&(e.closest(".icheckbox_minimal-purple").removeClass("disabled"),e.closest(".icheckbox_minimal-purple").find("ins").removeClass("readonly")),e.is(":radio")&&(e.closest(".iradio_minimal-purple").removeClass("disabled"),e.closest(".iradio_minimal-purple").find("ins").removeClass("readonly")),n){if("dosave"==n)return!0;e.removeAttr("data-toggle-old").attr("data-toggle",n),"spinner"==n&&e.spinner("destroy").spinner()}(e.is(":text")||e.is("textarea"))&&(e.off("keydown.readonly"),o&&e.prop("readonly",!0)),e.find(".bjui-lookup, .bjui-spinner, .bjui-upload").show()}),e.find('[data-toggle="doedit"]').attr("data-toggle","dosave").text("完成")}function i(e){e.addClass("readonly").find("> td *").each(function(){var e=t(this),a=e.closest("td"),i=e.attr("data-toggle");if(a.data("notread"))return!0;if(e.isTag("select")&&e.nextAll(".bootstrap-select").addClass("readonly").find("button").addClass("disabled"),e.is(":checkbox")&&(e.closest(".icheckbox_minimal-purple").addClass("disabled"),e.closest(".icheckbox_minimal-purple").find("ins").addClass("readonly")),e.is(":radio")&&(e.closest(".iradio_minimal-purple").addClass("disabled"),e.closest(".iradio_minimal-purple").find("ins").addClass("readonly")),i){if("doedit"==i||"dosave"==i)return!0;e.removeAttr("data-toggle").attr("data-toggle-old",i)}(e.is(":text")||e.is("textarea"))&&e.on("keydown.readonly",function(t){t.preventDefault()}),e.find(".bjui-lookup, .bjui-spinner, .bjui-upload").hide()}),e.find('[data-toggle="dosave"]').attr("data-toggle","doedit").text("编辑")}var n=e.$element,o=e.$tbody;o.find("> tr").each(function(){var l=t(this),s=l.find("> td"),r=n.data("bjui.tabledit.tr").clone().find("> th");l.data("bjui.tabledit.oldTds",l.html()),r.each(function(e){var a=s.eq(e),i=a.data("val"),n=t(this),o=n.children(),l=n.find(".pic-box");void 0===i&&(i=a.html()),a.data("noedit")||o.length&&(o.is("input:checkbox")||o.is("input:radio")?o.filter('[value="'+i+'"]').attr("checked","checked"):o.isTag("select")?o.find('option[value="'+a.data("val")+'"]').attr("selected","selected"):l.length?(a.data("val")&&n.find(".pic-name").val(a.data("val")),l.html(a.html())):o.hasClass("wrap_bjui_btn_box")?o.find("input[data-toggle]").attr("value",i+""):o.is("textarea")?o.html(i):o.attr("value",i+""),a.html(n.html()))}),l.on("dblclick",t.proxy(function(t){a(l)},e)).initui(),e.tools.initSuffix(o),i(l)}),o.on("click.bjui.tabledit.readonly",'[data-toggle="doedit"]',function(e){a(t(this).closest("tr"))}).on("click.bjui.tabledit.readonly",'[data-toggle="dosave"]',function(a){var o=t(this).closest("tr"),l=o.index(),s=e.options.callback;if(e.options.action){if(o.wrap('<form action="" method="POST"></form>'),o.attr("data-id")){var r=n.find("> thead > tr:eq(0)").data("idname")||"id";o.before('<input type="hidden" name="'+r.replaceSuffix(l)+'" value="'+o.attr("data-id")+'">')}var d=o.parent().serializeArray();e.options.singleNoindex&&t.each(d,function(e,a){t.extend(a,{name:a.name.replaceSuffix(0)})}),o.prev("input").remove(),o.unwrap().isValid(function(t){t&&(s=s?s.toFunc():function(t){t[BJUI.keys.statusCode]==BJUI.statusCode.ok?i(o):o.bjuiajax("ajaxDone",t)},o.bjuiajax("doAjax",{url:e.options.action,data:d,type:e.options.type||"POST",callback:s}))})}else i(o)}),e.tools.initEnter(o)},doAdd:function(){var t=e.$element;e.$numAdd&&e.$btnAdd&&t.on("keydown.bjui.tabledit.add","thead .num-add",function(t){t.which==BJUI.keyCode.ENTER&&(e.$btnAdd.trigger("click.bjui.tabledit.add"),t.preventDefault())}).on("click.bjui.tabledit.add","thead .row-add",function(a){var i=1;isNaN(e.$numAdd.val())||(i=parseInt(e.$numAdd.val())),e.add(t,i),a.preventDefault()})},doDel:function(e){var a=this;e.off("click.bjui.tabledit.del").on("click.bjui.tabledit.del",".row-del",function(e){var i=t(this);i.data("confirmMsg")?i.alertmsg("confirm",i.data("confirmMsg"),{okCall:function(){a.delData(i)}}):a.delData(i),e.preventDefault()})},delData:function(t){var a=this,i=t.closest("tbody"),n=t.data(),o=function(o){t.closest("tr").remove(),a.initSuffix(i),a.afterDelete(i),n.callback&&n.callback.toFunc().apply(e,[o])};t.is("[href^=javascript:]")||t.is('[href^="#"]')?o():t.bjuiajax("doAjax",{url:t.attr("href"),data:n.data,callback:o})},afterDelete:function(i){var n=t.Event(a.EVENTS.afterDelete,{relatedTarget:i[0]});e.$element.trigger(n),n.isDefaultPrevented()}}},a.prototype.init=function(){var e=this,a=this.tools,i=this.$element.addClass("bjui-tabledit"),n=i.find("> thead > tr:first"),o=this.$tbody,l=i.find("> thead > tr:first").html();n.find("> th").each(function(){var a=t(this),i=a.attr("title"),n=a.data("addtool");if(i&&a.html(i),n){var o=t('<span style="position:relative;"></span>');a.empty(),e.$numAdd=t('<input type="text" value="1" class="form-control num-add" size="2" title="待添加的行数">'),e.$btnAdd=t('<a href="javascript:;" class="row-add" title="添加行"><i class="fa fa-plus-square"></i></a>'),o.append(e.$numAdd).append(e.$btnAdd).appendTo(a)}}),i.data("bjui.tabledit.tr",t("<tr>"+l+"</tr>")),a.initTbody(),a.doAdd(),a.doDel(o)},a.prototype.add=function(e,a){for(var i,n=this.tools,o=e.find("> tbody"),l=e.data("bjui.tabledit.tr"),s=0;s<a;s++){l.find("> th").each(function(){t(this).replaceWith("<td>"+t(this).html()+"</td>")});var r=l.clone();s||(i=r),r.hide().appendTo(o),n.initSuffix(o),n.initEnter(o),r.show().css("display","").initui()}if(i&&i.length){i.find(":text").each(function(){var e=t(this);if(!e.prop("readonly"))return e.focus(),!1})}};var i=t.fn.tabledit;t.fn.tabledit=e,t.fn.tabledit.Constructor=a,t.fn.tabledit.noConflict=function(){return t.fn.tabledit=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('table[data-toggle="tabledit"]');i.length&&e.call(i)}),t(document).on(BJUI.eventType.afterInitUI,function(a){t(a.target).find('table[data-toggle="tabledit"]').each(function(){if(t(this).is("[data-initnum]")){var a=t(this).data("initnum");a>0&&e.call(t(this),"add",t(this),a)}})}),t(document).on("click.bjui.tabledit.data-api",'[data-toggle="tableditadd"]',function(a){var i=t(this),n=i.data("num")||1,o=i.data("target");o&&t(o).length&&t(o).isTag("table")&&(e.call(i,"add",t(o),n),a.preventDefault())})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.spinner");s||o.data("bjui.spinner",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS(),this.$spinner=null,this.height=this.$element.addClass("form-control").innerHeight(),this.ivalue=Number(this.$element.val())||0};a.DEFAULTS={min:0,max:100,step:1,decimalPlace:0},a.EVENTS={afterChange:"afterchange.bjui.spinner"},a.prototype.TOOLS=function(){var t=this;return{changeVal:function(e){var i=t.$element,n=Number(i.val())||Number(t.ivalue),o=e.data("add")||-1,l=t.options.min,s=t.options.max,r=t.options.step;1==o?n<=s-r&&(n+=r):-1==o?n>=l+r&&(n-=r):n>s?n=s:n<l&&(n=l),t.options.decimalPlace&&(n=new String(n.toFixed(t.options.decimalPlace))),t.ivalue=n,i.val(n).trigger(a.EVENTS.afterChange,{value:n})}}},a.prototype.init=function(){this.$element,this.options;if(isNaN(this.options.min)||isNaN(this.options.max)||isNaN(this.options.step))return void BJUI.debug("Spinner Plugin: Parameter is non-numeric type!");this.addBtn()},a.prototype.addBtn=function(){var e=this,a=e.$element;if(!this.$lookBtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$spinner=t(FRAG.spinnerBtn),a.css({paddingRight:"13px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var i=a.parent();i.css("position","relative"),this.$spinner.css({height:this.height}).appendTo(i),this.$spinner.on("selectstart",function(){return!1});var n=null;e.$spinner.find("li").on("click",function(a){e.tools.changeVal(t(this))}).on("mousedown",function(){var a=t(this);n=setInterval(function(){e.tools.changeVal(a)},150)}).on("mouseup",function(){clearTimeout(n)})}},a.prototype.destroy=function(){this.$element.parent().hasClass("wrap_bjui_btn_box")&&(this.$element.parent().find(".bjui-spinner").remove(),this.$element.unwrap())};var i=t.fn.spinner;t.fn.spinner=e,t.fn.spinner.Constructor=a,t.fn.spinner.noConflict=function(){return t.fn.spinner=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('input[data-toggle="spinner"]');i.length&&e.call(i)})}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var n=t(this),l=t.extend({},o.DEFAULTS,n.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=n.data("bjui.lookup");s?n.data("newurl")&&(s.options.url=n.data("newurl"),n.data("bjui.dialog",null)):n.data("bjui.lookup",s=new o(this,l)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.init()})}var a,i,n,o=function(e,a){this.$element=t(e),this.options=a,this.$lookBtn=null};o.DEFAULTS={url:null,id:null,mask:!0,width:600,height:400,title:"Lookup",maxable:!0,resizable:!0},o.EVENTS={afterChange:"afterchange.bjui.lookup"},o.prototype.init=function(){var t=this,e=this.options;this.tools;return e.url?(e.url=decodeURI(e.url).replacePlh(t.$element.closest(".unitBox")),e.url.isFinishedTm()?(e.url=encodeURI(e.url),a=this.options.group||null,i=this.options.suffix||null,n=this.$element,i&&(i=i.trim()),void this.open(t.$element)):(t.$element.alertmsg("error",e.warn||BJUI.regional.plhmsg),BJUI.debug("Lookup Plugin: The lookup's url is incorrect, url:"+e.url),!1)):(BJUI.debug("Lookup Plugin: Error trying open a lookup dialog, url is undefined!"),!1)},o.prototype.addBtn=function(){var e=this,a=e.$element;if(!this.$lookBtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$lookBtn=t(FRAG.lookupBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var i=this.$element.parent(),n=this.$element.addClass("form-control").innerHeight();i.css({position:"relative",display:"inline-block"}),t.each(e.options,function(t,a){"toggle"!=t&&e.$lookBtn.data(t,a)}),this.$lookBtn.css({height:n,lineHeight:n+"px"}).appendTo(i),this.$lookBtn.on("selectstart",function(){return!1})}},o.prototype.open=function(t){var e=this.options;t.dialog({id:e.id||"lookup_dialog",url:e.url,title:e.title,width:e.width,height:e.height,mask:e.mask,maxable:e.maxable,resizable:e.resizable})},o.prototype.getField=function(t){return(a?a+".":"")+t+(i||"")},o.prototype.setSingle=function(t,e){"string"==typeof t&&(t=new Function("return "+t)()),this.setVal(t,e)},o.prototype.setMult=function(e,a){var i={};if(this.$element.closest(".unitBox").find('[name="'+e+'"]').filter(":checked").each(function(){var e=new Function("return "+t(this).val())();for(var a in e){var n=i[a]?i[a]+",":"";i[a]=n+e[a]}}),t.isEmptyObject(i))return void this.$element.alertmsg("error",this.$element.data("warn")||BJUI.regional.selectmsg);this.setVal(i,a)},o.prototype.setVal=function(e,a){var i,l=this,s=n.closest(".unitBox");n.data("customEvent")?n.trigger("customEvent.bjui.lookup",[e]):s.find(":input").each(function(){var n=t(this),s=n.attr("name");for(var r in e){if(l.getField(r)==s){i=1==a&&n.val()?n.val()+","+e[r]:e[r],n.val(i).trigger(o.EVENTS.afterChange,{value:e[r]});break}}}),this.$element.dialog("closeCurrent")};var l=t.fn.lookup;t.fn.lookup=e,t.fn.lookup.Constructor=o,t.fn.lookup.noConflict=function(){return t.fn.lookup=l,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('[data-toggle="lookup"]');i.length&&e.call(i,"addBtn")}),t(document).on("click.bjui.lookup.data-api",'[data-toggle="lookupbtn"]',function(a){var i=t(this);i.attr("href")&&!i.data("url")&&i.attr("data-url",i.attr("href")),i.data("title")||i.attr("data-title",i.text()),e.call(i),a.preventDefault()}),t(document).on("click.bjui.lookupback.data-api",'[data-toggle="lookupback"]',function(a){var i=t(this),n=i.data("args"),o=i.data("lookupid"),l=t('input[name="lookupType"]:checked').val();n?e.call(i,"setSingle",n,l):o&&e.call(i,"setMult",o,l),a.preventDefault()})}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var n,o=(t(this),{});t.extend(!0,o,h.DEFAULTS,"object"===(void 0===e?"undefined":_typeof(e))&&e),n=new h(this,o),"string"==typeof i&&t.isFunction(n[i])?([].shift.apply(a),a?n[i].apply(n,a):n[i]()):n.init()})}var a,i,n,o,l,s,r,d,c,u,h=function(e,a){this.$element=t(e),this.options=a,this.$findBtn=null};h.DEFAULTS={pk:null,oldData:null,group:null,suffix:null,include:null,exclude:null,multiple:!1,append:!1,empty:!0,dialogOptions:{id:null,mask:!0,width:600,height:400,title:"FindGrid",maxable:!0,resizable:!0},gridOptions:{width:"100%",height:"100%",columnMenu:!1,sortAll:!0,filterAll:!0,fullGrid:!0},context:null,onSelect:null},h.EVENTS={afterChange:"afterchange.bjui.findgrid"},h.getField=function(t){return(a?a+".":"")+t+(i||"")},h.empty=function(){if(!o)return void BJUI.debug("FindGrid Plugin: No set options 'include' !");for(var t=this,e=o.split(","),a=c.find(":text, :input:hidden, textarea, select"),i={},n=0;n<e.length;n++){var l,s,r=e[n].split(":");2==r.length?(s=r[0].trim(),l=r[1].trim()):(s=e[n].trim(),l=s),i[t.getField(s)]=!0}for(l in i)a.filter('[name="'+l+'"]').val("").trigger(h.EVENTS.afterChange,{value:"",data:""})},h.setSingle=function(e){var a=this,i=function(t,i,n){a.getField(i)==t.attr("name")&&(t.val(n).trigger(h.EVENTS.afterChange,{value:n,data:e}),t.isTag("select")&&t.data("toggle")&&"selectpicker"===t.data("toggle")&&t.selectpicker("refresh"))};c.find("input:text, input:hidden, textarea, select").each(function(){var a,n=t(this),s=[];if(o)for(var r=o.split(","),d=0;d<r.length;d++){var c,u=r[d].split(":");2==u.length?(a=u[0].trim(),c=u[1].trim()):(a=r[d].trim(),c=a),void 0!==e[c]&&i(n,a,e[c])}else for(var c in e)l&&(t.each(l.split(","),function(t,e){s.push(e.trim())}),-1!=t.inArray(c,s))||i(n,c,e[c])})},h.setMult=function(e){
if("function"==typeof d)return void d.call(f,a.data);var a,i,f=this,p=t("#"+e).data("selectedDatas"),g=function(t){t.isTag("select")&&t.data("toggle")&&"selectpicker"===t.data("toggle")&&t.selectpicker("refresh")};if(p&&p.length){var m,b,v=c.find("input:text, input:hidden, textarea, select"),y={},x={},k=[];if(!s&&r&&(r=[]),o)for(var C=o.split(","),j=0;j<C.length;j++){var w,$=C[j].split(":");2==$.length?(m=$[0].trim(),w=$[1].trim()):(m=C[j].trim(),w=m),y[f.getField(m)]=w}else for(var w in p[0])l?(t.each(l.split(","),function(t,e){k.push(e.trim())}),-1===t.inArray(w,k)&&(y[f.getField(w)]=w)):y[f.getField(w)]=w;v=t(t.map(v,function(e){var a=t(e),i=a.attr("name");return i&&y[i]?(x[i]=y[i],e):null}));for(var T=0;T<p.length;T++)a=p[T],r&&-1!=t.inArray(a[n],r)||v.each(function(e){var o=t(this),l=o.attr("name"),d=o.val();i||(i=new Array),i[e]||(i[e]=[]),s?d&&(i[e].push(d),o.isTag("select")&&o.prop("multiple")&&(i[e]="array"===t.type(d)?d:[])):(o.val(""),g(o)),i[e].push(a[x[l]]),r&&-1===t.inArray(a[n],r)&&r.push(a[n])});i&&v.each(function(e){var a=t(this);b=i[e].join(","),a.isTag("select")&&a.prop("multiple")&&(b=i[e]),a.val(b).trigger(h.EVENTS.afterChange,{value:b,data:p}),u.data("oldData",r),g(a)}),BJUI.dialog("closeCurrent")}},h.prototype.init=function(){var e=this,s=this.options;s.gridOptions,this.tools;a=s.group||null,i=s.suffix||null,u=e.$element,r=s.oldData,n=s.pk||null,o=s.include||null,l=s.exclude||null,s.context&&(c=s.context instanceof jQuery?s.context:t(s.context)),c&&c.length||(c=e.$element.closest(".unitBox")),i&&(i=i.trim()),n?u.data("oldData")?r=u.data("oldData"):void 0!==r?"string"==typeof r?r=r.split(","):t.isArray(r)||(r=[]):r=[]:r=null,this.open(e.$element)},h.prototype.addBtn=function(){var e=this,a=e.$element,i=a.data("bjui.findgrid.options");if(!this.$findBtn&&!a.parent().hasClass("wrap_bjui_btn_box")){this.$findBtn=t(FRAG.findgridBtn),this.$element.css({paddingRight:"15px"}).wrap('<span class="wrap_bjui_btn_box"></span>');var n=this.$element.parent(),o=this.$element.addClass("form-control").innerHeight();n.css({position:"relative",display:"inline-block"}),delete i.toggle,e.$findBtn.data("bjui.findgrid.options",i),this.$findBtn.css({height:o,lineHeight:o+"px"}).appendTo(n),this.$findBtn.on("selectstart",function(){return!1})}},h.prototype.open=function(e){var a=this,i=this.options,o=i.dialogOptions,l=i.gridOptions,c=(new Date).getTime();o.id||(o.id="dialog_findgrid_"+c),i.gridId||(i.gridId="datagrid_findgrid_"+c),l.showToolbar=!0,i.empty&&(l.toolbarCustom||(l.toolbarCustom="")),i.multiple&&(void 0===l.showCheckboxcol&&(l.showCheckboxcol=!0),l.toolbarCustom||(l.toolbarCustom=""),l.selectMult=!0,l.toolbarCustom+='　<button type="button" class="btn-blue" onclick="$.fn.findgrid.Constructor.setMult(\''+i.gridId+"')\">"+BJUI.getRegional("findgrid.choose")+"</button>",l.toolbarCustom+='　<label class="ilabel"><input type="checkbox" data-toggle="icheck" id="checkbox_findgrid_'+c+'" '+(i.append?"checked":"")+">&nbsp;"+BJUI.getRegional("findgrid.append")+"</label>",i.append&&(s=!0)),i.empty&&(l.toolbarCustom+='　<button type="button" class="btn-orange" onclick="$.fn.findgrid.Constructor.empty(\''+i.gridId+"')\">"+BJUI.getRegional("findgrid.empty")+"</button>"),delete o.url,delete o.target,i.onSelect?"string"==typeof(d=i.onSelect)&&(d=d.toFunc()):d=null,o.html='<div class="bjui-pageContent tableContent"><table id="'+i.gridId+'"></table></div>',o.onLoad=function(e){var o="#"+i.gridId,u=t(o);u.datagrid(l),t.isArray(r)&&r.length&&n&&t(document).on("afterLoad.bjui.datagrid",o,function(e,a){a.datas&&t.each(a.datas,function(e,a){a[n]&&"-1"!=t.inArray(a[n],r)&&u.datagrid("selectedRows",e,!0)})}),i.multiple||t(document).on("clicked.bjui.datagrid.tr",o,function(t,e){"function"==typeof d?d.call(a,e.data):(h.setSingle(e.data),BJUI.dialog("closeCurrent"))}),t(document).on("ifChanged","#checkbox_findgrid_"+c,function(e){s=t(this).is(":checked")})},BJUI.dialog(o)};var f=t.fn.findgrid;t.fn.findgrid=e,t.fn.findgrid.Constructor=h,t.fn.findgrid.noConflict=function(){return t.fn.findgrid=f,this},t(document).on(BJUI.eventType.initUI,function(a){t(a.target).find('input[data-toggle="findgrid"]').each(function(){var a=t(this),i=a.data(),n=i.options;n&&("string"==typeof n&&(n=n.trim().startsWith("{")?n.toObj():n.toFunc()),"function"==typeof n&&(n=n.apply()),"object"===(void 0===n?"undefined":_typeof(n))&&(delete i.options,t.extend(i,n))),a.data("bjui.findgrid.options",i),e.call(a,"addBtn")})}),t(document).on("click.bjui.findgrid.data-api",'[data-toggle="findgridbtn"]',function(a){var i=t(this),n=i.data("bjui.findgrid.options");if(!n){var o=i.data(),l=o.options;l&&("string"==typeof l&&(l=l.trim().startsWith("{")?l.toObj():l.toFunc()),"function"==typeof l&&(l=l.apply()),"object"===(void 0===l?"undefined":_typeof(l))&&(delete o.options,t.extend(o,l))),n=o}delete n["bjui.findgrid.options"],e.call(i,n),a.preventDefault()})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.tags");s||o.data("bjui.tags",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e).addClass("tag-input"),this.options=a,this.tools=this.TOOLS(),this.$box=t(this.$element.wrap('<div class="bjui-tags"></div>')).parent(),this.timeout=null,this.$tagsArr={},this.tags=[]};a.DEFAULTS={width:300,url:"",global:!1,type:"GET",tagname:"tag",max:0,clear:!1,lightCls:"tags-highlight"},a.EVENTS={afterCreated:"aftercreated.bjui.tags"},a.prototype.TOOLS=function(){var e=this,i=this.options;t(e.$element).val();return{keyDown:function(t){if(13==t.which)return!1},keyUp:function(a){switch(a.which){case BJUI.keyCode.BACKSPACE:if(!t.trim(e.$element.val()).length)return e.tools.removeMenu(),!1;break;case BJUI.keyCode.ESC:e.tools.removeMenu();break;case BJUI.keyCode.DOWN:if(!e.$menu||!e.$menu.length)return;var n=e.$menu.find("> ."+i.lightCls),o=e.$menu.find("> li:first-child");if(n.length){var l=n.removeClass(i.lightCls).next();l.length?l.addClass(i.lightCls):o.addClass(i.lightCls)}else o.addClass(i.lightCls);return!1;case BJUI.keyCode.UP:if(!e.$menu||!e.$menu.length)return;var n=e.$menu.find("> ."+i.lightCls),s=e.$menu.find("> li:last-child");if(n.length){var r=n.removeClass(i.lightCls).prev();r.length?r.addClass(i.lightCls):s.addClass(i.lightCls)}else s.addClass(i.lightCls);return!1;case BJUI.keyCode.ENTER:if(i.max>0&&e.$tagsArr.length>=i.max)return!1;var d=!1,c=!1,u=null,h=e.$menu&&e.$menu.find("> ."+i.lightCls);if(h&&h.length)d=h.text(),u=h.data("item"),c=u.value;else{if(d=t.trim(e.$element.val()),!d.length)return!1;if(i.clear&&-1==t.inArray(d,e.tags))return e.$element.val(""),!1;c=d}if(!d)return;var f=!1;return console.log(e),(e.$tagsArr.length&&e.$tagsArr.each(function(){if(t(this).val()==c)return void(f=!0)}),f)?(e.$element.val(""),!1):(e.tools.createTag(d,c),e.tools.removeMenu(),e.$element.val(""),t.proxy(e.tools.onAfterCreated(u,c),e),!1)}},query:function(){e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout(e.tools.doQuery,300)},doQuery:function(){if(!(i.max>0&&e.$tagsArr.length>=i.max)){var a=e.$element.val(),n=e.$box.find("> .tags-menu"),o=[],l=null,s=e.$element.closest(".navtab-panel").length?t.CurrentNavtab:t.CurrentDialog;e.$element.closest(".bjui-layout").length&&(s=e.$element.closest(".bjui-layout")),a.length&&(e.$element.one("ajaxStart",function(){s.trigger("bjui.ajaxStart")}).one("ajaxStop",function(){s.trigger("bjui.ajaxStop")}),t.ajax({url:i.url,global:i.global,type:i.type,data:{term:a},dataType:"json",success:function(a){if(0!=a.length){n.length||(n=t('<ul class="tags-menu"></ul>')),n.empty().hide().appendTo(e.$box);for(var s=0;s<a.length;s++)l=t('<li class="tags-item">'+a[s].label+"</li>").data("item",a[s]),l.appendTo(n),o.push(a[s].label);e.tags=o,n.css({top:e.$element.position().top+e.$element.outerHeight(),left:e.$element.position().left}).fadeIn().find("> li").hover(function(){t(this).addClass(i.lightCls).siblings().removeClass(i.lightCls)},function(){t(this).removeClass(i.lightCls)}).click(function(){var a=t(this).text(),i=t(this).data("item"),o=i.value,l=!1;if(e.$box.find("input:hidden").each(function(){if(t(this).val()==o)return void(l=!0)}),l)return e.$element.val(""),void n.remove();t.proxy(e.tools.createTag(a,o),e),n.remove(),e.$element.val(""),t.proxy(e.tools.onAfterCreated(i,o),e)}),e.$menu=n}}}))}},createTag:function(a,i){var n=t('<span class="label label-tag" data-value="'+i+'" style="margin-left: 1px; margin-top: 1px;"><i class="fa fa-tag"></i> '+a+'&nbsp;&nbsp;<a href="#" class="close">&times;</a></span>');n.insertBefore(e.$element).find("a.close").click(function(){var a=n.data("value");e.$box.find("input:hidden").each(function(){t(this).val()==a&&t(this).remove()}),n.remove(),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')}),t('<input type="hidden" name="'+e.options.tagname+'">').val(i).appendTo(e.$box),e.$tagsArr=e.$box.find('input[name="'+e.options.tagname+'"]')},removeMenu:function(){e.$menu&&e.$menu.remove()},onAfterCreated:function(i,n){var o=[];e.$tagsArr.length&&e.$tagsArr.each(function(){o.push(t(this).val())}),e.$element.trigger(a.EVENTS.afterCreated,{item:i,value:n,tags:o.join(",")})}}},a.prototype.init=function(){var e=this,a=this.$element,i=this.options;if(!i.url)return void BJUI.debug("Tags Plugin: Do query tags, url is undefined!");if(i.url=decodeURI(i.url).replacePlh(a.closest(".unitBox")),!i.url.isFinishedTm())return a.alertmsg("error",i.warn||BJUI.regional.plhmsg),void BJUI.debug("Tags Plugin: The query tags url is incorrect, url: "+i.url);if(i.url=encodeURI(i.url),isNaN(this.options.max))return void BJUI.debug("Tags Plugin: Parameter 'max' is non-numeric type!");var n=a.val();if(n){var n=n.split(/,|\||\s/);t.each(n,function(t,a){e.tools.createTag(a,a)}),a.val("")}e.$box.width(i.width).on("click",function(){a.focus()}),a.on("keydown",t.proxy(this.tools.keyDown,this)).on("keyup",t.proxy(this.tools.keyUp,this)),t.support.leadingWhitespace?a.on("input",t.proxy(this.tools.query,this)):a.on("propertychange",t.proxy(this.tools.query,this)),t(document).on("click.bjui.tags",t.proxy(function(e){t(e.target).closest(this.$box).length||this.tools.removeMenu()},this))},a.prototype.destroy=function(){this.$tags&&(this.$element.upwrap(),$tags.remove())};var i=t.fn.tags;t.fn.tags=e,t.fn.tags.Constructor=a,t.fn.tags.noConflict=function(){return t.fn.tags=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('input[data-toggle="tags"]');i.length&&e.call(i)})}(jQuery),function(t){function e(e){var i=arguments,n=e;if(window.FileReader)return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.upload");s||o.data("bjui.upload",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()});this.each(function(){if(t.fn.uploadify){var e={swf:BJUI.PLUGINPATH+"uploadify/scripts/uploadify.swf",fileTypeExts:"*.jpg;*.png",id:"fileInput",fileObjName:"file",fileSizeLimit:204800,buttonText:"选择上传文件",auto:!1,multi:!1,height:24},a=t(this),i=a.data();if(i.id||(i.id=a.attr("id")),t.extend(e,i),!e.uploader)return void BJUI.debug("Upload Plugin: The options uploader is undefined!");if(e.uploader=decodeURI(e.uploader).replacePlh(a.closest(".unitBox")),!e.uploader.isFinishedTm())return a.alertmsg("error",e.warn||BJUI.regional.plhmsg),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+e.uploader);e.uploader=encodeURI(e.uploader),"fileInput"==e.id&&(e.id=e.id+(new Date).getTime());var n=t('<input type="file" name="'+e.name+'" id="'+e.id+'">');if(e.onInit&&"string"==typeof e.onInit&&(e.onInit=e.onInit.toFunc()),e.onCancel&&"string"==typeof e.onCancel&&(e.onCancel=e.onCancel.toFunc()),e.onSelect&&"string"==typeof e.onSelect&&(e.onSelect=e.onSelect.toFunc()),e.onUploadSuccess&&"string"==typeof e.onUploadSuccess&&(e.onUploadSuccess=e.onUploadSuccess.toFunc()),e.onUploadComplete&&"string"==typeof e.onUploadComplete&&(e.onUploadComplete=e.onUploadComplete.toFunc()),e.onUploadError&&"string"==typeof e.onUploadError&&(e.onUploadError=e.onUploadError.toFunc()),n.appendTo(a),!e.auto){var o=t('<button class="btn btn-orange" data-icon="cloud-upload">开始上传</button>');o.hide().insertAfter(a).click(function(){n.uploadify("upload","*"),t(this).hide()}),e.onSelect=function(){o.show()}}n.uploadify(e)}})}var a=function(e,a){this.$element=t(e),this.options=a,this.tools=this.TOOLS()};a.DEFAULTS={fileTypeExts:"*.jpg;*.png",uploader:"",auto:!1,method:"POST",multi:!1,formData:{},fileObjName:"file",fileSizeLimit:204800,previewImg:!0,previewLoadimg:null,dragDrop:!1,showUploadedPercent:!0,showUploadedSize:!0,buttonText:"上传文件",removeTimeout:1e3,itemTemplate:FRAG.uploadTemp,breakPoints:!1,fileSplitSize:1048576,onUploadStart:null,onUploadSuccess:null,onUploadComplete:null,onUploadError:null,onInit:null,onCancel:null,onSelect:null},a.MIMETYPES={zip:["application/x-zip-compressed"],jpg:["image/jpeg"],png:["image/png"],gif:["image/gif"],swf:["application/x-shockwave-flash"],doc:["application/msword"],xls:["application/vnd.ms-excel"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],ppt:["application/vnd.ms-powerpoint"],pptx:["application/vnd.openxmlformats-officedocument.presentationml.presentation"],mp3:["audio/mpeg"],mp4:["video/mp4"],pdf:["application/pdf"],txt:["text/plain"],xml:["text/xml"]},a.prototype.TOOLS=function(){var e=this,i=this.options,n={formatFileSize:function(t,e){return t=t>1048576&&!e?(Math.round(100*t/1048576)/100).toString()+"MB":(Math.round(100*t/1024)/100).toString()+"KB"},getFile:function(t,e){for(var a=0;a<e.length;a++)if(e[a].index==t)return e[a];return!1},getFileTypes:function(t){for(var e=[],a=t.split(";"),i=0;i<a.length;i++)e.push(a[i].split(".").pop());return e},getMimetype:function(t){return a.MIMETYPES[t]},getAcceptString:function(t){for(var e=this.getFileTypes(t),a=[],i=0;i<e.length;i++){var n=this.getMimetype(e[i]);n?a.push(n):a.push("."+e[i])}return a.join(",")},filter:function(a){var n=[],o=this.getFileTypes(i.fileTypeExts);if(o.length>0)for(var l=0;l<a.length;l++){var s=a[l];parseInt(this.formatFileSize(s.size,!0))>i.fileSizeLimit?e.$element.alertmsg("error",'文件"'+s.name+'"大小超出限制！'):t.inArray(s.name.split(".").pop().toLowerCase(),o)>=0||"*"==i.fileTypeExts?n.push(s):e.$element.alertmsg("error",'文件"'+s.name+'"类型不允许！')}return n},getFiles:function(t){var a=t.target.files||t.dataTransfer.files;a=this.filter(a);for(var i=0;i<a.length;i++)a[i].id=a[i].lastModifiedDate.getTime()+"_"+a[i].size+"_"+(a[i].type||"").replace(/\W/g,""),this.renderQueueItem(a[i]),e.queueData.files++;return a},renderQueueItem:function(a){var n=0,o=t(i.itemTemplate.replace("{fileId}",a.id).replace("{fileName}",a.name).replace("#upConfirm#",BJUI.regional.upload.upConfirm).replace("#upPause#",BJUI.regional.upload.upPause).replace("#upCancel#",BJUI.regional.upload.upCancel).replace("{percent}","0.00%").replace("{uploadedSize}","0KB").replace("{fileSize}",this.formatFileSize(a.size)));if(i.auto&&o.find("> .info > .up_confirm").remove(),o.data("upfile",a),e.$uploadFileList.append(o),i.breakPoints&&(n=this.getUploadedSize(a.id))>a.size&&(n=a.size),this.showProgress(a.id,n,a.size),i.previewImg&&-1!=a.type.indexOf("image")){var l=o.find("> .preview > .img");i.previewLoadimg&&l.html('<img src="'+i.previewLoadimg+'" height="114">'),this.previewImg(a,l)}else o.find("> .preview").remove();if(i.showUploadedSize){var s=o.find("> .filesize");s.find("> .uploadedsize").html(this.formatFileSize(n)),s.find("> .filesize").html(this.formatFileSize(a.size))}else o.find("> .filesize").remove();i.showUploadedPercent?o.find("> .percent").html((n/a.size*100).toFixed(2)+"%"):o.find("> .percent").remove(),i.onSelect&&i.onSelect(files),i.auto&&e.fileUpload(a,n),o.on("click.bjui.upload.confirm",".up_confirm",function(a){var i=t(this),o=i.closest(".item");i.hide().next().show(),e.fileUpload(o.data("upfile"),n)}),o.on("click.bjui.upload.cancel",".up_cancel",this.removeQueueItem)},successQueueItem:function(a,o){n.showProgress(a.id,a.size,a.size),i.onUploadSuccess&&i.onUploadSuccess.toFunc().call(e,a,o.responseText,e.$element),setTimeout(function(){e.$element.find("#"+a.id).fadeOut("normal",function(){t(this).remove(),e.$element.find("> .queue > .item:visible").length||(e.$element.find("> .queue").hide(),e.$file.val(""))})},i.removeTimeout)},removeQueueItem:function(a,i){i&&i.abort(),t(this).closest(".item").fadeOut("normal",function(){t(this).remove(),e.$element.find("> .queue > .item:visible").length||e.$element.find("> .queue").hide()}),a.preventDefault()},previewImg:function(t,e){if(t&&e.length){var a=new FileReader;a.onload=function(t){e.html('<img src="'+t.target.result+'">')},a.readAsDataURL(t)}},showProgress:function(t,a,i){var n=a/i*100+"%";e.tools.formatFileSize(a),(a/i*100).toFixed(2);e.$element.find("#"+t+" > .progress > .bar").css("width",n)},getUploadedSize:function(t){return 1*localStorage.getItem(t)},saveUploadedSize:function(t,e){localStorage.setItem(t,e)},sendBlob:function(t,e,a,n){var o=new FormData;if(e.open(i.method,t,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.append(i.fileObjName,a),n)for(var l in n)o.append(l,n[l]);e.send(o)}};return n},a.prototype.init=function(){var e=this,a=this.$element,i=this.options;if(!i.uploader)return void BJUI.debug("Upload Plugin: The options uploader is undefined!");if(i.uploader=decodeURI(i.uploader).replacePlh(a.closest(".unitBox")),!i.uploader.isFinishedTm())return a.alertmsg("error",i.warn||BJUI.regional.plhmsg),void BJUI.debug("Upload Plugin: The options uploader is incorrect: "+i.uploader);if(i.uploader=encodeURI(i.uploader),!a.hasClass("bjui-upload")){i.formData&&"string"==typeof i.formData&&(i.formData=i.formData.toObj());var n=t(FRAG.uploadFrag.replaceAll("#multi#",i.multi?"multiple":"").replaceAll("#accept#",e.tools.getAcceptString(i.fileTypeExts)).replaceAll("#btnTxt#",(i.icon?'<i class="fa fa-'+i.icon+'">&nbsp;&nbsp;':"")+i.buttonText));a.addClass("bjui-upload").append(n),this.$file=a.find("> .bjui-upload-select-file"),this.$uploadFileList=a.find("> .queue"),this.queueData={files:0,success:0,error:0},a.on("change.bjui.upload",".bjui-upload-select-file",function(t){e.fileSelect(t)}).on("click.bjui.upload",".bjui-upload-select",function(t){e.$file.trigger("click")}),i.onInit&&i.onInit(),i.dragDrop&&(a[0].ondragover=function(t){return t.preventDefault(),!0},a[0].ondrop=function(t){e.fileSelect(t),t.stopPropagation(),t.preventDefault()})}},a.prototype.fileSelect=function(t){this.$uploadFileList.show(),this.tools.getFiles(t)},a.prototype.fileUpload=function(e,a){var i=this,n=i.$element,o=i.options,l=i.tools,s=!1,r=e;s=new XMLHttpRequest,o.breakPoints&&(e=r.slice(a,a+o.fileSplitSize)),s.upload&&(s.upload.onprogress=function(t){i.onProgress(e,t.loaded,r.size)},s.onreadystatechange=function(t){if(4==s.readyState&&200==s.status){var n=(JSON.parse(s.responseText),!1);o.breakPoints?(a+=o.fileSplitSize,l.saveUploadedSize(r.id,a),a<r.size?(e=r.slice(a,a+o.fileSplitSize),l.sendBlob(o.uploader,s,e,o.formData)):n=!0):n=!0,n&&(i.queueData.success++,l.successQueueItem(r,s),o.onUploadComplete&&o.onUploadComplete(r,s.responseText))}else i.queueData.error++,o.onUploadError&&o.onUploadError(r,s.responseText);o.onQueueComplete&&(i.queueData.files=i.queueData.success+i.queueData.error)&&option.onQueueComplete(i.queueData)},o.onUploadStart&&o.onUploadStart(),o.formData.fileName=r.name,o.formData.lastModifiedDate=r.lastModifiedDate.getTime(),l.sendBlob(o.uploader,s,e,o.formData)),n.find("#"+r.id+" > .info > .up_pause").on("click.bjui.upload.pause",function(e){s.abort(),t(this).hide().prev().show()}),n.find("#"+r.id+" > .info > .up_cancel").off("click.bjui.upload.cancel").on("click.bjui.upload.cancel",t.proxy(function(t){this.tools.removeQueueItem(t,s)},this))},a.prototype.onProgress=function(t,e,a){var i=this,n=i.options,o=i.$element.find("#"+t.id+" .progress"),l=e,s=o.attr("lastLoaded")||0;e-=parseInt(s),e>t.size&&(e=t.size),i.$progressBar=o.children(".bar");var r=n.breakPoints?parseFloat(i.$progressBar.get(0).style.width||0):0,d=(e/a*100+r).toFixed(2),c=d>100?"100%":d+"%";if(n.showUploadedSize){o.nextAll(".filesize").find("> .uploadedsize").text(i.tools.formatFileSize(e))}n.showUploadedPercent&&o.nextAll(".up_percent").text(c),i.$progressBar.css("width",c),l<n.fileSplitSize?o.attr("lastLoaded",l):o.removeAttr("lastLoaded")},a.prototype.destroy=function(){};var i=t.fn.upload;t.fn.upload=e,t.fn.upload.Constructor=a,t.fn.upload.noConflict=function(){return t.fn.upload=i,this},t(document).on(BJUI.eventType.initUI,function(a){var i=t(a.target).find('[data-toggle="upload"]');i.length&&e.call(i)})}(jQuery),function(t){function e(e){var a=arguments,i=e;return this.each(function(){var o=t(this),l=t.extend({},n.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.theme");s||o.data("bjui.theme",s=new n(this,l)),"string"==typeof i&&t.isFunction(s[i])?([].shift.apply(a),a?s[i].apply(s,a):s[i]()):s.init()})}var a,i;t(function(){!function(){if(a=t("#bjui-link-theme"),i=t("#bjui-themes"),t.cookie){var e=t.cookie("bjui_theme")||"blue";i.find("a.theme_"+e).theme({})}}()});var n=function(e,a){this.$element=t(e),this.options=a};n.DEFAULTS={theme:"purple"},n.prototype.init=function(){if(a.length){var t=a.attr("href");t=t.substring(0,t.lastIndexOf("/")),t=t.substring(0,t.lastIndexOf("/")),t+="/"+this.options.theme+"/core.css",a.attr("href",t);var e=this.$element.closest("ul").prev(),n=e.attr("class");n=n.replace(/(theme[\s][a-z]*)/g,""),e.removeClass().addClass(n).addClass("theme").addClass(this.options.theme),i.find("li").removeClass("active"),this.$element.parent().addClass("active"),this.cookie()}},n.prototype.setTheme=function(t){i.find("a.theme_"+t).trigger("click")},n.prototype.cookie=function(){var e=this.options.theme;t.cookie&&t.cookie("bjui_theme",e,{path:"/",expires:30})};var o=t.fn.theme;t.fn.theme=e,t.fn.theme.Constructor=n,t.fn.theme.noConflict=function(){return t.fn.theme=o,this},t(document).on("click.bjui.theme.data-api",'[data-toggle="theme"]',function(a){e.call(t(this)),a.preventDefault()})}(jQuery),function(t){function e(e){var i=arguments,n=e;return this.each(function(){var o=t(this),l=t.extend({},a.DEFAULTS,o.data(),"object"===(void 0===e?"undefined":_typeof(e))&&e),s=o.data("bjui.initui");s||o.data("bjui.initui",s=new a(this,l)),"string"==typeof n&&t.isFunction(s[n])?([].shift.apply(i),i?s[n].apply(s,i):s[n]()):s.init()})}var a=function(e,a){this.$element=t(e),this.options=a};a.DEFAULTS={},a.prototype.init=function(){var e=this,a=e.$element;t.when(e.initUI()).done(function(){a.trigger(BJUI.eventType.afterInitUI)})},a.prototype.initUI=function(){var e=this.$element;t.when(e.trigger(BJUI.eventType.beforeInitUI)).done(function(){e.trigger(BJUI.eventType.initUI)})};var i=t.fn.initui;t.fn.initui=e,t.fn.initui.Constructor=a,t.fn.initui.noConflict=function(){return t.fn.initui=i,this},t(document).on("click.bjui.initui.data-api",'[data-toggle="initui"]',function(t){e.call($this,$this.data()),t.preventDefault()}),t(document).on(BJUI.eventType.beforeInitUI,function(e){var a=t(e.target),i=[],n=a.find("[data-noinit]");a.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"85%"},"fast"),n.each(function(e){var a=t(this),n={};n.$target=a,n.$next=a.next(),n.$prev=a.prev(),n.$parent=a.parent(),n.visible=!!a.is(":visible"),i.push(n),a.remove()}),a.data("bjui.noinit",i)}),t(document).on(BJUI.eventType.initUI,function(e){t(e.target).find("> .bjui-maskProgress").find(".progress").stop().animate({width:"95%"},"fast")}),t(document).on(BJUI.eventType.afterInitUI,function(e){var a=t(e.target),i=a.data("bjui.noinit"),n=a.find("> .bjui-pageContent").find("form");i&&t.each(i,function(t,e){e.$next.length?e.$next.before(e.$target):e.$prev.length?e.$prev.after(e.$target):e.$parent.length&&e.$parent.append(e.$target),e.visible&&e.$target.show(),a.removeData("bjui.noinit")}),a.resizePageH(),n.length&&a.find("> .bjui-pageFooter").find(":submit").on("click.bjui.submit",function(t){t.preventDefault(),n.submit()}),a.find("> .bjui-maskProgress").find(".progress").stop().animate({width:"100%"},"fast",function(){a.find("> .bjui-ajax-mask").fadeOut("normal",function(){t(this).remove()})})}),t(document).one(BJUI.eventType.afterInitUI,function(e){var a=t("#bjui-hnav-navbar"),i=a.find("> li.active");i.length&&i.find("> .items").length&&i.find("> a").trigger("click")});var n=function(e){var a=e,i=a;"static"==a.css("position")&&(i=a.offsetParent());var n=parseInt(i.css("zIndex"))||0,o=a.find("> .bjui-maskBackground"),l=a.find("> .bjui-maskProgress");o.length||(o=t(FRAG.maskBackground),l=t(BJUI.doRegional(FRAG.maskProgress,BJUI.regional)),a.prepend(o).prepend(l));parseInt(o.css("zIndex")),parseInt(l.css("zIndex"));return o.css("zIndex",n+1),l.css("zIndex",n+2),{$bg:o,$pr:l}};t(document).on("bjui.ajaxStart",function(e,a,i){var o=n(t(e.target));o.$bg.fadeIn(),o.$pr.fadeIn(),o.$pr.find(".progress").animate({width:"80%"},a||500),i&&setTimeout(function(){i.toFunc().call(this)},25)}).on("bjui.ajaxStop",function(e){var a=n(t(e.target));a.$pr.find(".progress").animate({width:"100%"},"fast",function(){a.$bg.remove(),a.$pr.remove()})}).on("bjui.ajaxError",function(e){var a=n(t(e.target));a.$bg.remove(),a.$pr.remove()}),t(document).on(BJUI.eventType.ajaxStatus,function(e){var a=t(e.target),i=n(a);a.one("ajaxStart",function(){i.$bg.fadeIn(),i.$pr.fadeIn(),i.$pr.find(".progress").animate({width:"10%"},"fast")}).one("ajaxStop",function(){}).one("ajaxError",function(){i.$bg.remove(),i.$pr.remove()})});var o=function(t){t.find('select[data-toggle="selectpicker"]').selectpicker("destroyMenu"),t.find('[data-toggle="selectztree"]').trigger("destroy.bjui.selectztree")};t(document).on(BJUI.eventType.beforeLoadDialog,function(t){}).on(BJUI.eventType.beforeAjaxLoad,function(e){o(t(e.target))}).on(BJUI.eventType.beforeCloseNavtab,function(e){o(t(e.target))}).on(BJUI.eventType.beforeCloseDialog,function(e){o(t(e.target))}),t(function(){t(document).on("keydown keyup",function(t){t.which===BJUI.keyCode.CTRL&&(BJUI.KeyPressed.ctrl="keydown"==t.type),t.which===BJUI.keyCode.SHIFT&&(BJUI.KeyPressed.shift="keydown"==t.type)})})}(jQuery),function(t){t(document).on(BJUI.eventType.initUI,function(e){var a=t(e.target);if(t.fn.iCheck){var i=a.find('input[data-toggle="icheck"]');i.each(function(e){var a=t(this),i=a.attr("id"),n=a.attr("name"),o=a.data("label");o&&a.after('<label for="'+i+'" class="ilabel">'+o+"</label>"),a.on("ifCreated",function(e){var a=t(this).closest("div"),o=a.next('[for="'+i+'"]');a.attr("data-icheck",n),o.attr("data-icheck",n)}).iCheck({checkboxClass:"icheckbox_minimal-purple",radioClass:"iradio_minimal-purple",increaseArea:"20%"}).on("ifChanged",function(){t.fn.validator&&t(this).trigger("validate")}),a.prop("disabled")&&a.iCheck("disable")}),i.filter(".checkboxCtrl").on("ifChanged",function(e){var i=1==e.target.checked?"check":"uncheck",n=t(this).data("group");a.find(':checkbox[name="'+n+'"]').iCheck(i)})}if(a.find("button").each(function(){var e=t(this),a=e.data("icon");e.addClass("btn"),a&&!e.find("> i").length&&(a="fa-"+a.replace("fa-",""),e.data("bjui.icon")||e.html('<i class="fa '+a+'"></i> '+e.html()).data("bjui.icon",!0))}),a.find("input:text, input:password").each(function(){var e=t(this).addClass("form-control"),a=e.attr("size")||0,i=10*a;i&&e.css("width",i)}),a.find("textarea").each(function(){var e=t(this).addClass("form-control"),a=e.attr("cols")||0,i=10*a,n=e.attr("data-toggle");i&&e.css("width",i),n&&"autoheight"==n&&t.fn.autosize&&e.addClass("autosize").autosize()}),a.find("a.btn").each(function(){var e=t(this),a=e.data("icon");a&&!e.find("> i").length&&(a="fa-"+a.replace("fa-",""),e.data("bjui.icon")||e.html('<i class="fa '+a+'"></i> '+e.html()).data("bjui.icon",!0))}),t.fn.validator&&a.find('form[data-toggle="validate"]').each(function(){var e=t(this),a=void 0===e.data("alertmsg")||e.data("alertmsg");t(this).validator({valid:function(e){t(e).bjuiajax("ajaxForm",t(e).data())},validClass:"ok",theme:"red_right_effect"}).on("invalid.form",function(e,i,n){a&&t(i).alertmsg("error",BJUI.regional.validatemsg.replaceMsg(n.length))})}),a.find('[data-toggle="moresearch"]').each(function(){var e=t(this),a=e.closest(".bjui-pageHeader"),i=a&&a.find(".bjui-moreSearch"),n=e.data("name");e.attr("title")||e.attr("title","更多查询条件"),e.click(function(o){if(!i.length)return void BJUI.debug("Not created 'moresearch' box[class=\"bjui-moreSearch\"]!");i.css("top",a.outerHeight()-1),i.is(":visible")?(e.html('<i class="fa fa-angle-double-down"></i>'),n&&t("body").data("moresearch."+n,!1)):(e.html('<i class="fa fa-angle-double-up"></i>'),n&&t("body").data("moresearch."+n,!0)),i.fadeToggle("slow","linear"),o.preventDefault()}),n&&t("body").data("moresearch."+n)&&(i.css("top",a.outerHeight()-1).fadeIn(),e.html('<i class="fa fa-angle-double-up"></i>'))}),t.fn.selectpicker){var n=a.find('select[data-toggle="selectpicker"]'),o=function(e,a){if(a&&a.length){var i=e.data("refurl"),n=function e(a){var i=t(a.data("nextselect"));if(i&&i.length){var n=i.data("emptytxt")||"&nbsp;";i.html("<option>"+n+"</option>").selectpicker("refresh"),e(i)}};if(a&&a.length&&i){var o=e.data("val");a.data("val");void 0===o&&(o=e.val()),t.ajax({type:"POST",dataType:"json",url:i.replace("{value}",encodeURIComponent(o)),cache:!1,data:{},success:function(t){if(t){var i=t.data,o="";"[object Array]"===toString.apply(i)&&(i={0:i[0]});for(var l in i)o+='<option value="'+l+'">'+i[l]+"</option>";o='<option value="">--请选择--</option>'+o,e.removeAttr("data-val").removeData("val"),a.removeAttr("data-val").removeData("val"),o||(o=a.data("emptytxt")||"&nbsp;",o="<option>"+o+"</option>"),a.html(o).selectpicker("refresh"),n(a)}},error:BJUI.ajaxError})}}};n.each(function(){var e=t(this),a=e.data(),i=t(a.nextselect);e.addClass("show-tick"),a.style||e.data("style","btn-default"),a.width||e.data("width","auto"),a.container?1==a.container&&e.attr("data-container","false").data("container",!1):e.data("container","body"),e.selectpicker(),i&&i.length&&void 0!==i.data("val")&&o(e,i)}),n.change(function(){var e=t(this),a=t(e.data("nextselect"));o(e,a),e.attr("aria-required")&&t.fn.validator&&e.trigger("validate")})}if(t.fn.zTree){a.find('[data-toggle="ztree"]').each(function(){function e(e,a,i){if(i.faicon){var n=t("#"+i.tId+"_a");n.data("faicon")||n.data("faicon",!0).addClass("faicon").find("> span.button").append('<i class="fa fa-'+i.faicon+'"></i>')}c.onNodeCreated&&c.onNodeCreated.toFunc().call(this,e,a,i)}function a(e,a,i){i.faiconClose&&t("#"+i.tId+"_ico").find("> i").attr("class","fa fa-"+i.faiconClose),c.onCollapse&&c.onCollapse.toFunc().call(this,e,a,i)}function i(e,a,i){i.faicon&&i.faiconClose&&t("#"+i.tId+"_ico").find("> i").attr("class","fa fa-"+i.faicon),c.onExpand&&c.onExpand.toFunc().call(this,e,a,i)}function n(e,a){var i=a.level,n=t("#"+a.tId+f),o=t("#diyBtn_add_"+a.id),l=t("#diyBtn_del_"+a.id);if(o.length||i<c.maxAddLevel&&(o=t('<span class="tree_add" id="diyBtn_add_'+a.id+'" title="添加"></span>'),o.appendTo(n),o.on("click",function(){p.addNodes(a,{name:"新增Item"})})),!l.length){var l=t('<span class="tree_del" id="diyBtn_del_'+a.id+'" title="删除"></span>');l.appendTo(n).on("click",function(t){var i=function(){l.alertmsg("confirm","确认要删除 "+a.name+" 吗？",{okCall:function(){if(p.removeNode(a),c.onRemove){var i=c.onRemove.toFunc();i&&i.call(this,t,e,a)}},cancelCall:function(){}})};if(c.beforeRemove){var n=c.beforeRemove.toFunc();if(n){var o=n.call(n,e,a);o&&1==o&&i()}}else i()})}}function o(e,a){var i=t("#diyBtn_add_"+a.id),n=t("#diyBtn_del_"+a.id);i&&i.length&&i.off("click").remove(),n&&n.length&&n.off("click").remove()}function l(t,e){for(var a=0;a<e.length;a++)if(!1===e[a].drag)return!1;return!0}function s(t,e,a,i){return!a||!1!==a.drop}var r,d=t(this),c=d.data(),u=c.options
;u&&"string"==typeof u&&(u=u.toObj()),u&&t.extend(c,"object"===(void 0===u?"undefined":_typeof(u))&&u),r=c.setting,c.nodes?("string"==typeof c.nodes&&(c.nodes.trim().startsWith("[")||c.nodes.trim().startsWith("{")?c.nodes=c.nodes.toObj():c.nodes=c.nodes.toFunc()),"function"==typeof c.nodes&&(c.nodes=c.nodes.call(this)),d.removeAttr("data-nodes")):(c.nodes=[],d.find("> li").each(function(){var e=t(this),a=e.data();a.pid&&(a.pId=a.pid),a.name=e.html(),c.nodes.push(a)}),d.empty()),c.showRemoveBtn||(c.showRemoveBtn=!1),c.showRenameBtn||(c.showRenameBtn=!1),c.addHoverDom&&"function"!=typeof c.addHoverDom&&(c.addHoverDom="edit"===c.addHoverDom?n:c.addHoverDom.toFunc()),c.removeHoverDom&&"function"!=typeof c.removeHoverDom&&(c.removeHoverDom="edit"===c.removeHoverDom?o:c.removeHoverDom.toFunc()),c.maxAddLevel||(c.maxAddLevel=2);var h={view:{addHoverDom:c.addHoverDom||null,removeHoverDom:c.removeHoverDom||null,addDiyDom:c.addDiyDom?c.addDiyDom.toFunc():null},edit:{enable:c.editEnable,showRemoveBtn:c.showRemoveBtn,showRenameBtn:c.showRenameBtn},check:{enable:c.checkEnable,chkStyle:c.chkStyle,radioType:c.radioType},callback:{onClick:c.onClick?c.onClick.toFunc():null,beforeDrag:c.beforeDrag?c.beforeDrag.toFunc():l,beforeDrop:c.beforeDrop?c.beforeDrop.toFunc():s,onDrop:c.onDrop?c.onDrop.toFunc():null,onCheck:c.onCheck?c.onCheck.toFunc():null,beforeRemove:c.beforeRemove?c.beforeRemove.toFunc():null,onRemove:c.onRemove?c.onRemove.toFunc():null,onNodeCreated:e,onCollapse:a,onExpand:i},data:{simpleData:{enable:c.simpleData||!0},key:{title:c.title||""}}};r&&"string"==typeof r&&(r=r.toObj()),r&&t.extend(!0,h,"object"===(void 0===r?"undefined":_typeof(r))&&r),t.fn.zTree.init(d,h,c.nodes);var f="_a",p=t.fn.zTree.getZTreeObj(d.attr("id"));c.expandAll&&p.expandAll(!0)});a.find('[data-toggle="selectztree"]').each(function(){var e=t(this),a=e.data(),i=t(a.tree),n=(parseFloat(e.css("width")),e.outerHeight());if(a.width=a.width||e.outerWidth(),a.height=a.height||"auto",i&&i.length){var o=i.attr("id"),l=t("#"+o+"_select_box"),s=function(o){var l=e.offset().top,s=e.offset().left,r=i.clone().appendTo(t("body")),d=r.outerHeight();r.remove();var c=t(window).height()-d-l-n,u=t(window).height()-l-n;"auto"==a.height&&c<0&&(u+=c),o.css({top:l+n,left:s,"max-height":u})};e.click(function(){if(l&&l.length)return s(l),void l.show();var n=2,r=t.CurrentDialog;r&&r.length&&(n=r.css("zIndex")+1),l=t('<div id="'+o+'_select_box" class="tree-box"></div>').css({position:"absolute",zIndex:n,"min-width":a.width,height:a.height,overflow:"auto",background:"#FAFAFA",border:"1px #EEE solid"}).hide().appendTo(t("body")),i.appendTo(l).css("width","100%").data("fromObj",e).removeClass("hide").show(),s(l),l.show()}),t("body").on("mousedown",function(a){var i=t(a.target);e[0]==a.target||l&&l.length>0&&i.closest(".tree-box").length>0||l.hide()});var r=e.closest(".bjui-pageContent");r&&r.length&&r.scroll(function(){l&&l.length&&s(l)}),e.on("destroy.bjui.selectztree",function(){l.remove()})}})}a.find('[data-toggle="accordion"]').each(function(){var e=t(this),a=e.data("heightbox"),i=e.data("height"),n=function(a,i){var n=e.data("offsety")||0,i=i||t(a).outerHeight()-1*n,o=e.find(".panel-heading"),l=o.outerHeight();l=(l+1)*o.length,e.css("height",i),i-=l,e.find(".panel-collapse").find(".panel-body").css("height",i)};e.find("> .panel").length&&(a||i)&&(n(a,i),t(window).resize(function(){n(a,i)}),e.on("hidden.bs.collapse",function(e){var a=t(this).find("> .panel:last");a.find("> .panel-heading > h4 > a").hasClass("collapsed")&&a.css("border-bottom","1px #ddd solid")}))}),t.fn.colorpicker&&(a.find('[data-toggle="colorpicker"]').each(function(){var e=t(this),a=e.data("bgcolor");e.colorpicker(),a&&e.on("changeColor",function(t){e.css("background-color",t.color.toHex())})}),a.find('[data-toggle="clearcolor"]').each(function(){var e=t(this),a=e.data("target")?t(e.data("target")):null;a&&a.length&&e.click(function(){a.val(""),a.data("bgcolor")&&a.css("background-color","")})})),a.find('[data-toggle="tooltip"]').each(function(){t(this).tooltip()}),a.find('[data-toggle="dropdown"]').parent().on("show.bs.dropdown",function(e){var a=t(this),i=(a.outerWidth(),a.find("> .dropdown-menu"));i.outerWidth()}),t.fn.validator&&a.find('form[data-toggle="ajaxform"]').each(function(){t(this).validator({ignore:":input"}),t(this).validator("destroy")}),a.find('[data-toggle="highcharts"]').each(function(){var e=t(this),a=e.data();t.get(a.url,function(t){e.highcharts(t)},"json")}),UE&&a.find('[data-toggle="ueditor"]').each(function(){var e=t(this).data("name"),a=t(this).data("id"),i=t(this).val(),n=t(this).attr("style");void 0===e&&(e=""),""!=a&&void 0!==a||(a=parseInt(1e3*Math.random())),a="ueditor"+a,t(this).after('<script style="'+n+'" id="'+a+'" name="'+e+'" type="text/plain">'+i+"<\/script>"),t(this).remove(),ue=UE.getEditor(a)}),a.find('[data-toggle="autocomplete"]').each(function(){var e=t(this).width(),a=t(this).data("url"),i=t(this).data("callback");t(this).attr("autocomplete","off"),t(this).bigAutocomplete({width:e+10,url:a,callback:function(t){""!=i&&void 0!==i&&window[i](t)}})})})}(jQuery);